# 3数据拟合

代数插值是根据给定的数据表（也称为函数表），按某些条件构造一个代数多项式$p_n\left(\begin{matrix}x\end{matrix}\right)$ 近似代替函数$f(x)$ ,所要求的条件中有一个条件是$p_{x}\left(\begin{array}{c}{x_{i}}\end{array}\right)=y_{i}\left(\begin{array}{c}{i=0}\end{array},1\right.$ ， $\cdots,n)$ ,即要求函数$p_n\left(\begin{matrix}x\end{matrix}\right)$ 经过点( $x_i$ $, y_i$ ) .但是，由于数据表中给定的数据$x_i$ 和$y_i$ 是从实验或测量中得到的，难免有些误差，而且有个别点的误差可能比较大.用代数插值所得到的插值多项式$p_n\left(\begin{matrix}x\end{matrix}\right)$ 因为要经过点( $x_i$ $, y_i$ ) ，所以必然保留原来数据的一切误差.这是我们所不希望的.为了避免这种情况的发生，可以使用数据拟合法。

# 3.1单变量数据拟合及最小二乘法

若给定的数据表表示的是一个量与另一个量的关系，则可以使用单变量数据拟合法寻找一个近似函数代替函数$:f(x)$ .

单变量数据拟合法的一般过程是：先根据给定函数$y= f($ $x$ ) 的数据表（如表3-1所示），用几何描点法或凭经验选择一个近似函数$F(x)$ ，以反映数据表中数据的一般趋势，然后使用最小二乘法确定$F(x)$ 中的未知参数，从而得到$f(x)$ 的近似函数$F(x)$ .

表3-1 $y= f($ $x)$ 的数据表

| x | x₁ | x₂ | … | xₙ |
|-----------|------|------|---|----|
| y = f(x) | y₁ | y₂ | … | yₙ |

通常$F(x)$ 称为拟合函数$f(x)$ 称为被拟合函数.

从单变量数据拟合法的一般过程可以看到，在使用数据拟合法求拟合函数$F($ $x)$ 时，要用到最小二乘法.那么，什么是最小二乘法呢？

与插值法的目的一样，单变量数据拟合法也是要寻找一个近似函数$F(x)$ 来近似代替$f(x)$ .但它与插值法又有些不同，它不要求近似函数$F(x)$ 一定经过点( $x_i$ ， $y_i$ ).很自然，人们总是希望能找到一个最好的函数来近似代替$f(x)$ .现在的问题是，什么是“最好"的函数？“最好”的函数以什么标准来衡量？为了讨论这个问题，需要引人偏差的定义.

定义3.1若记$\delta _{i}= f($ $x_{i}$ $) - F($ $x_{i}$ ) $, i= 1$ ,2 $, \cdots , n$ ，则称$\delta_i$ 为$f($ $x)$ 与$F($ $x$ ) 在$x_i$ 处的偏差.

------------------------------------------------------------------

一般情况下，使用单变量数据拟合法能找到一个近似函数$F(x)$ ，使它与$r(x)$ 的偏差8的平方和最小，即使

$$\sum_{i=1}^{n}\delta_{i}^{2}\:=\:\sum_{i=1}^{n}\left[\:f(\:x_{i}\:)\:-\:F(\:x_{i}\:)\:\right]^{2}$$

最小.能使偏差$\delta_i$ 的平方和最小的函数就是“最好”的函数.因此，可以以偏差$\delta_{i}$ 的平方和最小作为原则选择近似函数$F($ $x$ ) .

定义3.2以“偏差的平方和最小”为原则选择近似函数的方法称为最小二乘法：

下面介绍一个呈线性关系的数据拟合的例子.

例3-1已知一组实验数据如表3-2所示，试用单变量数据拟合法求其拟合函数.

表3-2例3-1数据表

| x | -1 | 0 | 1 | 2 | 3 | 4 | 5 | 6 |
|---|----|---|---|---|---|---|---|---|
| y = f(x) | 10 | 9 | 7 | 5 | 4 | 3 | 0 | -1 |

解按照单变量数据拟合法的一般过程，根据给定的数据表（表3-2），用几何描点法或凭经验选择近似函数，以反映数据表中数据的一般趋势。这里，用几何描点法选择近似函数，而用几何描点法选择近似函数要画出数据表中数据的散点图，散点图如图3 -1所示.

![](https://storage.simpletex.cn/view/fWtSKidnAZN6ZMnzUZ6MQMP8YyiYlZn6q)

图3-1例3-1数据散点图

从图3-1可以看到，点(xi,y: ( $x_i$ $, y_i$ . $\left(\begin{array}{c}x_{i},y_{i}\end{array}\right)\left(\begin{array}{c}i=1\end{array},2\right.$ i =1,2 $i= 1$ ,2 ， ".,8)在一条直线附近，这些点基本满足直线方程.因此，可以选择线性函数来拟合这些数据，即可以选取

$$F(x)=a+bx$$

作为$f(x)$ 的近似函数.其中$a$ 和$b$ 为待定参数.

拟合函数选定之后，还要确定拟合函数中的待定参数.确定拟合函数中的待定参数最常用的方法是最小二乘法。

先求出被拟合函数$f(x)$ 与拟合函数$F(x)$ 的偏差：

$$\delta_{i}=f(\:x_{i}\:)\:-F(\:x_{i}\:)\:=y_{i}\:-a\:-bx_{i}\quad(\:i=1\:,2\:,\cdots,8\:)$$

按照最小二乘法，要使偏差的平方和最小，即需选择$a$ 和$b$ .使

------------------------------------------------------------------



------------------------------------------------------------------

则待定参数$a$ 和$b$ 是正规方程组

$$\left\{\begin{array}{rcl}na&+\left[&\sum_{i=1}^{*}x_{i}\right]b&=&\sum_{i=1}^{*}y_{i}\\\\\left[&\sum_{i=1}^{*}x_{i}\right]a&+\left[&\sum_{i=1}^{*}x_{i}^{2}\right]b&=&\sum_{i=1}^{*}x_{i}y_{i}\end{array}\right.$$

的解。

单变量线性拟合法算法

![](https://storage.simpletex.cn/view/fs1gG28IXtbDBbwoF1rzvr1qBAmso2oVP)

# 多变量数据拟合3.2

在实际问题中，很多问题反映的不是一个量与一个量的关系，而是一个量与若于个量的关系.具体来说，是一个量由若干个量确定.这就是所谓的多元函数问题， 在数学上.这若于个量通常称为自变量，而由这些自变量确定的量通常称为因变量.若假设这些自变量为$x_1$ X1 $x_1$ $, x_2$ $, \cdots$ $, x_k$ ，因变量为$y$ ，则每经过一次实验或测量就会得到一组数据x1 $x_1$ $x_1$ $, x_2$ $, \cdots , x_i$ $, y$ ，而经过$n$ 次实验或测量就会得到$n$ 组数据，由这$n$ 组数据构成的数据表如表3-3所示

表3-3多变量拟合数据表

实验或测量次数
1
2
...
$n$
x_1  x_12  ...  x_1i  y=f(x_11,x_12,...,x_1i)
x_21  x_22  ...  x_2i  y_i
...
...
...
xi1  xi2  ...  xii  yi

------------------------------------------------------------------

根据表3-3，希望能找到一个函数来近似表达这些量的关系.要做到这一点， 可以采用多变量数据拟合法，

多变量数据拟合法的一般过程是：先根据表3-3选择变量$y$ 与变量x1 $x_1$ $x_1,x_2$ X $x_2$ $\cdots,x_k$ 的一个近似函数$F($ $x_1$ $, x_2$ $, \cdots , x_k$ ) 以反映$y$ 与变量x1 $x_1$ $x_1$ $, x_2$ $, \cdots , x_k$ 的函数关系， 然后使用最小二乘法确定近似函数$F($ $x_1$ $, x_2$ $, \cdots , x_k$ ) 中的未知参数，从而得到$F$ ( $x_1$ $, x_2$ $, \cdots , x_k$ )

通常$F($ $x_1$ $, x_2$ $, \cdots , x_k$ ) 称为拟合函数$, y= f($ $x_{1}$ $, x_{2}$ $, \cdots , x_{k}$ ) 称为被拟合函数

从多变量数据拟合法的一般过程可以看出，若使用这种方法求拟合函数，需根据表3-3选择一个近似函数$F($ $x_1$ $, x_2$ $, \cdots , x_k$ ) 这是多变量数据拟合的关键.这与两个变量的情况不同，两个变量的情况可以使用几何描点法画出散点图辅助选择近似函数，但对多变量的情况，一般来说，作图是困难的，通常是凭经验或根据实际问题的物理背景和一些专业知识来找

为了说明多变量数据拟合的一般过程，现在讨论一种特殊情况.假定表3-3中的数据呈线性关系，这时选择线性函数

$$F(\:x_1\:,x_2\:,\cdots,x_k\:)\:=a_0\:+a_1x_1\:+a_2x_2\:+\cdots\:+a_kx_k$$

来近似表达$y$ 与变量$x_1$ $, x_2$ $, \cdots$ $, x_k$ 的函数关系，其中$a_0$ ①o $a_0,a_1,\cdots,a_k$ 为待定参数

按数据拟合的方法，要确定这些参数，需使用最小二乘法.现在使用最小二乘法来确定待定参数$a_0$ $a_0$ $a_0$ $, a_1$ $, \cdots , a_k$

先把$x_{n1}$ nl X2 $x_{\text{w}2}$ Xmk $x_{nk}$ $x_{n1}, x_{n2}$ $, \cdots , x_{nk}($ $m= 1$ ,2 $, \cdots , n)$ 代人(3.8)式得

$$F(\:x_{n1}\:,x_{n2}\:,\cdots,x_{nk}\:)\:=a_{0}\:+a_{1}x_{n1}\:+a_{2}x_{n2}\:+\cdots+a_{k}x_{nk}$$

则$F($ $x_1$ $, x_2$ $, \cdots , x_k$ ) 与$y= f($ $x_{1}$ $, x_{2}$ $, \cdots , x_{k}$ ) 在$x_{n\text{l}}$ X1 X2 $,x_{\text{п}2}$ $x_{n1},x_{n2},\cdots,x_{nn}$ X $x_{nk}$ 处的偏差为

$$\begin{aligned}\delta_{n}&=y_{n}-F(\:x_{n1}\:,x_{n2}\:,\cdots,x_{nk}\:)\\&=y_{n}-a_{0}-a_{1}x_{n1}-a_{2}x_{n2}-\cdots-a_{k}x_{nk}\end{aligned}$$

偏差的平方和为

$$\sum_{n=1}^{n}\:\delta_{n}^{2}\:=\:\sum_{n=1}^{n}\:\left(\:y_{n}\:-\:a_{0}\:-\:a_{1}\:x_{n1}\:-\:a_{2}\:x_{n2}\:-\:\cdots\:-\:a_{k}\:x_{nk}\:\right)^{2}\:\frac{\text{记为}}{}\varphi(\:a_{0}\:,a_{1}\:,\:\cdots\:,a_{k}\:)$$

根据最小二乘法，要选择近似函数使$\sum_{n=1}\delta_{n}^{2}$ 8 $\delta_{\mathrm{n}}^{2}$ 最小,而Z $\delta_n^2$ 是关于$a_0$ @o $a_0$ $, a_1$ $, \cdots$ $a_{\lambda}$ 的函数，所以可以转化为选择ao $a_0$ $a_0$ $, a_1$ $, \cdots , a_i$ 使$\varphi ($ $a_{0}$ $, a_{1}$ $, \cdots , a_{\lambda }$ ) 最小.实际上就是求$\varphi ($ $a_0$ $, a_1$ $, \cdots , a_k$ ) 的极小值

根据多元函数求极小值的方法，对$\varphi ($ $a_{0}$ $, a_{1}$ $, \cdots , a_{k}$ ) 分别求关于$a_0,a_1,\cdots,a_k$ 的偏导数并令其等于0.得

$$\frac{\partial\varphi}{\partial a_{0}}=-2\sum_{n=1}^{n}\:\left(\:y_{n}\:-a_{0}\:-a_{1}x_{n1}\:-a_{2}x_{n2}\:-\cdots\:-a_{k}x_{nk}\:\right)=0\\\frac{\partial\varphi}{\partial a_{1}}=-2\sum_{n=1}^{n}\:\left(\:y_{n}\:-a_{0}\:-a_{1}x_{n1}\:-a_{2}x_{n2}\:-\cdots\:-a_{k}x_{nk}\:\right)x_{n1}=0$$

------------------------------------------------------------------

$$\begin{aligned}
\frac{\partial\varphi}{\partial a_{2}}& =\:-2\:\sum_{n=1}^{n}\:\left(\:y_{n}\:-a_{0}\:-a_{1}x_{n1}\:-a_{2}x_{n2}\:-\cdots\:-a_{k}x_{nk}\:\right)x_{n2}\:=0 \\
&: \\
\frac{\partial\varphi}{\partial a_{i}}& =\:-2\:\sum_{n=1}^{\circ}\:\left(\:y_{n}\:-a_{0}\:-a_{1}x_{n1}\:-a_{2}x_{n2}\:-\cdots\:-a_{k}x_{nk}\:\right)x_{nk}\:=0 
\end{aligned}$$

整理化简后联立起来得方程组(3.9)：

$$\begin{aligned}&na_{0}\quad+\:a_{1}\sum_{n=1}^{n}x_{n1}\quad+\:a_{2}\sum_{n=1}^{n}x_{n2}\quad+\:\cdots\:+\:a_{k}\sum_{n=1}^{n}x_{nk}\quad=\:\sum_{n=1}^{n}y_{n}\\&a_{0}\sum_{n=1}^{n}x_{n1}x_{n1}+a_{1}\sum_{n=1}^{n}x_{n1}\quad+\:a_{2}\sum_{n=1}^{n}x_{n2}x_{n1}+\cdots\:+\:a_{k}\sum_{n=1}^{n}x_{nk}x_{n1}\:=\:\sum_{n=1}^{n}y_{n}x_{n1}\\&a_{0}\sum_{n=1}^{n}x_{n2}\quad+\:a_{1}\sum_{n=1}^{n}x_{n1}x_{n2}+\:a_{2}\sum_{n=1}^{n}x_{n2}x_{n2}+\cdots\:+\:a_{k}\sum_{n=1}^{n}x_{nk}x_{n2}\:=\:\sum_{n=1}^{n}y_{n}x_{n2}\\&a_{0}\sum_{n=1}^{n}x_{nk}\quad+\:a_{1}\sum_{n=1}^{n}x_{n1}x_{nk}\:+\:a_{2}\sum_{n=1}^{n}x_{n2}x_{nk}\:+\:\cdots\:+\:a_{k}\sum_{n=1}^{n}x_{nk}x_{nk}\:=\:\sum_{n=1}^{n}y_{n}x_{nk}\end{aligned}$$

方程组(3.9)是一个含有$k+1$ 个方程和$k+1$ 个未知数的线性代数方程组，也称为正规方程组.解这个方程组就能得到ao $a_0$ $a_0,a_1,\cdots,a_k$ .

综上所述，得到如下定理. 定理3.2给定$y= f($ $x_{1}$ $, x_{2}$ $, \cdots , x_{k}$ ) 的数据表(表3-3),若数据表中的数据呈

线性关系，这时选取线性函数

$$F(\:x_{1}\:,x_{2}\:,\cdots,x_{k}\:)\:=a_{0}\:+a_{1}x_{1}\:+a_{2}x_{2}\:+\cdots+a_{k}x_{k}$$

作为$y$ 与变量$x_1$ $, x_2$ $, \cdots$ $, x_k$ X $x_k$ 的最小二乘拟合函数，则待定参数$a_0,a_1,\cdots,a_k$ 是正规方程组(3.9)的解.

可以证明：当$n>k$ 时，正规方程组(3.9)有惟一解。

例3-2已知一组测量数据如表3-4所示，求其线性拟合函数.

表3-4例3-2数据表

测量次数  $x_1$  $x_2$  $y=f(x_1,x_2)$  
    1      1     1     7   
    2      1     2     9   
    3      2     1     10  
    4      2     2     11  
    5      2     3     12

解据题意，选择线性函数

$F($ $x_1$ $, x_2$ ) $= a_0$ + $a_1$ $x_1$ + $a_2$ $x_2$ ( $a_0$ $, a_1$ $, a_2$ a $a_2$ 为待定参数）

------------------------------------------------------------------

## 拟合给定数据表中的数据。

由定理3.2得到正规方程组

$$\begin{array}{r|rrrrr}&&&&&\\&na_{0}&&&&\\&&&+a_{1}\sum_{n=1}^{s}x_{n1}&&&\end{array}+a_{2}\sum_{n=1}^{s}x$$

$$\begin{array}{|l}{a_{0}\sum_{n=1}^{s}x_{n1}\:+\:a_{1}\sum_{n=1}^{s}x_{n1}\:x_{n1}\:+\:a_{2}\sum_{n=1}^{s}x_{n2}x_{n1}\:=\:\sum_{n=1}^{s}y_{n}\:x_{n1}}\end{array}$$

$$\begin{array}{|c}a_0\sum\limits_{n=1}^sx_{n2}+a_1\sum\limits_{n=1}^sx_{n1}x_{n2}+a_2\sum\limits_{n=1}^sx_{n2}x_{n2}=\sum\limits_{n=1}^sy_{n}x_{n2}\end{array}$$

$$\begin{aligned}
&\text{S S S S S} \\
&\text{一} \mid\sum_{n=1}\:x_{n1}\:=8\:,\:\sum_{n=1}\:x_{n2}\:=9\:,\:\sum_{n=1}\:x_{n1}\:x_{n1}\:=14\:,\:\sum_{n=1}\:x_{n1}\:x_{n2}\:=\:\sum_{n=1}\:x_{n2}\:x_{n1}\:=\:15\:,\:\sum_{n=1}\:x_{n1}\:x_{n2}\:=\:\sum_{n=1}\:x_{n2}\:x_{n1}\:=\:15\:,\:\sum_{n=1}\:x_{n1}\:x_{n1}\:=\:\sum_{n=1}\:x_{n1}\:x_{n2}\:=\:\sum_{n=1}\:x_{n2}\:x_{n1}\:=\:15\:,\:\sum_{n=1}\:x_{n1}\:x_{n2}\:=\:\sum_{n=1}\:x_{n1}\:x_{n2}\:=\:\sum_{n=1}\:x_{n2}\:x_{n1}\:x_{n1}\:=\:15\:,\:\sum_{n=1}\:x_{n1}\:x_{n1}\:x_{n2}\:=\:\sum_{n=1}\:x_{n1}\:x_{n2}\:x_{n1}\:x_{n1}\:=\:\sum_{n=1}\:x_{n1}\:x_{n1}\:x_{n2}\:=\:\sum_{n=1}\:x_{n2}\:x_{n1}\:x_{n1}\:x_{n1}\:=\:\sum_{n=1}\:x_{n1}\:x_{n1}\:x_{n2}\:=\:\sum_{n=1}\:x_{n1}\:x_{n2}\:x_{n1}\:x_{n1}\:x_{n1}\:x_{n1}\:x_{n1}\:x_{n1}\:x_{n1}\:x_{n1}\:x_{n1}\:x_{n1}\:x_{n1}\:x_{n1}\:x_{n1}\:x_{n1}\:x_{n1}\:x_{n1}\:x_{n1}\:x_{n1}\:x_{n1}\:x_{n1}\:x_{n1}\:x_{n1}\:x_{n1}\:x_{n1}\:x_{n1}\:x_{n1}\:x_{n1}\:x_{n1}\:x_{n1}\:x_{n1}\:x_{n1}\:x_{n1}\:x_{n1}\:x_{n1}\:x_{n1}\:x_{n1}\:x_{n1}\:x_{n1}\:x_{n1}\:x_{n1}\:x_{n1}\:x_{n1}\:x_{n1}\:x_{n1}\:x_{n1}\:x_{n1}\:x_{n1}\:x_{n1}\:x_{n1}\:x_{n1}\:x_{n1}\:x_{n1}\:x_{n1}\:x_{n1}\:x_{n1}\:x_{n1}\:x_{n1}\:x_{n1}\:x_{n1}\:x_{n1}\:x_{n1}\:x_{n1}\:x_{n1}\:x_{n1}\:x_{n1}\:x_{n1}\:x_{n1}\:x_{n1}\:x_{n1}\:x_{n1}\:x_{n}  \\
&_{2}=19\:,\:\sum_{n=1}^{5}\:y_{n}\:=49\:,\:\sum_{n=1}^{5}\:y_{n}\:x_{n1}\:=82\:,\:\sum_{n=1}^{5}\:y_{n}\:x_{n2}\:=93\:,\:\text{把它们代入正规方} \\
&\text{-}
\end{aligned}$$
(3.10)得

$$\left.\left\{\begin{array}{lll}5a_0&+8a_1&+9a_2&=&49\\\\8a_0+14a_1&+15a_2&=&82\\\\9a_0+15a_1&+&19a_2&=&93\end{array}\right.\right.$$

解方程组得$a_0=3.8,a_1=2.4,a_2=1.2$ α = 1. 2 $a_{2}=1.2$

于是，所求的拟合函数为

$$y=F(\:x_{1}\:,x_{2}\:)\:=3.8\:+2.\:4x_{1}\:+1.\:2x_{2}$$

多变量线性拟合法算法

$\textcircled{1}$ 输人数据$x_{mi}$ 和$y_{\alpha}\left(m=1,2,\cdots,n;i=1,2,\cdots,k\right)$

②计算正规方程组的系数：

![](https://storage.simpletex.cn/view/fCvczeqWNf7fDVks3WarN9Xq6P9wow590)

$\textcircled{3}$ 解正规方程组
$$\begin{aligned}
\text{1111111111111} \\
l_{00}a_{0}+l_{01}a_{1}+\cdots+l_{0k}a_{k}& \text{=go}  \\
l_{10}a_{0}+l_{11}a_{1}+\cdots+l_{1\lambda}a_{\lambda}& =g_{1}  \\
&\text{:} \\
l_{i0}a_{0}+l_{i1}a_{1}+\cdots+l_{i\lambda}a_{\lambda}& =g_{i} 
\end{aligned}$$

求出$a_0$ Co $a_{0},a_{1},\cdots,a_{k}$

$\textcircled{4}$ 输出$a_0$ a $a_{0},a_{1},\cdots,a_{k}$

------------------------------------------------------------------

# 3.3非线性数据线性化

本章介绍的例3-1和例3-2都是线性拟合的例子.在这两个例子中，数据与数据之间的关系呈线性关系.如果数据与数据之间的关系呈线性关系，则可以按这两个例子所介绍的方法求拟合函数：否则，就不能直接使用这两个例子所介绍的方法求拟合函数.但是，在这类问题中有一些问题，经过数据与数据之间的变换之后能得到线性关系，这时就可以直接使用前面介绍过的方法.

例3-3某炼钢厂出钢时用的钢包（用来装钢水的容器）是用特殊耐火材料制成的，在使用过程中，由于钢水及炉渣对包衬耐火材料的侵蚀，使其容量随着使用次数的增多而增大.为了找出使用次数$x$ 与容量$y$ 之间的函数关系，工程技术人员做了15次测试，测试数据如表3-5所示.试用数据拟合法找出使用次数$x$ 与容量$y$ 之间的函数关系。

表3-5例3-3数据表

$i$ | 使用次数 $x_i$ | 容量 $y_i$
---|---|---
1 | 2 | 6.42
2 | 3 | 8.20
3 | 4 | 9.58
4 | 5 | 9.50
5 | 6 | 9.70
6 | 7 | 10.00
7 | 8 | 9.93
8 | 9 | 9.99
9 | 10 | 10.49
10 | 11 | 10.59
11 | 12 | 10.60
12 | 13 | 10.80
13 | 14 | 10.60
14 | 15 | 10.90
15 | 16 | 10.76

解为了找出使用次数$x$ 和容量$y$ 之间的函数关系，先画出散点图如图3-2所示

![](https://storage.simpletex.cn/view/fQkvyvMMMFha0yVHkVAbwAf24aFng3BBf)

按照图3-2中散点的趋势，凭直观可以画出一条近似曲线，使这些点或者落在这条曲线上.或者落在曲线的两侧，而这条近似曲线大致上像一条双曲线，因而可以把使用次数$x$ 与容量$y$ 之间的关系近似表示为

图3-2例3-3数据散点图

$$\frac{1}{y}=a+b\:\frac{1}{x}$$

这是双曲线方程的一种形式，其中$a$ 和$b$ 为待定参数.

------------------------------------------------------------------

为了确定待定参数$a$ 和$b$ ，可以直接采用最小二乘法.但这样得出的方程组为非线性方程组，而非线性方程组一般是比较难求解的.

令$X=\frac1x$ 和$Y=\frac1y$ ,得到$Y=a+bX.$ 这是一个线性函数,现取它作为拟合函数由关系式$X=\frac1x$ 和$Y=\frac{1}{y}$ 得到$X_{i}= \frac 1{x_{i}}($ $i= 1$ ,2 $, \cdots , 15$ ) 和$Y_{i}= \frac 1{y_{i}}($ $i= 1$ ,2 $, \cdots$ 15），从而得到一个新的数据表，如表3-6所示.

表3-6例3-3新数据表

| $i$ | $x_i$ | $y_i$ | $X_i=\frac{1}{x_i}$ | $Y_i=\frac{1}{y_i}$ |
| --- | --- | --- | --- | --- |
| 1 | 2 | 6.42 | 0.5000 | 0.1558 |
| 2 | 3 | 8.20 | 0.3333 | 0.1220 |
| 3 | 4 | 9.58 | 0.2500 | 0.1044 |
| 4 | 5 | 9.50 | 0.2000 | 0.1053 |
| 5 | 6 | 9.70 | 0.1667 | 0.1031 |
| 6 | 7 | 10.00 | 0.1429 | 0.1000 |
| 7 | 8 | 9.93 | 0.1250 | 0.1007 |
| 8 | 9 | 9.99 | 0.1111 | 0.1001 |

| $i$ | $x_i$ | $y_i$ | $X_i=\frac{1}{x_i}$ | $Y_i=\frac{1}{y_i}$ |
| --- | --- | --- | --- | --- |
| 9 | 10 | 10.49 | 0.1000 | 0.0953 |
| 10 | 11 | 10.59 | 0.0909 | 0.0944 |
| 11 | 12 | 10.60 | 0.0833 | 0.0943 |
| 12 | 13 | 10.80 | 0.0769 | 0.0926 |
| 13 | 14 | 10.60 | 0.0714 | 0.0943 |
| 14 | 15 | 10.90 | 0.0667 | 0.0917 |
| 15 | 16 | 10.76 | 0.0625 | 0.0929 |

有了新数据表和选定的拟合函数，就可以按最小二乘法确定待定参数$a$ 和$b$ 由定理3.1得到正规方程组

$$\left[\begin{array}{c}15a\:+\left[\:\sum_{i=1}^{15}X_i\:\right]b\:=\:\sum_{i=1}^{15}Y_i\\\\\left[\:\sum_{i=1}^{15}X_i\:\right]a\:+\left[\:\sum_{i=1}^{15}X_i^2\:\right]b\:=\:\sum_{i=1}^{15}X_iY_i\end{array}\right]$$

$$\sum_{i=1}^{13}X_{i}\approx2.380\:7\:,\:\sum_{i=1}^{13}Y_{i}\approx1.546\:9\:,\:\sum_{i=1}^{13}X_{i}^{2}\approx0.584\:2\:,\:\sum_{i=1}^{13}X_{i}Y_{i}\approx0.272\:7.$$
而们代人正规方程组(3.11)得

$$\begin{array}{c}15a+2.\:380\:7b=1.\:546\:9\\2.\:380\:7a+0.\:584\:2b=0.\:272\:7\end{array}$$

解方程组得$a\approx 0. 082$ 4 $, b\approx 0. 131$ 8. 故

$$Y=0.0824+0.1318X$$

即有

$$\frac1y=0.\:082\:4+0.\:131\:8\:\frac1x$$

------------------------------------------------------------------

于是，拟合函数

$$y=\frac{x}{0.\:082\:4x+0.\:131\:8}$$

例3-4已知一组数据如表3-7所示，求一个经验函数，形如$y=a\mathrm{e}^{6x}\left(\begin{array}{c}a,b\\\end{array}\right)$ 为常数），使它与表3-7中的数据相拟合.

表3-7例3-4数据表

| x | 0 | 1 | 2 | 3 | 4 |
|---|---|---|---|---|---|
| y=f(x) | 1.5 | 2.5 | 3.5 | 5 | 7.5 |

解据题意，表3-7中的数据大体上满足函数关系$y=a\mathrm{e}^{bx}.$ 所以，表3-7的拟合函数为$y=a\mathrm{e}^{bx}.$ 为了便于确定$a$ 和$b$ ，可以通过变量变换把$y=a\mathrm{e}^{bx}$ 转换为线性函数，然后用最小二乘法来确定$a$ 和$b$ .

先对$y=a\mathrm{e}^{bx}$ 两边取自然对数得

$$\mathrm{ln}y=\mathrm{ln}a+bx$$

令$Y= \ln y$ $, A= \ln a$ $, B= b$ B=b $B=b$ 和$X=x$ ，则有

$$Y=A+BX$$

这是一个线性函数，取它作为拟合函数.

由$Y=\ln y$ 和$X=x$ 得到$Y_{i}=\ln y_{i}$ 和$X_i=x_i$ ，从而得到新的数据表，如表3-8所示.

表3-8例3-4新数据表

| i | x_i | y_i | X_i | Y_i = lny_i |
|---|-----|-----|-----|--------------|
| 1 | 0  | 1.5 | 0  | 0.405465   |
| 2 | 1  | 2.5 | 1  | 0.916291   |
| 3 | 2  | 3.5 | 2  | 1.252763   |
| 4 | 3  | 5.0 | 3  | 1.609438   |
| 5 | 4  | 7.5 | 4  | 2.014903   |

有了拟合函数，又有了新的数据表，就可以使用最小二乘法确定$a$ 和b.由定理3.1得到正规方程组

![](https://storage.simpletex.cn/view/fyxDOaBFKQegX3us09G9otXrtdycINlMQ)

$$1\:\sum_{i=1}^{s}\:X_{i}=10\:,\:\sum_{i=1}^{s}\:Y_{i}=6.\:19886\:,\:\sum_{i=1}^{s}\:X_{i}^{2}=30\:,\:\sum_{i=1}^{s}\:X_{i}Y_{i}=16.\:309743\:,$$

------------------------------------------------------------------

正规方程组(3.12)得

$$\begin{cases}&5A+10B=6.\:19886\\&10A+30B=16.\:309743\end{cases}$$

解上述方程组得$A=0.457367$ $B\approx0.3912023$ 又由$A=\ln a$ 得$a=1.579910,b$ $=B\approx0.3912023$ .

于是，所求的拟合函数为

$$y=1.579910\mathrm{e}^{0.3912023s}$$

在实践中，有时要进行多项式拟合.多项式拟合也可以采用非线性数据线性化的方法.

设有两个量：和$y$ 基本满足$m$ 次多项式函数，经过实验或测量得到数据表（表3-9)，从而可以把

$$y=a_0+a_1z+a_2z^2+\cdots+a_nz^n$$

作为给定数据的拟合函数，其中$a_0$ $, a_1$ $, \cdots , a_n$ 为待定参数.

表3-9多项式拟合数据表

| z | z₁ | z₂ | ... | zn |
 |-----|----|----|-----|----|
 | y=f(z)| y₁ | y₂ | ... | yn |

令x2 =2 $x_2=z^2$ $x_1= z$ $, x_2= z^2$ $, \cdots , x_n$ $= z^n$ ,则由(3.13)式有$y=a_{0}+a_{1}x_{1}+a_{2}x_{2}+\cdots+a_{n}x_{n}$ 记为F（x1，x，，x）

使它变成多变量线性拟合．

在数据拟合法中，当选定拟合函数后，非线性拟合函数能否线性化是首先要考虑的问题.为了方便读者对非线性拟合函数进行线性化，表3－10中给出了常用非线性拟合函数线性化的方法.

表3-10常用非线性拟合函数线性化的方法

| 非线性拟合函数的形式 | 对非线性拟合函数线性化为Y = A + BX | 需做的变换 |
|----------------------|------------------------------------|----------------|
| $y = a + b \ln x$    | $y = a + b \ln x$                  | $X = \ln x$, Y=y, A=a, B=b |
| $y = ae^{bx}$       | $\ln y = \ln a + bx$               | $X = \ln x$, Y=ln y, A=a, B=b |
| $y = a + \frac{b}{x}$ | $y = a + \frac{1}{x}$ | $X = \frac{1}{x}$, Y=y, A=a, B=b |

------------------------------------------------------------------

续上表

| 非线性拟合函数的形式 | 对非线性拟合函数转化为 Y = A + BX | 需做的变换 |
|------------------------|------------------------------------|----------------|
| $y = \frac{x}{a + bx}$ | $\frac{1}{y} = b + \frac{a}{x}$ | $X = \frac{1}{x}, Y = \frac{1}{y}, A = b, B = a$ |
| $y = (a + bx)^{-2}$ | $y^{-\frac{1}{2}} = a + bx$ | $X = x^{\frac{1}{2}}, Y = y^{\frac{1}{2}}, A = a, B = b$ |
| $y = axe^{-bx}$ | $\ln \frac{y}{x} = \ln a - bx$ | $X = x, Y = \ln \frac{y}{x}, A = \ln a, B = -b$ |
| $y = \frac{1}{1 + ae^{bx}}$ | $\left[\frac{1}{y} - 1\right] = \ln a + bx$ | $X = x, Y = \ln \left(\frac{1}{y} - 1\right), A = \ln a, B = b$

# 3.4正交多项式拟合

多项式拟合的做法是：先把多项式拟合函数变成多变量拟合函数，然后按照多变量拟合法求出多项式的系数ao $a_0$ $a_0$ $, a_1$ $, \cdots$ $, a_n$ .在多变量拟合法中，要解一个正规方程组.理论上可以证明该正规方程组有惟一解，但当多项式的次数比较高时，正规方程组就会变成病态方程组.所谓病态方程组，就是如果方程组$Ax=b$ 中的系数矩阵$A$ 和常数项$b$ 有微小变化，就会引起方程组的解很大变化，则方程组$Ax=b$ 就是一个病态方程组.为了克服这个缺点，把多项式拟合函数取为

$$\begin{aligned}\text{y}&=\Psi_{n}\left(x\right)=a_{0}p_{0}\left(x\right)+a_{1}p_{1}\left(x\right)+\cdots+a_{n}p_{n}\left(x\right)\\&=\sum_{k=0}^{n}\:a_{k}p_{k}\left(\:x\:\right)\end{aligned}$$

其中a $a_0$ $a_0$ $, a_1$ $, \cdots$ $, a_n$ an $a_{\mathrm{u}}$ 为待定参数px（x） $. p_k($ $x)$ $,p_{k}\left(\:x\right)\left(\:k=0\:,1\:,\cdots,m\:\right)$ 是$k$ 次多项式.

很显然$,y^{*}=\Psi_{n}\left(x\right)$ 是一个$m$ 次多项式函数.

把$x_i$ 代人(3.14)式得到$y_{i}$ 的近似值$y_i^*$ ，则$\gamma_{i}^{a}$ 与$y_{\mathrm{i}}$ 就可能产生偏差.记$y_{i}^{*}$ 与$y_{i}$ 的偏差为8，有

$$\delta_{i}=y_{i}-y_{i}^{*}=y_{i}-\sum_{k=0}^{n}\:a_{k}\:p_{k}\:(\:x_{i}\:)\quad(\:i=1\:,2\:,\cdots,n\:)$$

为了求得ao $a_0$ $a_0,a_1,\cdots,a_n$ ，按最小二乘法选择$a_0$ a $a_0$ $, a_1$ $, \cdots$ $, a_n$ an $a_{n}$ 使误差$\delta_{i}$ 的平方和最小，即选择$a_0$ a $a_0$ $, a_1$ $, \cdots , a_n$ ，使$\delta_i^2$ 最小.由于从实验或测量中得到的数据的精度

------------------------------------------------------------------

不同，通常在每一个$\delta_{\mathrm{i}}$ 的前面乘上一个表示数据精度的权数$\alpha_{i}$ .即要使

$$\sum_{i=1}^{n}\:\left(\:\alpha_{i}\delta_{i}\:\right)^{2}=\:\sum_{i=1}^{n}\:\alpha_{i}^{2}\delta_{i}^{2}=\:\sum_{i=1}^{n}\:\omega_{i}\delta_{i}^{2}$$

最小.其中$\omega_{i}=\alpha_{i}^{2}$ 称为权因子.而
$$\sum_{i=1}^{n}\:\omega_{i}\delta_{i}^{2}\:=\:\sum_{i=1}^{n}\:\omega_{i}\Big[\:y_{i}\:-\:\sum_{k=0}^{n}\:a_{k}\:p_{k}(\:x_{i}\:)\Big]^{2}\:\frac{\text{记为}}{\varphi(\:a_{0}\:,a_{1}\:,\cdots,a_{n}\:)}$$

因此,可以把选择$a_0$ a $a_0$ $, a_1$ $, \cdots$ $, a_n$ 使$\sum_{i=1}\omega_{i}\delta_{i}^{2}$ 最小的问题转化为求函数$\varphi ($ $a_0$ $a_{1}$ $, \cdots , a_{n}$ ) 极小值的问题.按多元函数求极小值的方法，对函数$\varphi ($ $a_{0}$ $, a_{1}$ $, \cdots , a_{n}$ ) 分别求关于ao $a_0$ $a_0$ $, a_1$ $, \cdots$ $, a_n$ 的导数，令其为0并联立起来得到方程组

$$\frac{\partial\varphi}{\partial a_{j}}=-2\:\sum_{i=1}^{n}\:\omega_{i}\Big[\:y_{i}\:-\:\sum_{k=0}^{n}\:a_{i}p_{i}\:(\:x_{i}\:)\:\Big]p_{j}(\:x_{i}\:)\:=0\quad(\:j=0\:,1\:,\cdots,m\:)$$

将方程组（3.15）整理后得

$$\sum_{i=1}^{n}\:\omega_{i}\Big[\:\sum_{i=0}^{n}\:a_{i}p_{i}\left(\:x_{i}\:\right)p_{j}(\:x_{i}\:)\Big]\:-\:\sum_{i=1}^{n}\:\omega_{i}\:y_{i}p_{j}(\:x_{i}\:)\:=0$$

即

$$\begin{aligned}&\sum_{k=0}^{n}\:a_{k}\Big[\:\sum_{i=1}^{n}\:\omega_{i}p_{k}\left(\:x_{i}\:\right)p_{j}\left(\:x_{i}\:\right)\:\Big]\:=\sum_{i=1}^{n}\:\omega_{i}\:y_{i}p_{j}\left(\:x_{i}\:\right)\\&\text{令 }c_{jk}=\sum_{i=1}^{n}\:\omega_{i}p_{k}\left(\:x_{i}\:\right)p_{j}\left(\:x_{i}\:\right)\:,b_{j}=\sum_{i=1}^{n}\:\omega_{i}\:y_{i}p_{j}\left(\:x_{i}\:\right),\text{则方程组(3.16)可}\\&\sum_{i=0}^{n}\:c_{jk}\:a_{k}=b_{j}\end{aligned}$$

方程组(3.17)也称为正规方程组，

显然，如果能找到$p_k($ $x)$ 满足下列关系式：

$$c_{jk}\:=\:\sum_{i=1}^{n}\:\omega_{i}p_{j}\left(\:x_{i}\:\right)p_{k}\left(\:x_{i}\:\right)=0\quad(\:j\neq k\:)\\c_{jj}\:=\:\sum_{i=1}^{\infty}\:\omega_{i}p_{j}\left(\:x_{i}\:\right)^{2}>0\quad(\:j,k=0,1,\cdots,m\:)$$

则正规方程组(3.17)变为

$$c_{kk}a_{k}=b_{k}$$

由（3.20）式可以求出

$$a_k=\frac{b_k}{c_{kk}}$$

定义3.3满足(3.18)式和(3.19)式的多项式$p_k(x)$ $p_k(x)$ $p_{k}\left(\:x\right)\left(\:k=0\:,1\:,\cdots,m\:\right)$ 通常称为正交多项式簇，确切地说，称为对数据$x_i$ 和对应的权数$\omega_{i}$ 的正交多项式簇，

------------------------------------------------------------------

常用的正交多项式簇有一些，在这里只介绍一个常用的等距节点正交多项式簇.

假设给定一组$n+1$ 个等距节点$\xi _{\mathrm{i} }($ $i= 0$ ,1 $, \cdots , n$ ) ，它们的间隔为$h$ ，选取权数$\omega_i=1$ ，引人变换

$$x=\frac{\xi-\xi_0}h$$

则$\xi_i$ 变为$x_i=i$ 等$n+1$ 个整数等距节点.

构造多项式

$$p_{n,s}\left(\:x\:\right)\:=\:\sum_{i=0}^{\infty}\:\left(\:-1\:\right)^{k}\left[\begin{array}{c}m\\k\end{array}\right]\left[\begin{array}{c}m+k\\k\end{array}\right]\frac{x^{(k)}}{n^{(k)}}$$

其中$x^{( \:k) }= x($ $x- 1$ $) \cdots ($ $x- k+ 1$ ) 且$x^{(\:0)}=1$ .可以证明， $p_{\infty,n}(x)$ 是在$x_i=i$ 等$n+1$ 个整数等距节点上权数$\omega_i=1$ 的正交多项式簇，其前6个多项式为
$$\begin{aligned}
&p_{0,s}(\:x\:)\:=1 \\
&p_{1,x}(\:x\:)\:=1\:-2\:\frac{x}{n} \\
&p_{2,s}=1\:-6\:\frac{x}{n}+6\:\frac{x\left(\:x-1\:\right)}{n\left(\:n-1\:\right)} \\
&p_{3,n}=1-12\:\frac{x}{n}+30\:\frac{x\left(\:x-1\:\right)}{n\left(\:n-1\:\right)}-20\:\frac{x\left(\:x-1\:\right)\left(\:x-2\:\right)}{n\left(\:n-1\:\right)\left(\:n-2\:\right)} \\
&\nu_{4.} =1\:-20\:\frac{x}{n}\:+90\:\frac{x\:(\:x-1\:)}{n\:(\:n-1\:)}\:-140\:\frac{x\:(\:x-1\:)\:(\:x-2\:)}{n\:(\:n-1\:)\:(\:n-2\:)}\:+70\:\frac{x\:(\:x-1\:)\:(\:x-2\:)\:(\:x-3\:)}{n\:(\:n-1\:)\:(\:n-2\:)\:(\:n-3\:)} \\
&_{3,n}=1-30\:\frac{x}{n}+210\:\frac{x\left(x-1\right)}{n\left(n-1\right)}-560\:\frac{x\left(x-1\right)\left(x-2\right)}{n\left(n-1\left(n-2\right)\right)}+630\:\frac{x\left(x-1\right)\left(x-2\right)\left(x-3\right)}{n\left(n-1\right)\left(n-2\right)\left(n-3\right)}+100\:\frac{x\left(x-1\right)\left(x-2\right)\left(x-3\right)}{n\left(n-1\right)\left(n-2\right)\left(n-3\right)} \\
&252\:\frac{x(\:x-1\:)\:(\:x-2\:)\:(\:x-3\:)\:(\:x-4\:)}{n(\:n-1\:)\:(\:n-2\:)\:(\:n-3\:)\:(\:n-4\:)}
\end{aligned}$$

# 练习与思考

1.求方程组
$$\begin{array}{cc}x_1&+2x_2&=1\\\\x_1&+x_2&=0\\\\x_1&-x_2&=1\end{array}$$

的最小二乘解.

2.给定数据表如表3-11所示，求形如$y=a+bx^{2}$ 的拟合函数

------------------------------------------------------------------

### 表3-11数据表

| x | 19 | 25 | 31 | 38 | 44 |
|---|----|----|----|----|----|
| y | 19 | 32.3 | 49 | 73.3 | 97.8 |

3.用最小二乘法求一个形如$y=\frac1{a+bx}$ 的经验公式，使之与如下数据（表3- 12)相拟合.

表3-12数据表

| x | 1.0 | 1.4 | 1.8 | 2.2 | 2.6 |
|-----|-----|-----|-----|-----|-----|
| y | 0.931 | 0.473 | 0.297 | 0.224 | 0.168 |

4.在某个低温过程中，函数$y$ 依赖于温度$\theta ($ $\mathbb{C} )$ 的测试数据如表3-13所示， 而且已知经验公式是$y=a\theta+b\theta^{2}$ ，试用最小二乘法确定$a$ 和$b$

表3-13数据表

| 0 | 1 | 2 | 3 | 4 |
|---|---|---|---|---|
| y | 0.8 | 1.5 | 1.8 | 2 |

5.给定数据表如表3-14所示，试用三次多项式拟合表中的数据.

表3-14数据表

$x$ | $-2$ | $-1$ | $0$ | $1$ | $2$
---|---|---|---|---|---
$y$ | $-0.1$ | $0.1$ | $0.4$ | $0.9$ | $1.6$

6.在某一化学反应里，据实验得到分解生成物的浓度与时间的数据如表3-15所示，试使用正交多项式拟合法构造一个5次多项式求$y$ 的近似值

表3-15数据表

时间(min) | 0   | 5    | 10   | 15   | 20   | 25   | 30   | 35   | 40   | 45   | 50   
|-------|-----|------|------|------|------|------|------|------|------|------|------|
| 浓度(x10^4)|1.27|2.16 | 2.86 | 3.44 | 3.87 | 4.15 | 4.37 | 4.51 | 4.60 | 4.66 |