# 2代数插值与数值微分

在工程技术中，经常会遇到只给定一个函数表，要求根据该函数表求出某些点上函数值的问题，

例如，某气象台经过气象探测得到高度与大气压的一些数据，这些数据如表2-1所示，

表2-2函数表

表2-1高度与大气压的探测数据

| x(高度) | 0 | 1.5 | 2.5 | 3 | 4.8 |
|---------|-----|-----|-----|-----|-----|
| y=f(x)(大气压) | 1 | 0.9 | 0.85| 0.7 | 0.67|

| | x | $x_0$ | $x_1$ | $\cdots$ | $x_n$ |
|---|---|---|---|---|---|
| y = f(x) | y | $y_0$ | $y_1$ | $\cdots$ | $y_n$ |

表2-1表示了高度与大气压的函数关系.从这个表可以知道，当高度为0时， 大气压为1；当高度为1.5时，大气压为0.9...... 当高度为4.8时，大气压为0.67. 但是，实际问题往往不仅仅要求出给定高度的大气压，而且还要求出任意高度的大气压，比如高度为2.7时的大气压，

上面提出的问题意思是说，给定一个函数的函数表（如表2-2所示），如何求出任意点的函数值.解决这个问题的其中一个办法是：根据表2-2按某些条件构造出一个函数$\varphi ($ $x)$ 来近似代替$f(x)$ .如果能构造函数$\varphi(x)$ 近似代替$f($ $x$ ) ，那么只要给出任何一个点$x^{'}$ ，就可以求出$\varphi(x^{\prime}$ ），用$\varphi ($ $x\:^{\prime })$ 近似代替$f(x^{'})$ .现在的问题是， $\varphi(x)$ 选取什么样的函数. $\varphi ($ $x)$ 的选取可以是多种多样的，它可以是代数多项式.也可以是三角多项式，还可以是有理分式，但是，为了便于计算函数值和研究函数的性质，一般选取代数多项式$p_{a}\left(x\right)$ 作为$\varphi(x)$ .构造代数多项式$p_x($ $x$ ) 来近似代替$f(x)$ ，称为代数插值. 本章主要讨论代数插值和函数的求导问题.

# 2.1线性插值与二次插值

# 2.1.1线性插值

线性插值是代数插值中最简单的一种情形.它的提法是： 给定$y= f($ $x$ ) 的函数表（如表2-3所示），构造函数$p_1(x)$ 满足条件： $\textcircled {\mathrm{I} }$ $p_{1}($ $x)$ 是一个不超过一次的代数多项式； $\textcircled {2}$ $p_{1}\left ( \:x_{0}\:\right ) = y_{0}$ ，p（x）=y

------------------------------------------------------------------

表2-3线性插值函数表

其中， $x_0$ 和$x_1$ 称为插值节点$; f($ $x$ ) 称为被插值函数： $p_1(x)$ 称为线性插值函数；条件$\textcircled{1}$ 和$\textcircled{2}$ 称为插值条件.

| x | x₀ | x₁ |
|-----|----|----|
| y = f(x) | y₀ | y₁ |

线性插值的目的是构造$p_1(x)$ 来近似代替$f(x)$ .当求某一点$x^{*}$ 的函数值$f(x^{*})$ 时，可以用$p_1(x^{*})$ 来近似代替$f(x^{*})$

因为$p_1(x)$ 满足插值条件$\textcircled{2}$ ，所以线性插值的几何意义是用过( $x_0$ $, y_0$ ) 和( $x_1$ $, y_1$ ) 两点的直线$y= p_1$ ( $x$ ) 来近似代替曲线$y$ $= f($ $x$ ) ，如图2-1所示.

![](https://storage.simpletex.cn/view/fcxWG7gsZvrtrf7xHgQBy0gBERUoS7d9i)

由初等几何知识可知，过两点的直线存在且惟一.因此， $. p_1($ $x)$ 存在且惟一.

图2-1线性插值的几何意义

线性插值函数$p_1($ $x)$ 有两种形式：Lagrange （拉格朗日）形式和Newton（牛顿）形式. 2.1.1.1线性插值函数的Lagrange形式

由直线方程的两点式可以直接得到

$$p_1\left(\:x\:\right)\:=\frac{x\:-x_1}{x_0\:-x_1}y_0\:+\frac{x\:-x_0}{x_1\:-x_0}y_1$$

$p_1($ $x)$ 称为Lagrange型线性插值函数；式（2.1)称为Lagrange型线性插值公式.

可以看到$p_1(x)$ 实际上是两个线性函数x一1 $\frac{x-x_1}{x_0-x_1}$ $:\frac{x-x_1}{x_0-x_1}$和$\frac{x-x_0}{x_1-x_0}$ x一$\frac{x-x_0}{x_1-x_0}$ 的线性组合.如果把这两个线性函数分别记为$l_0($ $x)$ 和$l_1(x)$ ，则有

$$p_1\left(x\right)=l_0\left(x\right)y_0+l_1\left(x\right)y_1$$

表2-4 $l_0($ $x)$ 和$l_1(x)$ 在节点处的取值

其中$l_0($ $x$ ) 和$l_1\left(\begin{matrix}x\end{matrix}\right)$ 称为一次插值基函数， 它们在插值节点处的取值参见表2-4. 2.1.1.2线性插值函数的Newton形式

| 函数值 | 节点 | x₀ | x₁ |
|--------|--------|----|----|
| l₀(x) | 1 | | 0 |
| l₁(x) | 0 | 1 | |

由于Newton形式的线性插值函数与一阶差商有关，所以在推导Newton形式的线性插值函数之前，先引人一阶差商的定义.

定义2.1若记$f($ $x_{i}$ $, x_{j}$ $) = \frac {f( \:x_{i}\:) \:- f( \:x_{j}\:) }{x_{i}\:- x_{j}}$ ，则称$f(x_i,x_j)$ 为函数$f($ $x$ ) 在节点$x_{i}$ 和$x_{j}$ 处的一阶差商，其中$x_i$ 与$x_j$ 互异. 特别地，当$i=0$ 和$i=1$ 时，有

------------------------------------------------------------------

$$f(\:x_0\:,x_1\:)\:=\frac{f(\:x_0\:)\:-f(\:x_1\:)}{x_0\:-x_1}$$

从一阶差商的定义可以看到

$$f(\:x_i\:,x_j\:)\:=\frac{f(\:x_i\:)\:-f(\:x_j\:)}{x_i\:-x_j}=\frac{f(\:x_j\:)\:-f(\:x_i\:)}{x_j\:-x_i}=f(\:x_j\:,x_i\:)$$

这就是说，一阶差商的值与节点的排列顺序无关.这种性质称为对称性，

特别地，当$i=0$ 和$j=1$ 时，有

$$f(\:x_0\:,x_1\:)\:=f(\:x_1\:,x_0\:)$$

已知$p_{1}\left(\begin{array}{c}{x}\end{array}\right)=a+bx$ 是一个直线方程且满足$p_{1}\left(\begin{array}{c}{x_{0}}\end{array}\right)=y_{0}$ 和$p_{1}\left(x_{1}\right)=y_{1}$ ，即它经过( $x_0$ $, y_0$ ) 和( $x_1$ $, y_1$ ) 两点.按点斜式直线方程$y- y_{0}= k($ $x- x_{0}$ ) ，其中$k$ 为斜率，有

$$\begin{aligned}
p_{1}\left(x\right)& =y_{0}\:+\frac{y_{1}\:-y_{0}}{x_{1}\:-x_{0}}(\:x\:-x_{0}\:) \\
&=f(\:x_{0}\:)\:+\frac{f(\:x_{1}\:)\:-f(\:x_{0}\:)}{x_{1}\:-x_{0}}(\:x-x_{0}\:) \\
&=f(\:x_{0}\:)\:+f(\:x_{0}\:,x_{1}\:)\:(\:x-x_{0}\:)
\end{aligned}$$

式(2.2)称为Newton型线性插值公式，对应的$p_1($ $x$ ) 称为Newton型线性插值函数.

从上面的讨论可以知道，线性插值函数$p_1(x)$ 有两种形式，尽管形式不同，但实质都一样.都是代表同一条直线，如图2-1所示.

前面已介绍过，线性插值是按插值条件构造插值函数$p_1(x)$ 来近似代替$f(x)$ 很显然， $,p_{1}\left(\begin{matrix}x\end{matrix}\right)$ 与$f(x)$ 之间必然存在误差，那么它们之间的误差为多少？

定理2.1设$p_1(x)$ 是过( $x_0$ $, y_0$ ) 和( $x_1$ $, y_1$ ) 两点的线性插值函数， $\left[\begin{smallmatrix}a&b\end{smallmatrix}\right]$ 是包含$\left[\begin{smallmatrix}x_0,x_1\end{smallmatrix}\right]$ 的任一区间，并设$f($ $x$ ) $\in$ $C^{1}$ [ $a$ $, b$ ] $, f^{\prime \prime }($ $x$ ) 在$\left[\begin{smallmatrix}a,b\end{smallmatrix}\right]$ 上存在，则对任意给定的$x\in [$ $a$ $, b$ ] ，总存在一点$\xi \in ($ $a$ $, b$ ) ，使得

$$R(x)=f(x)-p_1(x)=\frac{f''(\xi)}{2!}(x-x_0)(x-x_1)$$

其中$\xi$ 依赖于$x$

证对任一固定的$x$ ，引人辅助函数$\varphi ($ $t)$ .要求$\varphi ($ $x_{0}$ ) $= \varphi ($ $x_{1}$ ) $= \varphi ($ $x$ ) =0 ，不妨把$\varphi ($ $t)$ 表示为

$$\varphi(\:t\:)=f(\:t\:)\:-p_{1}(\:t\:)\:-k(\:t-x_{0}\:)\:(\:t-x_{1}\:)$$

其中$k$ 为待定常数

显然， $\varphi ($ $x_{0}$ ) $= \varphi ($ $x_{1}$ ) =0

要使$\varphi ($ $x$ ) =0 ，由(2.4)式得

$$\varphi(\:x\:)=f(\:x\:)\:-p_{1}\:(\:x\:)\:-k(\:x\:-x_{0}\:)\:(\:x\:-x_{1}\:)\:=0\\R(\:x\:)\:-k(\:x-x_{0}\:)\:(\:x-x_{1}\:)\:=0$$

即

------------------------------------------------------------------

由此得到

$$k=\frac{R(x)}{(\:x-x_0\:)\:(\:x-x_1\:)}$$

因而

$$\varphi(t)=f(t)-p_1(t)-\frac{R(x)}{(\:x-x_0\:)\:(\:x-x_1\:)}(\:t-x_0\:)\:(\:t-x_1\:)$$

有3个零点： $x_0$ $x_1$ 和$x$

对于$\varphi ($ $t)$ 的3个零点X $x_0$ $x_0$ $, x_1$ X1 $x_1$ 和$x$ ，它们可以构成两个子区间.由Rolle（洛尔）定理(若$f(t)$ 在$\left[\begin{smallmatrix}a&b\end{smallmatrix}\right]$ 上连续，在( $a$ $, b$ ) 上可导，且有$f($ $a$ ) $= f($ $b$ ) ，则在( $a$ $, b$ ) 内至少有一点$c$ ，使$f^{\prime }($ $c)$ =0 )可知$\varphi ^{\prime }($ $t)$ 在每个子区间上至少存在一个零点， $\varphi ^{\prime }($ $t)$ 在[ $a$ $b$ ] 上至少有两个零点，可记为$\xi_1$ 和$\xi_{2}$ ，即有$\varphi^{\prime}(\xi_{1})=0$ 和$\varphi ^{\prime }($ $\xi _{2}$ ) =0 . 同理， $\varphi ^{\prime \prime }($ $t)$ 在( $\xi _{1}$ $, \xi _{2}$ ) 上至少有一个零点，可记为$\xi$ ，即有$\varphi^{\prime\prime}(\xi)=0$

对$\varphi ($ $t)$ 求二次微商，得

$$\varphi^{\prime\prime}(\:t\:)=f^{\prime\prime}(\:t\:)\:-p^{\prime\prime}(\:t\:)\:-2!\:\frac{R(\:x\:)}{(\:x-x_{0}\:)\:(\:x-x_{1}\:)}$$

由于$p_1(t)$ 是$\iota$ 的一次多项式，所以有$p_{1}^{\prime \prime }($ $t)$ =0于是得到

$$\varphi''(\:t\:)=f''(\:t\:)\:-2\:!\:\frac{R(\:x\:)}{(\:x-x_0\:)\:(\:x-x_1\:)}$$

把$t=\xi$ 代人(2.5)式，并注意到$\varphi^{\prime\prime}(\xi)=0$ ，得

$$\varphi^{\prime\prime}(\xi)=f^{\prime\prime}(\xi)-2!\:\frac{R(\:x\:)}{(\:x-x_0\:)\:(\:x-x_1\:)}=0$$

移项后有

$$R(\:x\:)=\frac{f''(\:\xi)}{2\:!}(\:x-x_0\:)\:(\:x-x_1\:)$$

$R($ $x)$ 就是$f(x)$ 与$p_1(x)$ 的误差，称为线性插值余项.

对于线性插值余项，还可以进一步证明
$$\mid R(\:x\:)\:\mid\leqslant\frac{\left(\:x_{1}\:-x_{0}\:\right)^{2}}{8}\max_{s_{0}\leq s\leq s_{1}}\mid f^{\prime\prime}(\:x\:)\:\mid $$

(2.7）式的证明留给读者作为习题，

表2-5函数表

例2-1给定如表2-5所示的函数表.用Lagrange型线性插值公式求$\ln1.75$ 的近似值， 并估计误差.

| x | y = ln(x) |
|---|----------|
| 11   | 2.3979   |
| 12   | 2.4849   |

解根据Lagrange型线性插值公式（2.1），

有

$$p_1\left(\:x\:\right)=\frac{\left(\:x-12\:\right)}{\left(\:11-12\:\right)}\times2.\:397\:9+\frac{\left(\:x-11\:\right)}{\left(\:12-11\:\right)}\times2.\:484\:9$$

则

$$p_1(\:11.\:75\:)=\frac{11.\:75-12}{11-12}\times2.\:397\:9+\frac{11.\:75-11}{12-11}\times2.\:484\:9=2.\:463\:2$$

从而得到$\ln11.75\approx2.4632.$ 又因为

------------------------------------------------------------------

$$\begin{aligned}f(\:x\:)\:-p_{1}\:(\:x\:)&=\frac{f^{\prime\prime}(\xi)}{2!}(\:x-x_{0}\:)\:(\:x-x_{1}\:)\\&=\:-\frac{1}{2\xi^{2}}(\:x-11\:)\:(\:x-12\:)\end{aligned}$$

其中$\xi\in\left[11,12\right].$ 所以

$$\begin{aligned}
|f(\:x\:)\:-p_{1}\:(\:x\:)\:|& =\frac{1}{2\xi^{2}}\mid(\:x-11\:)\:(\:x-12\:)\:| \\
&\leqslant\frac{1}{2}\max_{\xi\in[11,12]}\frac{1}{\xi^{2}}\mid(\:x-11\:)\:(\:x-12\:)\:| \\
&=\frac{1}{2\times11^{2}}\mid(\:x-11\:)\:(\:x-12\:)\:\mid \\
\mid\ln11.\:75-p_{1}(\:11.\:75\:)\mid\leqslant & {\frac{1}{2\times11^{2}}}\mid(\:11.\:75-11\:)\:(\:11.\:75-12\:)\mid \\
\text{一}& 0.0007748 
\end{aligned}$$

于是

# 2.1.2二次插值

表2-6二次插值函数表

二次插值的提法是：

给定函数表（如表2-6所示），构造函数$p_2\left(\begin{matrix}x\end{matrix}\right)$ 满足条件：

| x | $x_0$ | $x_1$ | $x_2$ |
|-----|------|------|------|
| y=f(x) | $y_0$ | $y_1$ | $y_2$ |

$\textcircled {\mathrm{D} }p_2($ $x)$ 是一个不超过二次的代数多项式；

$\textcircled{2}p_{2}\left(\begin{array}{c}{x_{0}}\end{array}\right)=y_{0},p_{2}\left(\begin{array}{c}{x_{1}}\end{array}\right)=y_{1}$ 和$p_{2}\left(\:x_{2}\:\right)=y_{2}$

其中Xo $x_0$ $x_0,x_1$ X1 $x_1$ 和$x_2$ 称为插值节点$; f($ $x$ ) 称为被插值函数： $p_2($ $x)$ 称为二次插值函数；条件0和$\textcircled{2}$ 称为插值条件.

二次插值的目的是构造$p_2\left(\begin{matrix}x\end{matrix}\right)$ 来近似代替$f($ $x$ ) .当求某一点$x^{*}$ 的函数值$f(x^{\prime}$ ）时，可以用$p_2(x^{\prime}$ )来近似代替$f(x^{\prime})$

根据二次插值的提法， $p_2($ $x)$ 是一个不超过二次的代数多项式，所以不妨假设

$$p_2\left(\:x\:\right)=a_0+a_1x+a_2x^2$$

其中a $a_0$ $a_0$ $, a_1$ a $a_1$ 和$a_2$ 为待定常数

为了确定这三个待定常数，可以利用插值条件$\textcircled{2}$ 得到三个等式，把它们联立起来组成方程组

$$\begin{aligned}&p_{2}\left(\:x_{0}\:\right)=a_{0}\:+\:a_{1}\:x_{0}\:+\:a_{2}\:x_{0}^{2}=y_{0}\\&p_{2}\left(\:x_{1}\:\right)=a_{0}\:+\:a_{1}\:x_{1}\:+\:a_{2}\:x_{1}^{2}=y_{1}\\&=a_{0}\:+\:a_{1}\:x_{2}\:+\:a_{2}\:x_{2}^{2}\:=y_{2}\end{aligned}$$

方程组（2.8）的系数行列式为

------------------------------------------------------------------

$$\begin{vmatrix}1&x_0&x_0^2\\1&x_1&x_1^2\\1&x_2&x_2^2\end{vmatrix}=(\:x_1-x_0\:)\:(\:x_2-x_0\:)\:(\:x_2-x_1\:)$$

所以，只要Xo $x_0$ $x_0,x_1$ 和$x_2$ 互不相等，方程组的解即ao $a_0$ $a_0,a_1$ a $a_1$ 和$a_2$ 存在且惟一，这样就可以构造出惟一的$p_2(x)$

与线性插值函数一样，二次插值函数$p_2\left(\begin{matrix}x\end{matrix}\right)$ 也有两种形式：Lagrange形式和Newton形式.

2.1.2.1二次插值函数的Lagrange形式

表2-7 $l_0\left(x\right),l_1\left(x\right)$ 和$l_2(x)$ 在节点处的取值

设$p_{2}\left(\begin{array}{c}{x}\end{array}\right)=l_{0}\left(\begin{array}{c}{x}\end{array}\right)y_{0}+l_{1}\left(\begin{array}{c}{x}\end{array}\right)y_{1}+$ $l_2(x)y_2$ ，其中$l_0\left(\begin{matrix}x\end{matrix}\right)$ ， $l_1($ $x$ ) 和$l_2\left(\begin{matrix}x\end{matrix}\right)$ 为不超过二次的代数多项式，且满足表2-7.

| 函数 | 节点 |
| ---- | ---- |
| $l_0(x)$ | $x_0 = 1$, $x_1 = 0$, $x_2 = 0$ |
| $l_1(x)$ | $x_0 = 0$, $x_1 = 1$, $x_2 = 0$ |
| $l_2(x)$ | $x_0 = 0$, $x_1 = 0$, $x_2 = 1$ |

容易验证， $p_2\left(\begin{matrix}x\end{matrix}\right)$ 满足插值条件$\textcircled{1}$ 和$1\textcircled{2}$ .因此，只要找到满足表2-7的$l_0(x)$ lo(x) $l_0\left(\begin{matrix}x\end{matrix}\right),l_1\left(\begin{matrix}x\end{matrix}\right)$ I(x） $l_1(x)$ 和$l_2($ $x)$ ，就可以构造出$p_2(x)$ .下面根据表2-7来构造

$l_0\left(\begin{matrix}x\end{matrix}\right),l_1\left(\begin{matrix}x\end{matrix}\right)$ 和$l_2($ $x)$ .

首先构造$l_0(x)$ .据表$2-7,l_{0}\left(\begin{array}{c}{x_{1}}\end{array}\right)=0$ 和$l_0\left(\begin{matrix}x_2\end{matrix}\right)=0$ ，所以$l_0\left(\begin{matrix}x\end{matrix}\right)$ 必有因子$(x-$ $x_1$ x1 $x_1$ ) ( $x- x_2$ ) . 又因$l_0($ $x)$ 为不超过二次的代数多项式，而（x-x ( $x- x_1$ $\left(\:x-x_{1}\:\right)\left(\:x-x_{2}\:\right)$ （x-x） ( $x- x_2$ ) 已是一个二次代数多项式，故$l_0\left(\begin{matrix}x\end{matrix}\right)$ 只可能有一个常数因子，从而有

$$l_{0}\left(\:x\:\right)=A\left(\:x-x_{1}\:\right)\left(\:x-x_{2}\:\right)$$

其中$A$ 为待定常数

为了确定待定常数$A$ ，利用$l_0\left(\begin{matrix}x_0\end{matrix}\right)=1$ 得

$$l_0\left(\begin{array}{c}x_0\end{array}\right)=A\left(\begin{array}{c}x_0-x_1\end{array}\right)\left(\begin{array}{c}x_0-x_2\end{array}\right)=1$$

由此推得

$$A=\frac{1}{\left(\:x_0\:-x_1\:\right)\left(\:x_0\:-x_2\:\right)}$$

因此

$$l_0\left(\:x\:\right)=\frac{\left(\:x-x_1\:\right)\left(\:x-x_2\:\right)}{\left(\:x_0-x_1\:\right)\left(\:x_0-x_2\:\right)}$$

用同样的方法可以求得

$$l_{1}\left(\:x\:\right)=\frac{\left(\:x-x_{0}\:\right)\left(\:x-x_{2}\:\right)}{\left(\:x_{1}-x_{0}\:\right)\left(\:x_{1}-x_{2}\:\right)}\\l_{2}\left(\:x\:\right)=\frac{\left(\:x-x_{0}\:\right)\left(\:x-x_{1}\:\right)}{\left(\:x_{2}\:-x_{0}\:\right)\left(\:x_{2}\:-x_{1}\:\right)}$$

因此

$$p_{2}\left(x\right)=\frac{\left(\:x-x_{1}\:\right)\left(\:x-x_{2}\:\right)}{\left(\:x_{0}-x_{1}\:\right)\left(\:x_{0}-x_{2}\:\right)}y_{0}+\frac{\left(\:x-x_{0}\:\right)\left(\:x-x_{2}\:\right)}{\left(\:x_{1}-x_{0}\:\right)\left(\:x_{1}-x_{2}\:\right)}y_{1}+\frac{\left(\:x-x_{0}\:\right)\left(\:x-x_{1}\:\right)}{\left(\:x_{2}-x_{0}\:\right)\left(\:x_{2}-x_{1}\:\right)}y_{2}$$

------------------------------------------------------------------

其中$l_0\left(\begin{matrix}x\end{matrix}\right),l_1\left(\begin{matrix}x\end{matrix}\right)$ 和$l_2($ $x)$ 称为二次插值基函数： $;p_2\left(\begin{matrix}x\end{matrix}\right)$ 称为Lagrange 型二次插值函数；（2.9)式称为Lagrange型二次插值公式.

2.1.2.2二次插值函数的Newton形式

由于Newton形式的二次插值函数与二阶差商有关，所以在推导Newton形式的二次插值函数之前，先引人二阶差商的定义.

定义 2.2若记$f($ $x_{i}, x_{j}, x_{k}$ ) $= \frac {f( \:x_{i}, x_{j}\:) \:- f( \:x_{j}, x_{i}\:) }{x_{i}\:- x_{k}}$ ，则称$f($ $x_{i}$ $, x_{j}$ $, x_{k}$ ) 为函数$f$ ( $x$ ) 在节点x： $x_i$ $x_i,x_j$ 和$x_k$ 处的二阶差商，其中x $x_i$ $x_i,x_j$ x $x_{j}$ 和$x_k$ 互异

特别地，当$i= 0$ $, j= 1$ 和$k=2$ 时，有

$$f(\:x_0\:,x_1\:,x_2\:)\:=\frac{f(\:x_0\:,x_1\:)\:-f(\:x_1\:,x_2\:)}{x_0\:-x_2}$$

与一阶差商一样，二阶差商也具有对称性.也就是说，在求二阶差商时，无论$x_i,x_j$ 和$x_k$ 如何排列，它们的值都是一样的.

因为$p_2($ $x)$ 为不超过二次代数多项式，所以为了构造上的方便，可以假设

$$p_2\left(\:x\:\right)=A+B\left(\:x-x_0\:\right)+C\left(\:x-x_0\:\right)\left(\:x-x_1\:\right)$$

其中$A,B$ 和$C$ 为待定常数.

确定三个待定常数$A$ $, B$ 和$C$ ，需要利用插值条件$:\textcircled{2}$

由插值条件$p_{2}\left(\begin{matrix}x_{0}\\\end{matrix}\right)=y_{0}$ 得

$$A=y_0=f(\:x_0\:)$$

由插值条件$p_{2}\left(\begin{matrix}x_{1}\\\end{matrix}\right)=y_{1}$ 得

$$A\:+B\left(\:x_{1}\:-x_{0}\:\right)\:=f(\:x_{0}\:)\:+B\left(\:x_{1}\:-x_{0}\:\right)\:=y_{1}\:=f(\:x_{1}\:)$$

$$B=\frac{f(\:x_1\:)\:-f(\:x_0\:)}{x_1\:-x_0}=f(\:x_1\:,x_0\:)\:=f(\:x_0\:,x_1\:)$$

故

由插值条件$p_{2}\left(\begin{matrix}x_{2}\\\end{matrix}\right)=y_{2}$ 得
$$\begin{gathered}
A+B(\:x_{2}-x_{0}\:)\:+C(\:x_{2}-x_{0}\:)\:(\:x_{2}-x_{1}\:) \\
f(\:x_{0}\:)\:+f(\:x_{0}\:,x_{1}\:)\:(\:x_{2}\:-x_{0}\:)\:+C(\:x_{2}\:-x_{0}\:)\:(\:x_{2}\:-x_{1}\:)\:=y_{2}\:=f(\:x_{2}\:) \\
C\:=\frac{f(\:x_{2}\:)\:-f(\:x_{0}\:)}{(\:x_{2}\:-x_{0}\:)\:(\:x_{2}\:-x_{1}\:)}-\frac{f(\:x_{0}\:,x_{1}\:)}{x_{2}\:-x_{1}} \\
=\frac{f(\:x_{2}\:,x_{0}\:)\:-f(\:x_{0}\:,x_{1}\:)}{x_{2}\:-x_{1}} \\
=f(\:x_{0}\:,x_{1}\:,x_{2}\:) 
\end{gathered}$$

从而有

于是，由(2.10)式得

$$p_2\left(\:x\:\right)=f(\:x_0\:)\:+f(\:x_0\:,x_1\:)\:(\:x-x_0\:)\:+f(\:x_0\:,x_1\:,x_2\:)\:(\:x-x_0\:)\:(\:x-x_1\:)$$

可以验证， $p_2\left(\begin{matrix}x\end{matrix}\right)$ 满足插值条件$\textcircled{1}$ 和$1\textcircled{2}$ ，它是一个二次插值函数. $p_2\left(\begin{matrix}x\end{matrix}\right)$ 称为Newton型二次插值函数，（2.11)式称为Newton 型二次插值公式

------------------------------------------------------------------

二次插值也称为抛物线插值.抛物线插值的几何意义是用抛物线来代替曲线$y= f($ $x$ ) ，如图2-2所示。

![](https://storage.simpletex.cn/view/fAROvW6TQqiQpHD2k1vemINZLWZawGYFY)

定理2.2设$p_2($ $x)$ 是过$\left(\begin{array}{c}x_0\end{array},y_0\right),\left(\begin{array}{c}x_1,y_1\end{array}\right)$ (x1,y) ( $x_1$ $, y_1$ ) 和( $x_2$ $, y_2$ ) 三点的二次插值函数， $\left[\begin{smallmatrix}a,b\end{smallmatrix}\right]$ 是包含$x_0$ $, x_1$ $x_2$ 的任一区间，并设$f($ $x$ ) $\in$ $C^{2}$ [ $a$ $, b$ ] $, f^{\prime \prime }($ $x$ ) 在$:\left[\begin{array}{c}a&0\\a&0\end{array}\right]$ $b$ ] 上存在，则对任意给定的$x\in [$ $a$ $, b$ ] ，总存在一点$\xi \in ($ $a$ $, b$ ) ，使得

图2-2抛物线插值的几何意义

$$R(\:x\:)\:=f(\:x\:)\:-p_{2}(\:x\:)\:=\frac{f^{\prime\prime\prime}(\:\xi\:)}{3!}(\:x-x_{0}\:)\:(\:x-x_{1}\:)\:(\:x-x_{2}\:)$$

其中$\xi$ 依赖于$x$

证对任一固定的$x$ ，引入辅助函数$\varphi ($ $t)$ .要使$\varphi ($ $x_{0}$ ) $= \varphi ($ $x_{1}$ ) $= \varphi ($ $x_{2}$ ) = $\varphi ($ $x)$ =0 ，不妨把$\varphi ($ $t)$ 表示为

$$\varphi(\:t\:)\:=f(\:t\:)\:-p_{2}(\:t\:)\:-k(\:t\:-x_{0}\:)\:(\:t\:-x_{1}\:)\:(\:t\:-x_{2}\:)$$

其中$k$ 为待定常数

显然， $\varphi ($ $x_{0}$ ) $= \varphi ($ $x_{1}$ ) $= \varphi ($ $x_{2}$ ) =0

要使$\varphi ($ $x$ ) =0 ，由(2.13）式得
$$\varphi(\:x\:)=f(\:x\:)\:-p_{2}\:(\:x\:)\:-k(\:x\:-x_{0}\:)\:(\:x\:-x_{1}\:)\:(\:x\:-x_{2}\:)\:=0\\R(\:x\:)\:-k(\:x\:-x_{0}\:)\:(\:x\:-x_{1}\:)\:(\:x\:-x_{2}\:)\:=0$$

即

由此得到

$$k=\frac{R(x)}{(\:x-x_0\:)\:(\:x-x_1\:)\:(\:x-x_2\:)}$$

因此

$$\varphi(\:t\:)\:=f(\:t\:)\:-p_{2}(\:t\:)\:-\frac{R(\:x\:)}{(\:x\:-x_{0}\:)\:(\:x\:-x_{1}\:)\:(\:x\:-x_{2}\:)}(\:t\:-x_{0}\:)\:(\:t\:-x_{1}\:)\:(\:t\:-x_{2}\:)$$

有4个零点X0 $x_0$ ${: }x_{0}$ $, x_{1}$ $, x_{2}$ X2 $x_2$ 和$x$

$\varphi ($ $t)$ 的4个零点X $x_0$ $x_0$ , $x_1$ , $x_2$ X $x_2$ 和$x$ 可以构成3个子区间.由Rolle定理可知$\varphi ^{\prime }($ $t)$ 在$\left[\begin{smallmatrix}a&b\end{smallmatrix}\right]$ 上至少有3个零点，可记为与$\xi_1$ $\xi _1$ $, \xi _2$ 5 $\xi_2$ 和$\xi_3$ .由S $\xi_1$ $\xi _1$ $, \xi _2$ 5 $\xi_2$ 和$\xi_3$ 又可以构成两个子区间，故$\varphi ^{\prime \prime }($ $t)$ 在$\left[\begin{smallmatrix}a&b\end{smallmatrix}\right]$ 上至少有2个零点，可记为$\eta_{1}$ 和$\mathbf{\eta } _{2}\cdots \cdots \varphi ^{\prime \prime \prime }($ $t)$ 在( $\eta_1$ $\eta_{2}$ )上至少有1个零点，把这个零点记为，即有$\varphi^{\prime\prime\prime}(\xi)=0$

现对$\varphi ($ $t)$ 求三次微商.由于$p_2\left(\begin{array}{c}t\end{array}\right)$ 是$\iota$ 的二次多项式，所以求三次微商后，它的值为0.于是

$$\varphi^{\prime\prime\prime}(\:t\:)\:=f^{\prime\prime\prime}(\:t\:)\:-3\:!\:\frac{R(\:x\:)}{(\:x\:-x_{0}\:)\:(\:x\:-x_{1}\:)\:(\:x\:-x_{2}\:)}$$

把$\xi$ 代人(2.14)式并移项后得

------------------------------------------------------------------

$$R(\:x\:)=\frac{f^{\prime\prime\prime}(\:\xi\:)}{3\:!}(\:x-x_{0}\:)\:(\:x-x_{1}\:)\:(\:x-x_{2}\:)$$

表2-8函数表

例2-2给定如表2-8所示函数表，试用Newton型二次插值公式求lnl1.75的近似值，并估计误差.

| x | $y=\ln x$ | 
|------|----------|
| 11 | 2.3979 |
| 12 | 2.4849 |
| 13 | 2.5649 |

解根据Newton型二次插值公式(2.8)有
$$\begin{aligned}
p_{2}(\:x\:)\:=& f(\:11\:)\:+f(\:11\:,12\:)\:(\:x-11\:)\:+f(\:11\:,12\:,13\:)\:(\:x-11\:)\:(\:x-12\:) \\
&f(11)=2.3979 \\
&f(\:11\:,12\:)=\frac{f(\:11\:)\:-f(\:12\:)}{1\:1\:-12}=0.\:087 \\
&f(\:11\:,12\:,13\:)\:=\frac{f(\:11\:,12\:)\:-f(\:12\:,13\:)}{11\:-13}\:=\:-0.\:003\:5
\end{aligned}$$

而

从而得到

$$p_2(\:x\:)\:=2.\:397\:9\:+0.\:087(\:x\:-11\:)\:-0.\:003\:5(\:x\:-11\:)\:(\:x\:-12\:)$$

$$p_2(11.75)=2.46375$$

于是得到$\ln11.75\approx2.46375$ 又因为

$$f(\:x\:)\:-p_{2}(\:x\:)\:=\frac{f^{\prime\prime\prime}(\:\xi\:)}{3\:!}(\:x-x_{0}\:)\:(\:x-x_{1}\:)\:(\:x-x_{2}\:)$$

则

$$\mathrm{ln}x-p_2\left(\:x\:\right)=\frac{1}{3\xi^3}\left(\:x-11\:\right)\left(\:x-12\:\right)\left(\:x-13\:\right)$$

其中$\xi\in[11,13]$

对上式两边取绝对值得
$$\begin{aligned}
\mid\mathrm{ln}x-p_{2}(x)& =\frac{1}{3\xi^{3}}\mid(\:x-11\:)\:(\:x-12\:)\:(\:x-13\:)\mid  \\
&\leqslant\frac{1}{3}\max_{\xi\in[11,13]}\:\frac{1}{\xi^{3}}\mid(\:x-11\:)\:(\:x-12\:)\:(\:x-13\:)\:| \\
&=\frac{1}{3\times11^{3}}\mid(\:x-11\:)\:(\:x-12\:)\:(\:x-13\:)\mid \\
\mid\ln11.75-p_{2}(11.75)\mid & \leq{\frac{1}{3\times11^{3}}}\mid(\:11.\:75\:-11\:)\:(\:11.\:75\:-12\:)\:(\:11.\:75\:-13\:)\mid  \\
&\approx0.0000587
\end{aligned}$$

# 2.2 $n$ 次插值的Lagrange形式和Newton形式

2.1节介绍了线性插值和二次插值，从这两种插值可以推广到$n$ 次插值. $n$ 次

------------------------------------------------------------------

插值的提法是：给定$y= f($ $x)$ 的函数表（如表2-2所示），构造函数$p_n\left(\begin{array}{c}x\end{array}\right)$ 满足条件：

$\textcircled {\mathrm{I} }$ $p_{n}($ $x)$ 是一个不超过$n$ 次的代数多项式：

$$2\:p_{n}(\:x_{i}\:)\:=y_{i}(\:i=0\:,1\:,\cdots,n\:)\:.$$

其中$x_i$ 称为插值节点$; f($ $x)$ 称为被插值函数： $p_a\left(\begin{matrix}x\end{matrix}\right)$ 称为$n$ 次插值函数

$n$ 次插值的目的是构造$p_n\left(\begin{matrix}x\end{matrix}\right)$ 来近似代替$f($ $x$ ) .当求某一点$x^{*}$ 的函数值$f(x^{*}$ )时，可以用$p_n(x^{*}$ )来近似代替$f(x^{\prime})$

由于$p_x($ $x$ ) 是一个不超过$n$ 次的代数多项式，所以不妨假设

$$p_{s}\left(\begin{matrix}{x}\\\end{matrix}\right)=a_{0}+a_{1}x+a_{2}x^{2}+\cdots+a_{s}x^{^{\prime\prime}}$$

其中al $a_0$ $a_0$ $, a_1$ $, \cdots , a_n$ 为待定常数

为了确定a $a_0$ $a_0$ $, a_1$ $, \cdots , a_n$ ，可以利用插值条件$\textcircled{2}$ 得到$n+1$ 个等式，把它们联立起来组成方程组

$$\begin{aligned}&p_{s}\left(\:x_{0}\:\right)=a_{0}\:+a_{1}x_{0}\:+a_{2}x_{0}^{2}\:+\cdots\:+a_{s}x_{0}^{n}=y_{0}\\&p_{s}\left(\:x_{1}\:\right)=a_{0}\:+a_{1}x_{1}\:+a_{2}x_{1}^{2}\:+\cdots\:+a_{s}x_{1}^{n}=y_{1}\\&p_{s}\left(\:x_{s}\:\right)=a_{0}\:+a_{1}x_{n}\:+a_{2}x_{n}^{2}\:+\cdots\:+a_{n}x_{n}^{n}\:=y_{n}\end{aligned}$$

方程组（2.15）的系数行列式为

![](https://storage.simpletex.cn/view/ffzkl6ls5PYgwXi5tPLgoTkIYu9o4qiRP)

这是著名的Vandermonde（范德蒙）行列式，可以用归纳法证明它的值为

$$\left(\begin{array}{c}x_1-x_0\end{array}\right)\left(\begin{array}{c}x_2-x_0\end{array}\right)\cdots\left(\begin{array}{c}x_n-x_0\end{array}\right)\left(\begin{array}{c}x_2-x_1\end{array}\right)\left(\begin{array}{c}x_3-x_1\end{array}\right)\cdots\left(\begin{array}{c}x_n-x_1\end{array}\right)\cdots\left(\begin{array}{c}x_n-x_{n-1}\end{array}\right)$$

$$=\prod_{0\leq j<i\leq n}\left(x_{i}-x_{j}\right)$$

由于$x_0$ X0 X $x_1$ $x_0$ $, x_1$ $, \cdots , x_n$ 互不相等，所以Vaudermonde行列式的值不为0，从而方程组的解$a_0,a_1,\cdots,a_n$ 存在且惟一.因此， $.p_{a}\left(\begin{matrix}x\end{matrix}\right)$ 存在且惟一.

$n$ 次插值函数$p_{n}\left(\begin{matrix}x\end{matrix}\right)$ 有两种形式：Lagrange形式和Newton形式

# 2.2.1 $n$ 次插值函数的Lagrange形式

设

$$p_{s}\left(x\right)=l_{0}\left(x\right)y_{0}+l_{1}\left(x\right)y_{1}+\cdots+l_{s}\left(x\right)y_{n}$$

其中$l_0\left(x\right),l_1\left(x\right),\cdots,l_n\left(x\right)$ 为不超过$n$ 次的代数多项式，且满足表2-9.

------------------------------------------------------------------

表2-9 $l_0\left(x\right),l_1\left(x\right),\cdots,l_u\left(x\right)$ 在节点处的取值

| 函数值 | 节点 | $x_0$ | $x_1$ | ... | $x_n$ |
|--------|------|-------|-------|-----|-------|
| $l_i(x)$ | | 1 | 0 | ... | 0 |
| | | 0 | 1 | ... | 0 |
| ... | ... | ... | ... | ... | ... |
| $L_k(x)$ | | 0 | 0 | ... | 1 |

容易验证， $,p_n\left(\begin{matrix}x\end{matrix}\right)$ 满足插值条件0和$\textcircled{2}$ .因此，只要找到满足表2-9的$l_0(x)$ ， $l_1$ $\left(\begin{matrix}x\\\end{matrix}\right),\cdots,l_{n}\left(\begin{matrix}x\\\end{matrix}\right)$ ,那么就可构造出$p_n\left(\begin{matrix}x\end{matrix}\right)$ .下面根据表2-9构造$l_0\left(x\right),l_1\left(x\right),\cdots,l_n$ ( $x$ ) .

首先构造$l_0\left(\begin{matrix}x\end{matrix}\right)$ .根据表$2-9,l_{0}\left(x_{i}\right)=0\left(\begin{array}{c}{i=1},2,\cdots,n\end{array}\right)$ ，所以$l_0\left(\begin{matrix}x\end{matrix}\right)$ 必有因子( $x- x_{1}$ ) ( $x- x_{2}$ $) \cdots$ ( $x- x_{n}$ ) . 又因$l_0($ $x)$ 为不超过$n$ 次的代数多项式，而( $x- x_1$ )( $x$ $- x_2$ $) \cdots ($ $x- x_n$ ) 已是一个$n$ 次代数多项式，故$l_0\left(\begin{matrix}x\end{matrix}\right)$ 只能还有一个常数因子，从而得到

$$l_0\left(\:x\:\right)=A\left(\:x-x_1\:\right)\left(\:x-x_2\:\right)\cdots\left(\:x-x_n\:\right)$$

其中$A$ 为待定常数

为了确定$A$ ，利用$l_0($ $x_0$ ) = 1

$$l_0\left(\begin{array}{c}x_0\end{array}\right)=A\left(\begin{array}{c}x_0-x_1\end{array}\right)\left(\begin{array}{c}x_0-x_2\end{array}\right)\cdots\left(\begin{array}{c}x_0-x_s\end{array}\right)=1$$

得

$$A=\frac{1}{(\:x_0\:-x_1\:)\:(\:x_0\:-x_2\:)\cdots(\:x_0\:-x_s\:)}$$

$$l_0\left(\:x\:\right)=\frac{\left(\:x-x_1\:\right)\left(\:x-x_2\:\right)\cdots\left(\:x-x_n\:\right)}{\left(\:x_0\:-x_1\:\right)\left(\:x_0\:-x_2\:\right)\cdots\left(\:x_0\:-x_n\:\right)}$$

于是推得

用同样的方法可以求得

$$\begin{aligned}l_{1}\left(x\right)&=\frac{\left(\:x-x_{0}\:\right)\left(\:x-x_{2}\:\right)\cdots\left(\:x-x_{n}\:\right)}{\left(\:x_{1}\:-x_{0}\:\right)\left(\:x_{1}\:-x_{2}\:\right)\cdots\left(\:x_{1}\:-x_{n}\:\right)}\\&\vdots\end{aligned}$$

$$l_{n}\left(\:x\:\right)=\frac{\left(\:x-x_{0}\:\right)\left(\:x-x_{1}\:\right)\cdots\left(\:x-x_{n-1}\:\right)}{\left(\:x_{n}\:-x_{0}\:\right)\left(\:x_{n}\:-x_{1}\:\right)\cdots\left(\:x_{n}\:-x_{n-1}\:\right)}$$

分析一下函数$l_0(x)$ $l_0(x)$ $l_{0}\left(x\right),l_{1}\left(x\right),\cdots,l_{x}\left(x\right)$ ，就会发现它们的变化是有规律的，可以把它们写成统一形式

$$l_i\left(\:x\:\right)=\frac{\left(\:x-x_0\:\right)\cdots\left(\:x-x_{i-1}\:\right)\left(\:x-x_{i+1}\:\right)\cdots\left(\:x-x_n\:\right)}{\left(\:x_i-x_0\:\right)\cdots\left(\:x_i-x_{i-1}\:\right)\left(\:x_i-x_{i+1}\:\right)\cdots\left(\:x_i-x_n\:\right)}\quad(\:i=0\:,1\:,\cdots,n\:)$$

$l_{0}\left(x\right),l_{1}\left(x\right),\cdots,l_{n}\left(x\right)$ 称为插值基函数.由于它们是不超过$n$ 次的代数多项

------------------------------------------------------------------

式，所以它们又称为$n$ 次插值基函数.有了这$n+1$ 个$n$ 次插值基函数后，就得到了满足插值条件的Lagrange型$n$ 次插值函数

$$\begin{aligned}p_{s}\left(x\right)&=\:\sum_{i=0}^{n}\:l_{i}\left(\:x\:\right)y_{i}\\&=\:\sum_{i=0}^{n}\:\frac{\left(\:x-x_{0}\:\right)\cdots\left(\:x-x_{i-1}\:\right)\left(\:x-x_{i+1}\:\right)\cdots\left(\:x-x_{n}\:\right)}{\left(\:x_{i}-x_{0}\:\right)\cdots\left(\:x_{i}-x_{i-1}\:\right)\left(\:x_{i}-x_{i+1}\:\right)\cdots\left(\:x_{i}-x_{n}\:\right)}y_{i}\end{aligned}$$

（2.16）式称为Lagrange型$n$ 次插值公式.特别地，当$n=1$ 时，（2.16）式就是Lagrange型线性插值公式；当$n=2$ 时，（2.16）式就是Lagrange型二次插值公式

(2.16）式还可以写成另一种形式

$$p_{n}\left(\:x\:\right)\:=\:\sum_{i=0}^{n}\:\frac{\omega\left(\:x\:\right)}{\left(\:x-x_{i}\:\right)\boldsymbol{\omega}^{\prime}\left(\:x_{i}\:\right)}y_{i}$$

$$\omega(\:x\:)=(\:x-x_{0}\:)\:(\:x-x_{1}\:)\cdots(\:x-x_{n}\:)$$

其中

$$\omega'\left(x_i\right)=\left(\begin{matrix}x_i-x_0\end{matrix}\right)\cdots\left(\begin{matrix}x_i-x_{i-1}\end{matrix}\right)\left(\begin{matrix}x_i-x_{i+1}\end{matrix}\right)\cdots\left(\begin{matrix}x_i-x_n\end{matrix}\right)$$

对（2.17）式，可以验证它的正确性.Lagrange型$n$ 次插值函数的这种形式在数值分析的理论推导方面经常用到

Lagrange型$n$ 次插值算法

$\textcircled{1}$ 读人插值节点$x_{i}$ 著$x_{i},y_{i}\left(i=0,1,\cdots n\right)$ 和点

$\textcircled{2}y=0$ $\textcircled{3}$ 对$i=0,1,\cdots,n$ 做如下工作$t=1$ 对$k=0,1,\cdots,i-1,i+1,\cdots,n$ 做
$$t=t*\frac{xx-x_{k}}{x_{i}-x_{k}}$$
$yy=yy+t*y_{i}$ $\textcircled{4}$ 输出点$xx$ 相应的函数近似值yy

# 2.2.2 $n$ 次插值函数的Newton形式

2.1节引人了一阶差商和二阶差商的定义，在此引人三阶差商的定义，

定义2.3若记$f($ $x_{i}$ $, x_{j}$ $, x_{i}$ $, x_{i}$ ) $= \frac {f( \:x_{i}\:, x_{j}\:, x_{i}\:) \:- f( \:x_{j}\:, x_{k}\:, x_{i}\:) }{x_{i}\:- x_{l}}$ 则$f($ $x_{i}$ $, x_{j}$ $, x_{i}$ $, x_{i}$ ) 称为函数$f(x)$ 在节点$x_i,x_j,x_k$ 和$x_i$ 处的三阶差商.其中$x_i,x_j,x_k$ 和$x_{I}$ 互异

定义2.4一般地， $n$ 阶差商的定义为

$$f(\:x_{i_0},x_{i_1},\cdots,x_{i_n})\:=\frac{f(\:x_{i_0},x_{i_1},\cdots,x_{i_{k-1}})\:-f(\:x_{i_1},x_{i_2},\cdots,x_{i_k})}{x_{i_0}-x_{i_k}}$$

------------------------------------------------------------------

特别地，当$i_0= 0$ $, i_1= 1$ $, \cdots , i_n= n$ 时，有

$$f(\:x_0\:,x_1\:,\cdots,x_n\:)=\frac{f(\:x_0\:,x_1\:,\cdots,x_{n-1}\:)\:-f(\:x_1\:,x_2\:,\cdots,x_n\:)}{x_0\:-x_n}$$

从差商的定义出发，用归纳法可以证明
$$f(\:x_0\:,x_1\:,\cdots,x_k\:)\:=\:\sum_{i=0}^{i}\:\frac{f(\:x_i\:)}{\omega_k^{\prime}(\:x_i\:)}$$

$$\omega_{k}^{\prime}\left(\:x_{i}\:\right)=\left(\:x_{i}-x_{0}\:\right)\cdots\left(\:x_{i}-x_{i-1}\:\right)\left(\:x_{i}-x_{i+1}\:\right)\cdots\left(\:x_{i}-x_{k}\:\right)\:,k=1\:,2\:,\cdots,n.$$

由(2.18)式可知，无论$x_0,x_1,\cdots,x_n$ 如何排列，它们的值都是一样的.也就是说， $n$ 阶差商具有对称性，

由一阶差商定义，有

$$f(\:x\:,x_0\:)=\frac{f(\:x\:)\:-f(\:x_0\:)}{x\:-x_0}$$

从而得到

$$f(x)=f(x_0)+f(x,x_0)(x-x_0)$$

由二阶差商定义，有

$$f(\:x\:,x_0\:,x_1\:)=\frac{f(\:x\:,x_0\:)\:-f(\:x_0\:,x_1\:)}{x\:-x_1}$$

可以得到

$$f(\:x\:,x_0\:)\:=f(\:x_0\:,x_1\:)\:+f(\:x\:,x_0\:,x_1\:)\:(\:x\:-x_1\:)$$

同样可以得到
$$\begin{aligned}&f(\:x\:,x_{0}\:,x_{1}\:)\:=f(\:x_{0}\:,x_{1}\:,x_{2}\:)\:+f(\:x\:,x_{0}\:,x_{1}\:,x_{2}\:)\:(\:x\:-x_{2}\:)\\&f(\:x\:,x_{0}\:,x_{1}\:,\cdots,x_{n-2}\:)\:=f(\:x_{0}\:,x_{1}\:,x_{2}\:,\cdots,x_{n-1}\:)\:+f(\:x\:,x_{0}\:,x_{1}\:,\cdots,x_{n-1}\:)\:(\:x\:-x_{n-1}\:)\\&f(\:x\:,x_{0}\:,x_{1}\:,\cdots\:,x_{n-1}\:)\:=f(\:x_{0}\:,x_{1}\:,x_{2}\:,\cdots\:,x_{n}\:)\:+f(\:x\:,x_{0}\:,x_{1}\:,\cdots,x_{n}\:)\:(\:x\:-x_{n}\:)\end{aligned}$$

把以上各式由下而上逐步回代可得
$$\begin{aligned}
&f(\:x_0\:,x_1\:,\cdots,x_n\:)\:(\:x-x_0\:)\:(\:x-x_1\:)\cdots(\:x-x_{n-1}\:)\:+ \\
&f(\:x_0\:,x_1\:,\cdots,x_n\:,x\:)\:(\:x-x_0\:)\:(\:x-x_1\:)\cdots(\:x-x_n\:) \\
&=N_{x}\left(\:x\:\right)+R_{n}\left(\:x\:\right)& \text{(} \\
&R_{n}(x)=& f(\:x_{0}\:,x_{1}\:,\cdots,x_{n}\:,x\:)\:(\:x-x_{0}\:)\:(\:x-x_{1}\:)\cdots(\:x-x_{n}\:) 
\end{aligned}$$

其中

$$N_{x}\left(x\right)=f\left(x_{0}\right)+f\left(x_{0},x_{1}\right)\left(x-x_{0}\right)+f\left(x_{0},x_{1},x_{2}\right)\left(x-x_{0}\right)\left(x-x_{1}\right)+\cdots+$$

$$f(x_0,x_1,\cdots,x_n)(x-x_0)(x-x_1)\cdots(x-x_{n-1})$$

因为$N_x\left(\begin{matrix}x\end{matrix}\right)$ 是一个不超过$n$ 次的代数多项式，并且可以证明

$$N_{n}(\:x_{i}\:)=f(\:x_{i}\:)\quad(\:i=0\:,1\:,\cdots,n\:)$$

故$N_n(x)$ 满足插值条件$:\textcircled{1}$ 和$1\textcircled{2}$ ，也是一个$n$ 次插值函数.这个$n$ 次插值函数称为Newton型$n$ 次插值函数：（2.20）式称为Newton型$n$ 次插值公式，

从（2.20）式可以看到，当$n=1$ 时，（2.20）式就是Newton型线性插值公式；当

------------------------------------------------------------------

$n=2$ 时，(2.20)式就是Newton型二次插值公式.

在实际问题中，为了得到Newton型$n$ 次插值函数，通常需要构造一个差商表（如表2-10所示），然后按照差商表写出Newton型$n$ 次插值函数

表2-10差商表

| x₁₀ | y₀ | $f(x₀,x₁)$ | $f(x₀,x₁,x₂)$ | ... | $f(x₀,x₁,...,xₙ)$ |
|-----|----|------------|---------------|-----|-------------------|
| x₁ | y₁ | $f(x₁,x₂)$ | $f(x₀,x₁,x₂)$ | ... |         |
| x₂ | y₂ | $f(x₂,x₃)$ | $f(x₁,x₂,x₃)$ | ... |         |
| ... | ... | ...    | ...      | ... |         |
| xₙ₋₁| yₙ₋₁| $f(xₙ₋₁,xₙ)$ | $f(xₙ₋₂,xₙ₋₁,xₙ)$ | ... |         |
| xₙ | yₙ | $f(xₙ,1)$ | $f(xₙ₋₁,xₙ₂,xₙ)$ | ... | $f(x₀,x₁,...,xₙ)$ |

例2-3已知函数表如表2-11所示.求Newton型$n$ 次插值函数$N_x\left(\begin{matrix}x\end{matrix}\right)$ 并计算f（0.6）的近似值

表2-11函数表

| x   | y = f(x) |
|-----|---------|
| 0.4 | 0.41075 |
| 0.55| 0.57815 |
| 0.65| 0.69675 |
| 0.8 | 0.88811 |
| 0.9 | 1.02652 |

解先作差商表如表2-12所示：

表2-12例2-3差商表

$x_{i}$ $y_{i}=f(x_{i})$ $f(x_{i},x_{i})$ $f(x_{i},x_{j},x_{k})$ $f(x_{i},x_{j},x_{k},x_{l})$ $f(x_{0},x_{1},\cdots,x_{d})$
0.4 0.41075
0.55 0.57815 1.116
0.65 0.69675 1.186 0.28
0.8 0.88811 1.27573 0.35892 0.1973
0.9 1.02652 1.3841 0.43348 0.21303 0.03146

根据（2.16）式和差商表可以得到
$$\begin{aligned}
N_{4}\left(\:x\:\right)& =f(\:x_{0}\:)\:+f(\:x_{0}\:,x_{1}\:)\:(\:x-x_{0}\:)\:+  \\
&f(\:x_{0}\:,x_{1}\:,x_{2}\:)\:(\:x-x_{0}\:)\:(\:x-x_{1}\:)\:+ \\
&f(\:x_0\:,x_1\:,x_2\:,x_3\:)\:(\:x-x_0\:)\:(\:x-x_1\:)\:(\:x-x_2\:)\:+ \\
&f(\:x_{0}\:,x_{1}\:,x_{2}\:,x_{3}\:,x_{4}\:)\:(\:x-x_{0}\:)\:(\:x-x_{1}\:)\:(\:x-x_{2}\:)\:(\:x-x_{3}\:) \\
&=0.41075+1.116(\:x-0.4\:)\:+0.28\:(\:x-0.4\:)\:(\:x-0.55\:)\:+ \\
&0.1973\left(x-0.4\right)\left(x-0.55\right)\left(x-0.65\right)+
\end{aligned}$$

------------------------------------------------------------------

$$0.03146(x-0.4)(x-0.55)(x-0.65)(x-0.8)$$

$$f(0.6)\approx N_4(0.6)=0.63665$$

于是

下面推导Newton型$n$ 次插值在计算机上实现的计算格式，并给出在计算机上实现的算法，

设

$$\begin{aligned}
&\omega_{k}=\left(\:x-x_{0}\:\right)\left(\:x-x_{1}\:\right)\cdots\left(\:x-x_{k-1}\:\right)\quad(\:k=1\:,2\:,\cdots,n\:) \\
&\mathbf{\omega}_{0}=1 \\
&N_{0}\left(\:x\:\right)\:=y_{0}=f(\:x_{0}\:) \\
&V_{0,k}=y_{k}=f(\:x_{k}\:)\quad(\:k=0\:,1\:,\cdots,n\:) \\
&V_{i+1,k}=\frac{V_{i,i}-V_{i,k}}{x_{i}-x_{k}}\quad(\:k=1\:,2\:,\cdots,n\:;i=0\:,1\:,\cdots,k-1\:)
\end{aligned}$$

则有

$$\omega_{k}=\left(\begin{array}{c}x-x_{k-1}\end{array}\right)\omega_{k-1}\quad(\begin{array}{c}k=1,2,\cdots,n\end{array})$$

$$V_{k,k}=f(\:x_{0}\:,x_{1}\:,\cdots,x_{k}\:)\quad(\:k=1\:,2\:,\cdots,n\:)$$

由（2.21）式和（2.22）式可以得到

$$N_{k}(\:x\:)\:=N_{k-1}(\:x\:)\:+\omega_{k}V_{k,k}\quad(\:k=1\:,2\:,\cdots,n\:)$$

综合上述各式得到Newton型$n$ 次插值的计算格式为

$$\begin{aligned}
&\mathbf{\omega}_{0}=1 \\
&N_{0}\left(\:x\:\right)\:=y_{0}\:=f(\:x_{0}\:) \\
&V_{i+1,k}=\frac{V_{i,i}-V_{i,k}}{x_{i}-x_{k}}\quad(\:k=1\:,2\:,\cdots,n\:;i=0\:,1\:,\cdots,k-1\:) \\
&\omega_{k}=\left(\:x-x_{k-1}\:\right)\omega_{k-1}\quad(\:k=1\:,2\:,\cdots,n\:) \\
&N_{k}\left(\:x\:\right)=N_{k-1}\left(\:x\:\right)\:+\omega_{k}V_{k,k}\quad(\:k=1\:,2\:,\cdots,n\:)
\end{aligned}$$

Newton 型$n$ 次插值算法

$\textcircled{1}$ 读人插值节点$x_{i}$ X $x_{i},y_{i}\left(i=0,1,\cdots,n\right)$ 和点$xx$

$$2\:\omega=1\:,V_{0}=y_{0}\:,yy=y_{0}\:.$$
$\textcircled{3}$ 对$k=1,2,\cdots,n$ 做如下工作：
$$V_{k}=y_{k}$$
对$i=0,1,\cdots,k-1$ 做
$$V_{k}=\frac{V_{i}-V_{k}}{x_{i}-x_{k}}$$

$$\omega=\omega*(\:xx-x_{k-1}\:)$$

$$yy=yy+\omega*V_{k}$$
$\textcircled{4}$ 输出插值点$xx$ 相应的函数近似值vv

其中$\omega,yy$ 和$V_k$ 分别用来存放$\omega_{k}$ $. N_k($ $x)$ 和$V_{i+1,k}$ 的值

类似于定理2.2.可以证明如下定理

------------------------------------------------------------------

定理2.3设$p_x\left(\begin{matrix}x\end{matrix}\right)$ 是过( $x_i$ $, y_i$ ) ( $i= 0$ ,1 $, \cdots$ $, n$ ) 的$n$ 次插值函数， $\left[\begin{smallmatrix}a,b\end{smallmatrix}\right]$ 是包含$x_0,x_1,\cdots,x_n$ 的任一区间，并设$f($ $x$ $) \in C^{n}\left [ \:a\:, b\:\right ]$ $, f^{( \:x+ 1\:) }$ ( $x$ ) 在$\left[\begin{smallmatrix}a&b\end{smallmatrix}\right]$ 上存在，则对任意给定的$x\in [$ $a, b$ ] ，总存在一点$\xi \in ($ $a$ $, b$ ) ，使得
$$R(\:x\:)\:=f(\:x\:)\:-p_{n}(\:x\:)\:=\frac{p^{(\:x\:+\:1\:)}\:(\:\xi\:)}{(\:n\:+\:1\:)\:!}(\:x\:-x_{0}\:)\:(\:x\:-x_{1}\:)\cdots(\:x\:-x_{n}\:)$$

其中$\xi$ 依赖于$x$

# 2.3分段线性插值

$n$ 次插值是根据给定的$y= f($ $x)$ 函数表构造代数多项式p (x) $p_x\left(\begin{matrix}x\end{matrix}\right)$ $p_x\left(\begin{matrix}x\\\end{matrix}\right),p_x\left(\begin{matrix}x\\\end{matrix}\right)$ p(x) $p_x\left(\begin{matrix}x\end{matrix}\right)$ 为$n$ 次插值函数，用$p_{n}\left(\begin{matrix}x\end{matrix}\right)$ 近似代替$f(x)$ .为了表明$p_x\left(\begin{matrix}x\end{matrix}\right)$ 是一个代数多项式，有时亦称$p_x\left(\begin{matrix}x\end{matrix}\right)$ 为$n$ 次插值多项式.按这种说法，根据给定两个节点的函数表构造出来的插值多项式是一次的，根据给定三个节点的函数表构造出来的插值多项式是两次的， ，根据给定$n+1$ 个节点的函数表构造出来的插值多项式是$n$ 次的

由此可见，对于$n$ 次插值，随着插值节点的增加，插值多项式的次数也会增加， 也许有些读者认为，插值多项式的次数越高，插值多项式$p_x\left(\begin{matrix}x\end{matrix}\right)$ 与$f(x)$ 的误差就会越少.这种想法是片面的，

例2-4给定函数

$$f(\:x\:)\:=\frac{1}{1\:+25x^{^2}}\quad(\:-1\leqslant x\leqslant1\:)$$

取等距插值节点$x_{i}= - 1$ $+ \frac 15i($ $i= 0$ ,1 $, \cdots , 10$ ) ，试建立插值多项式$p_{10}\left(\:x\:\right)$ ，并考察$p_{10}(x)$ 与$f(x)$ 的误差情况.

解由Lagrange型$n$ 次插值公式得到
$$p_{10}\left(x\right)=\sum_{i=0}^{10}f(x_{i})l_{i}(x)$$

其中

$$\begin{aligned}&x_{i}\:=\:-\:1\:+\:\frac{1}{5}i\quad(\:i=0\:,1\:,\cdots,n\:)\\&f(\:x_{i}\:)\:=\frac{1}{1\:+25x_{i}^{2}}\quad(\:i=0\:,1\:,\cdots,n\:)\end{aligned}$$

$$l_i\left(\:x\:\right)\:=\frac{\left(\:x-x_0\:\right)\cdots\left(\:x-x_{i-1}\:\right)\left(\:x-x_{i+1}\:\right)\cdots\left(\:x-x_{10}\:\right)}{\left(\:x_i-x_0\:\right)\cdots\left(\:x_i-x_{i-1}\:\right)\left(\:x_i-x_{i+1}\:\right)\cdots\left(\:x_i-x_{10}\:\right)}\quad(\:i=0\:,1\:,\cdots,n\:)$$

画出函数f（x）=25和$y=p_{10}\left(\begin{array}{c}{x}\end{array}\right)$ 的图形，如图2－3所示.从图上可以看

到，在原点附近$p_{10}(x)$ 能较好地逼近$f(x)$ ，但在其他地方$p_{10}\left(\begin{array}{c}x\end{array}\right)$ 与$f($ $x$ ) 的误差较

------------------------------------------------------------------

大，越靠近两个端点-1和1误差就越大，还出现激烈振荡现象.采用高次插值发生的这种现象称为Runge（龙格）现象.

![](https://storage.simpletex.cn/view/fu4GYTVdw8gggbX2M83nC9bztNwOHr0RH)

还可以证明,用$p_n\left(\begin{matrix}x\end{matrix}\right)$ 通近$f($ $x$ ) = $\frac 1{1+ 25x^2}$ 当$n\to\infty$ 时$,p_a(x)$ 只能在$|x|<0.72$ .内收敛，而在这个区间外是发散的，

图2-3函数$f(x)=\frac1{1+25x^2}$

从例2-4可以得出如下结论：高次插值多项式并不一定能很好地近似代替被插值函数.因此，在实际进行插值的时候，如果给定的插值节点很多，通常把插值区间分为若干段，然后在每

和$y=p_{10}(x)$ 的图形

个分段上使用低次插值多项式来近似代替f（x），即在每个分段上采用低次插值.这种做法称为分段插值

如果在每个分段上使用不超过一次的代数多项式来近似代替被插值函数$y= f($ $x)$ ，则这种插值称为分段线性插值.

分段线性插值的提法是：根据给定函数$y= f($ $x)$ 的函数表（如表2-2所示）， 构造函数$p(x)$ 满足条件：

$\textcircled{\mathrm{D}}p(x)$ 在$\left[\begin{array}{c}x_{i},x_{i+1}\end{array}\right](\begin{array}{c}i=0\end{array},1,\cdots,n-1)$ 上为不超过一次的代数多项式；

$\textcircled {2}p( x_{\mathrm{i} }) = y_{\mathrm{i} }($ $i= 0$ ,1 $, \cdots , n)$

其中$p(x)$ 称为分段线性插值函数

分段线性插值的目的是分段构造$p(x)$ 来近似代替$f($ $x$ ) .当要求某一点$x^{*}$ 的函数值$f(x^{*}$, 时，可以用$p(x^{*})$ 近似代替$f(x^{*})$

根据分段线性插值的条件，可以把$p(x)$ 直接构造出来：

$$\begin{aligned}&\frac{x-x_{1}}{x_{0}-x_{1}}y_{0}\:+\:\frac{x-x_{0}}{x_{1}-x_{0}}y_{1}\quad(\:x_{0}\leq x\leq x_{1}\:)\\&p\left(\:x\:\right)\:=\:\left|\:\frac{x-x_{2}}{x_{1}-x_{2}}y_{1}\:+\:\frac{x-x_{1}}{x_{2}-x_{1}}y_{2}\quad(\:x_{1}<x\leq x_{2}\:)\right|\\&\frac{x-x_{n}}{x_{n-1}-x_{n}}y_{n-1}\:+\:\frac{x-x_{n-1}}{x_{n}-x_{n-1}}y_{n}\quad(\:x_{n-1}<x\leq x_{n}\:)\end{aligned}$$

分段线性插值函数也可以由插值基函数组合而成.设$l_{0}\left(x\right),l_{1}\left(x\right),\cdots,l_{n}\left(x\right)$ 为不超过$n$ 次的代数多项式，且满足表2-13.容易验证下面函数满足表2-13.

------------------------------------------------------------------

表2-13 $l_0\left(x\right),l_1\left(x\right),\cdots,l_n\left(x\right)$ 在节点处的取值

函数值 节点 $x_0$ $x_1$ ... $x_n$
函数
$l_0(x)$ 1 0 ... 0
$l_1(x)$ 0 1 ... 0
...
...
l_n(x) 0 0 ... 1

$$l_0\left(\:x\:\right)\:=\:\begin{array}{cc}\displaystyle\frac{x-x_1}{x_0-x_1}&(\:x_0\leq x\leq x_1\:)\\\\0&(\:x_1<x\leq x_n\:)\end{array}$$

$$\begin{aligned}
&l_{1}\left(x\right) \left.=\left\{\begin{array}{cc}\frac{x-x_{i-1}}{x_{i}-x_{i-1}}&(\:x_{i-1}\leq x\leq x_{i}\:)\\\\\frac{x-x_{i+1}}{x_{i}-x_{i+1}}&(\:x_{i}<x\leq x_{i+1}\:)\\\\0&[\:a,b\:]-[\:x_{i-1}\end{array}\right.\right. \\
&: \\
&l_{n}\left(x\right) \left.=\left[\begin{array}{cc}{{\frac{x-x_{n-1}}{x_{n}-x_{n-1}}}}&{{(\:x_{n-1}\leq x\leq x_{n}\:)}}\\{{0}}&{{(\:x_{0}\leq x<x_{n-1}\:)}}\\\end{array}\right.\right] 
\end{aligned}$$
$l_{0}\left(x\right),l_{1}\left(x\right),\cdots,l_{n}\left(x\right)$ 通常称为分段线性插值基函数，由这些分段线性插值基函数

可以得到分段线性插值函数的另一种形式

$$p(\:x\:)\:=\:\hat{\sum_{i=0}}\:y_{i}l_{i}(\:x\:)$$

分段线性插值的几何意义是用一条折线$y= p($ $x$ ) 来近似代替曲线$y= f($ $x)$

例2-5给定函数$y= f($ $x)$ 的函数表如表2-14所示，试用分段线性插值法求$y= f($ $x)$ 在$x=-0.9$ 处的近似值

表2-14函数表

| x  | y=f(x) |
|----|-------|
|-1  | 0.03846|
|-0.8 | 0.05882|
|-0.6 | 0.1   |
|-0.4 | 0.2   |
| 0  | 0.5   |

------------------------------------------------------------------

解
$$\begin{aligned}&\frac{x+0.8}{-0.2}\times0.\:038\:46\:+\frac{x+1}{0.2}\times0.\:058\:82\quad(\quad-1\leq x\leq-0.\:8\:)\\&\frac{x+0.6}{-0.2}\times0.\:058\:82\:+\frac{x+0.8}{0.2}\times0.\:1\quad(\:-0.\:8<x\leq-0.\:6\:)\\&p\left(x\right)=&\frac{x+0.4}{-0.2}\times0.1+\frac{x+0.6}{0.2}\times0.2&(-0.6<x\leq-0.4)\\&\frac{x}{-0.4}\times0.2+\frac{x+0.4}{0.4}\times0.5&(-0.4<x\leq0)\end{aligned}$$

$$f(\begin{array}{c}-0.9\end{array})\approx p(\begin{array}{c}-0.9\end{array})=0.048\:64$$

分段线性插值算法

![](https://storage.simpletex.cn/view/fD4ImU0VneduLcdsqdfM9vKUFT2WAGwZ9)

定理2.4设给定如表2-2所示的$y$ $= f($ $x$ ) 的函数表，令$a$ = $x_0$ , $b$ = $x\:_n$ $f($ $x$ $) \in C^{1}\left [ \:a\:, b\:\right ]$ $, f^{\prime \prime }($ $x$ ) 在:[ $a$ $, b$ ] 上存在， $p(x)$ 是$f(x)$ 的分段线性插值函数，则有
$$\mid R(x)\mid=\mid f(x)-p(x)\mid\leqslant\frac{h^{2}}{8}M$$

其中$h=\max_{0\text{成(筑}k-1}\mid x_{i+1}-x_{i}\mid;M=\max_{\alpha\in X\text{则}b}\mid f^{\prime\prime}(x)\mid.$ M= max ”(x) | $M=\max_{\alpha\text{ б д }\alpha\in\delta}|f^{\prime\prime}(x)|$

证因为$p(x)$ 在每个小区间$\left[\begin{array}{c}x_i,x_{i+1}\end{array}\right](\begin{array}{c}i=0\end{array},1,\cdots,n-1)$ 上都是线性函数，所以由(2.7)式可知，在$\left[\begin{array}{c}x_i\end{array},x_{i+1}\right.$ ]上有

$$\mid R(\:x\:)\:\mid\leqslant\frac{\left(\:x_{i+1}\:-x_{i}\:\right)^{2}}{8}\max_{x_{i}\leq x\leq x_{i+1}}\:\mid f^{\prime\prime}(\:x\:)\:\mid $$

$$\leq\frac{\max_{0\leq i\leq n-1}\mid x_{i+1}-x_{i}\mid^{2}}{8}\max_{a\leq x\leq b}\mid f^{\prime\prime}(\:x\:)\mid $$

若记$h=\max_{0\leq i\leq x-1}\mid x_{i+1}-x_{i}\mid$ : $M= \max _{\alpha \in x\in b}| f^{\prime \prime }($ $x)$ ，则有

$$\mid R(\:x\:)\:\mid=\mid f(\:x\:)\:-p(\:x\:)\:\mid\leqslant\frac{h^{2}}{8}M$$

------------------------------------------------------------------

# 2.4Hermite插值

在某些实际问题中，为了保证插值函数更好地逼近被插值函数$f($ $x$ ) ，不仅要求插值函数在插值节点上的值与被插值函数$f($ $x$ ) 在插值节点上的值相等，而且还要求插值函数在插值节点上的导数值与被插值函数$f(x)$ 在插值节点上的导数值相等，解决这样的问题需要用到Hermite插值.

# 2.4.1三次Hermite 插值

三次Hermite插值的提法是：

表2-15三次Hermmite插值函数表

根据给定的$y$ $= f($ $x$ ) 的函数表（如表2-15所示），构造函数$H($ $x$ ) 满足条件：

$x$ $x_0$ $x_1$
$y=f(x)$ $y_0$ $y_1$
$y'=f'(x)$ $m_0$ $m_1$

$\textcircled{1}H(x)$ 为不超过三次的代数多项式；

$\textcircled {2}H($ $x_0$ ) $= y_0$ $H($ $x_{1}$ ) = $y_{1}$ ： $H^{\prime}\left(\begin{smallmatrix}x_{0}\end{smallmatrix}\right)=m_{0}$ 和$H^{\prime }($ $x_{1}$ ) $= m_{1}$ . 其中$H($ $x)$ 称为三次Hermite插值函数.

三次Hermite插值的目的是构造$H($ $x$ ) 来近似代替$f($ $x$ ) .当求某一点$x^{*}$ 的函数值$f(x^{*}$ )时，可以用$H(x^{*})$ 近似代替$f(x^{\circ})$ .

设
$$H(x)=y_0h_0(x)+y_1h_1(x)+m_0H_0(x)+m_1H_1(x)$$

其中ho(x) $h_0\left(\begin{matrix}x\end{matrix}\right)$ h(x) $h_1(x)$ $h_{0}\left(x\right),h_{1}\left(x\right),H_{0}\left(x\right)$ Ha（x） $H_0\left(\begin{matrix}x\end{matrix}\right)$ 和$H_1(x)$ 为不超过三次的代数多项式，且满足表2-16.

表2-16 $h_0\left(x\right),h_1\left(x\right),H_0\left(x\right)$ H(x) $H_0($ $x)$ 和$H_{1}(x)$ 在节点处的取值

| | 函数值 | | 导数值 |
|---|---|---|---|
| $h_0(x)$ | 1 | 0 | 0 | 0 |
| $h_1(x)$ | 0 | 1 | 0 | 0 |
| $H_0(x)$ | 0 | 0 | 1 | 0 |
| $H_1(x)$ | 0 | 0 | 0 | 1 |

容易验证， $H($ $x$ ) 就是满足插值条件$\textcircled{1}$ 和$\textcircled{2}$ 的 Hermite 插值函数.下面要把ho(x) $h_0(x)$ h(x) $h_1(x)$ $h_0\left(x\right),h_1\left(x\right),H_0\left(x\right)$ H(x) $H_0(x)$ 和$H_1($ $x)$ 构造出来.

先构造$h_0(x)$ .从表2-16可以看出，当$x=x_1$ 时，函数$h_0(x)$ 的值为0,同时函数$h_0\left(\begin{matrix}x\end{matrix}\right)$ 的导数也为0，所以它必有因子$\left(\begin{matrix}x-x_{1}\end{matrix}\right)^{2}$ 另外， $h_0\left(\begin{matrix}x\end{matrix}\right)$ 是一个不超过三次的代数多项式，从而$h_0($ $x$ ) 可以表示为

------------------------------------------------------------------

$$h_0\left(\:x\:\right)\:=\left[\:a+b\left(\:x-x_0\:\right)\:\right]\left[\:\frac{x-x_1}{x_0-x_1}\right]^2$$

其中$a$ 和$b$ 为待定常数

由$h_0\left(\:x_0\right)=1$ 得$a=1$

为了确定$b$ ，对$h_0\left(\begin{matrix}x\end{matrix}\right)$ 求微商，得
$$h'_0\left(x\right)=b\left[\begin{array}{c}x-x_1\\x_0-x_1\end{array}\right]^2+\left[\begin{array}{c}1+b\left(x-x_0\right)\end{array}\right]\times2\times\left[\begin{array}{c}x-x_1\\x_0-x_1\end{array}\right]\times\frac{1}{x_0-x_1}$$

再由$h_0^{\prime }($ $x_0$ ) =0得到$b=\frac2{x_1-x_0}$

于是

$$h_0\left(x\right)=\left[\begin{array}{c}1+2\:\frac{x-x_0}{x_1\:-x_0}\end{array}\right]\left[\begin{array}{c}x-x_1\\x_0\:-x_1\end{array}\right]^2$$

用同样方法可以求得

$$h_1\left(\begin{array}{c}x\end{array}\right)=\left[\begin{array}{c}1+2\:\frac{x-x_1}{x_0-x_1}\end{array}\right]\left[\begin{array}{c}x-x_0\\x_1-x_0\end{array}\right]^2$$

再构造$H_0\left(\begin{matrix}x\end{matrix}\right)$ .从表2-16可以看到， $H_0($ $x$ ) 在$x_0$ 处的函数值为0，在$x_1$ 上不仅函数值为0，而且微商也为0,所以它必有因子(xXo ( $x- x_0$ $\left(\:x-x_{0}\:\right)\left(\:x-x_{1}\:\right)^{2}.$ .又因它是一个不超过三次的代数多项式，而x-xo $x-x_0$ $\left(\begin{array}{c}{x-x_{0}}\end{array}\right)\left(\begin{array}{c}{x-x_{1}}\end{array}\right)^{2}$ 已是一个三次代数多项式，从而$H_0$ ( $x$ ) 可以表示为
$$H_{\circ}\left(\:x\:\right)=c\left(\:x-x_{0}\:\right)\left[\:\frac{x-x_{1}}{x_{0}\:-x_{1}}\right]^{2}$$

其中$c$ 为待定常数

为了确定$c$ ，对$H_0(x)$ 求微商得

$$H_0'\left(\:x\:\right)=c\bigg[\:\left[\:\frac{x-x_1}{x_0-x_1}\right]^2+2\left(\:x-x_0\:\right)\frac{x-x_1}{\left(\:x_0-x_1\:\right)^2}\bigg]$$

由$H_{0}^{\prime}\left(\:x_{0}\:\right)=1$ ，得到$c=1$ .于是

$$H_{\circ}\left(\:x\:\right)=\left(\:x-x_{0}\:\right)\left[\:\frac{x-x_{1}}{x_{0}-x_{1}}\right]^{2}$$

用同样的方法可求得

$$H_1\left(\:x\:\right)=\left(\:x-x_1\:\right)\left[\:\frac{x-x_0}{x_1-x_0}\right]^2$$

因此
$$\begin{aligned}
H(x)& =y_{0}h_{0}\left(\:x\:\right)\:+y_{1}h_{1}\left(\:x\:\right)\:+m_{0}H_{0}\left(\:x\:\right)\:+m_{1}H_{1}\left(\:x\:\right)  \\
&\left.=\left[\begin{array}{c}{1+2\:\frac{x-x_{0}}{x_{1}-x_{0}}}\end{array}\right.\right]\left[\begin{array}{c}{x-x_{1}}\\{x_{0}-x_{1}}\end{array}\right]^{2}y_{0}+\left[\begin{array}{c}{1+2\:\frac{x-x_{1}}{x_{0}-x_{1}}}\end{array}\right]\left[\begin{array}{c}{x-x_{0}}\\{x_{1}-x_{0}}\end{array}\right]^{2}y_{1}+
\end{aligned}$$

------------------------------------------------------------------

$$\left.\left(\begin{array}{c}x-x_0\end{array}\right.\right)\left[\begin{array}{c}x-x_1\\x_0-x_1\end{array}\right]^2m_0+\left(\begin{array}{c}x-x_1\end{array}\right)\left[\begin{array}{c}x-x_0\\x_1-x_0\end{array}\right]^2m_1$$

（2.30）式也称为三次Hermite插值公式

表2-17函数表

例2-6给定函数$y= f($ $x)$ 的函数表如表2-17所示。构造一个三次Hermite插值函数， 并求出$f\left(\frac12\right)$ 的近似值.

x | 0 | 1
---|---|---
y = f(x) | 0 | 1
y' = f'(x) | 3 | 9

解由（2.26）式、（2.27）式、（2.28）式和(2.29)式得到

$$\begin{aligned}
&h_{0}\left(\:x\:\right)=\left(\:1\:+2x\:\right)\left(\:x-1\:\right)^{2} \\
&h_{1}\left(\:x\:\right)=\left[\:1-2\left(\:x-1\:\right)\:\right]x^{2} \\
&H_{0}\left(\:x\:\right)\:=x\left(\:x-1\:\right)^{2} \\
&H_{1}\left(\:x\:\right)\:=\left(\:x-1\:\right)x^{2}
\end{aligned}$$

从而由（2.30）式得

$$\begin{aligned}
H(x)& =y_{0}h_{0}(\:x\:)\:+y_{1}h_{1}(\:x\:)\:+m_{0}H_{0}(\:x\:)\:+m_{1}H_{1}(\:x\:) \\
&=\left[\begin{array}{c}{1-2\left(\begin{array}{c}{x-1}\\\end{array}\right)}\\\end{array}\right]x^{2}+3x\left(\begin{array}{c}{x-1}\\\end{array}\right)^{2}+9\left(\begin{array}{c}{x-1}\\\end{array}\right)x^{2} \\
&f\bigg[\:{\frac{1}{2}}\bigg]\approx H\bigg[\:{\frac{1}{2}}\bigg]\:=\:-{\frac{1}{4}}
\end{aligned}$$

因此

定理2.5设$H(x)$ 是$f(x)$ 的三次Hermite插值函数， $\left[\begin{smallmatrix}a,b\end{smallmatrix}\right]$ 是包含$x_0,x_1$ 的任一区间，并设$f($ $x$ $) \in C^{3}\left [ \:a\:, b\:\right ]$ $, f^{( 4) }$ ( $x$ ) 在$\left[\begin{smallmatrix}a,b\end{smallmatrix}\right]$ 上存在，则对任意给定的$x\in\left[\begin{smallmatrix}a&,b\end{smallmatrix}\right]$ 总存在一点$\xi \in ($ $a$ $, b$ ) ，使得
$$R(x)=f(x)-H(x)=\frac{f^{(4)}(\xi)}{4!}(x-x_{0})^{2}(x-x_{1})^{2}$$

其中$\xi$ 依赖于$x$

证设$x$ 是$\left[\begin{smallmatrix}a&b\end{smallmatrix}\right]$ 中的任一固定数，若$x=x_{i}\left(i=0,1\right)$ ，则（2.31）式成立.下面考虑$x$ 不是插值节点的情况，

引人辅助函数

$$\varphi(\:t\:)=f(\:t\:)\:-H(\:t\:)\:-\frac{R(\:x\:)}{\left(\:x-x_{0}\:\right)^{2}\left(\:x-x_{1}\:\right)^{2}}\left(\:t-x_{0}\:\right)^{2}\left(\:t-x_{1}\:\right)^{2}$$

易知$\varphi ($ $t)$ 在$\left[\begin{smallmatrix}a&b\end{smallmatrix}\right]$ 上具有四阶连续导数，并有X $x_0$ $x_0$ $, x_1$ X1 $x_1$ 和$x3$ 个不同零点，其中$x_0$ $x_1$ 为二重零点.因此$\varphi^{\prime}(t)$ 在$\varphi ($ $t)$ 的每两个零点间至少存在一个零点，记这两个零点为7 $\eta_0$ $\eta_0,\eta_1$ ，从而$\varphi^{\prime}(t)$ 在:[ $a$ $, b$ ] 上至少有4个零点$x_0$ X $x_0$ $, x_1$ $, \eta _0$ $, \eta _1$ .故$\varphi ^{\prime \prime }($ $t)$ 在$\left[\begin{smallmatrix}a&b\end{smallmatrix}\right]$ 上至少有3个零点.按此类推， $\varphi^{(4)}(t)$ 在$\left[\begin{smallmatrix}a&b\end{smallmatrix}\right]$ 上至少有一个零点，把该零点记为$\xi$ 即有$\varphi^{(\:4)}\left(\xi\right)=0$

对$\varphi ($ $t)$ 求4次微商，并注意到$H(t)$ 为不超过三次的代数多项式，故

------------------------------------------------------------------

$$\varphi^{(4)}\left(t\right)=f^{(4)}\left(t\right)-4!\:\frac{R(x)}{\left(x-x_0\right)^2\left(x-x_1\right)^2}$$

把代人上式，并注意到$\varphi^{(\:4\:)}\left(\:\xi\:\right)=0$ ，移项后得
$$R(\:x\:)\:=\frac{f^{(4)}\:(\:\xi)}{4\:!}(\:x\:-x_{0}\:)^{2}\:(\:x\:-x_{1}\:)^{2}$$

# 2.4.2 $2n+1$ 次Hermite插值

$2n+1$ 次Hermite插值的提法是：

给定$y= f($ $x)$ 的函数表（如表2-18所示），构造函数$H($ $x$ ) 满足条件：

$\textcircled{1}H(x)$ 为不超过$2n+1$ 次的代数多项式；
$$2H(\:x_{i}\:)\:=y_{i}\:,H^{\prime}(\:x_{i}\:)\:=m_{i}\quad(\:i=0\:,1\:,\cdots,n\:)\:.$$

表2-18 $2n+1$ 次Hermite 插值函数表

| | x₀ | x₁  | ... | xₙ |
|---|-------|--------|-----|----|
| y = f(x) | y₀  | y₁  | ... | yₙ |
| y' = f'(x) | m₀  | m₁  | ... | mₙ |

$H(x)$ 称为$2n+1$ 次Hermite插值函数.

$2n+1$ 次Hermite插值的目的是构造$H($ $x)$ 来近似代替$f(x)$ .当求某一点$x^{\circ}$ 的函数值$f(x^{*})$ 时，可以用$H(x^{*})$ 近似代替$f(x^{*})$

$$H(\:x\:)\:=\:\sum_{i=0}\:\left[\:y_ih_i(\:x\:)\:+m_iH_i(\:x\:)\:\right]$$

$i= 0$ ,1 $, \cdots , n.$ 其中$h_i\left(\begin{matrix}x\end{matrix}\right)$ 和$H_i($ $x)$ 为不超过$2n+1$ 次的代数多项式，且满足表2 -19.

表2-19 $h_i(x)$ 和$H_i(x)$ 的取值

|  | 函数值 |  |  |  | 导数值 |  |  |  |
|---|---|---|---|---|---|---|---|---|
| $h_0(x)$ | 1 | 0 | ... | 0 | 0 | 0 | ... | 0 |
| $h_1(x)$ | 0 | 1 | ... | 0 | 0 | 0 | ... | 0 |
| :       | : | : | :  | : | : | : | :  | :   |
| $h_k(x)$ | 0 | 0 | ... | 1 | 0 | 0 | ... | 0 |
| $H_0(x)$ | 0 | 0 | ... | 0 | 1 | 0 | ... | 0 |
| $H_1(x)$ | 0 | 0 | ... | 0 | 0 | 1 | ... | 0 |
| :       | : | : | :  | : | : | : | :  | :   |
| $H_n(x)$ | 0 | 0 | ... | 0 | 0 | 0 | ... | 1 |

------------------------------------------------------------------

容易验证， $H(x)$ 满足插值的两个条件，即$H($ $x)$ 就是一个$2n+1$ 次Hermite插值函数.下面构造$h_i($ $x$ ) 和$H_i($ $x)$

先构造$h_0($ $x)$ .因为$h_{0}\left ( \:x_{i}\:\right )$ $= h_{0}^{\prime }\left ( \:x_{i}\:\right )$ =0 ，所以$h_0\left(\begin{matrix}x\end{matrix}\right)$ 必有因子[ $\left(\begin{matrix}x-x_{1}\end{matrix}\right)\left(\begin{matrix}x-\end{matrix}\right)$ $x_2$ $) \cdots ($ $x- x_n$ ) $] ^2$ 又因$h_0\left(\begin{matrix}x\end{matrix}\right)$ 为不超过$2n+1$ 次的代数多项式，故$h_0\left(\begin{matrix}x\end{matrix}\right)$ 可以表示为
$$h_{0}\left(\:x\:\right)=\left(\:ax+b\:\right)l_{0}^{2}\left(\:x\:\right)$$

其中$a$ 和$b$ 为待定常数$;l_{0}\left(x\right)=\frac{\left(\begin{array}{c}{x-x_{1}}\end{array}\right)\left(\begin{array}{c}{x-x_{2}}\end{array}\right)\cdots\left(\begin{array}{c}{x-x_{n}}\end{array}\right)}{\left(\begin{array}{c}{x_{0}-x_{1}}\end{array}\right)\left(\begin{array}{c}{x_{0}-x_{2}}\end{array}\right)\cdots\left(\begin{array}{c}{x_{0}-x_{n}}\end{array}\right)}.$

又因$h_0\left(\:x_0\:\right)=1$ ，故有$ax_0+b=1$ ，即$b=1-ax_0$

对$h_0($ $x$ ) 求一阶导数得

$$h_{0}^{\prime}\left(\:x\:\right)=al_{0}^{2}\left(\:x\:\right)+2\left(\:ax\:+b\:\right)l_{0}\left(\:x\:\right)l_{0}^{\prime}\left(\:x\:\right)$$

由$h_{0}^{\prime }($ $x_{0}$ )=0 ，故有

$$h_{0}'\left(\:x_{0}\:\right)=a+2l_{0}'\left(\:x_{0}\:\right)=0$$

从而得到

$$\begin{aligned}
&a=-2l_{0}^{\prime}(\:x_{0}\:) \\
&b=1\:+2x_{0}l_{0}^{\prime}\:(\:x_{0}\:) \\
&h_{0}\left(\:x\:\right)=\left[\:1-2\left(\:x-x_{0}\:\right)l_{0}^{\prime}\left(\:x_{0}\:\right)\:\right]l_{0}^{2}\left(\:x\:\right)
\end{aligned}$$

为求$l_0'\left(x_0\right)$ ，对$l_0(x)$ 两边取对数得
$$\begin{aligned}\ln\left[\:l_{0}\left(\:x\:\right)\:\right]&=\ln\left(\:x-x_{1}\:\right)\:+\ln\left(\:x-x_{2}\:\right)\:+\cdots\:+\ln\left(\:x-x_{n}\:\right)\:-\\&\left[\:\ln\left(\:x_{0}\:-x_{1}\:\right)\:+\ln\left(\:x_{0}\:-x_{2}\:\right)\:+\cdots\:+\ln\left(\:x_{0}\:-x_{s}\:\right)\:\right]\end{aligned}$$

对上式两边求导数得

$$\begin{gathered}
\frac{1}{l_{0}\left(\:x\:\right)}l_{0}^{\prime}\left(\:x\:\right)\:=\:\sum_{j=1}^{n}\:\frac{1}{x-x_{j}} \\
l_{0}^{\prime}\left(\:x\:\right)\:=l_{0}\left(\:x\:\right)\left[\:\sum_{j=1}^{\infty}\:\frac{1}{x-x_{j}}\right] \\
l_{0}^{\prime}\left(\:x_{0}\:\right)\:=\:\sum_{j=1}^{n}\:\frac{1}{x_{0}\:-x_{j}} 
\end{gathered}$$

从而有

由此推得

于是得到

$$h_0\left(\:x\:\right)=\left[\begin{array}{c}1-2\left(\:x-x_0\:\right)\left[\:\sum\limits_{j=1}^n\:\frac{1}{x_0\:-x_j}\right]\end{array}\right]\:l_0^2\left(\:x\:\right)$$

用同样的方法可以得到
$$h_{i}(\:x\:)\:=\:\left[\:1-2\:(\:x-x_{i}\:)\:\right[\:\sum_{j=1\atop j\neq i}^{n}\:\frac{1}{x_{i}-x_{j}}\Bigg]\:\Big]\:l_{i}^{2}\:(\:x\:)\:(\:i=1\:,2\:,\cdots,n\:)$$

再来构造H(x) $H_i(x)$ $H_{\mathrm{i} }\left ( x\right ) , i= 0$ ,1 $, \cdots , n.$ 先构造$H_0($ $x)$ .因为$H_{0}\left(\:x_{0}\:\right)=0$ 和$H_{0}\left ( \:x_{i}\:\right )$ $= H_{0}^{\prime }$ $\left(\begin{matrix}x_{i}\end{matrix}\right)=0\left(\begin{matrix}i=1&,2&,\cdots,n\end{matrix}\right)$ ，所以$H_0($ $x$ ) 必有因子$\left(\:x-x_{0}\:\right)\left[\:\left(\:x-x_{1}\:\right)\cdots\left(\:x-x_{n}\:\right)\:\right]^{2}.$ 又因

------------------------------------------------------------------

$H_0(x)$ 为不超过$2n+1$ 次的代数多项式，故$H_0($ $x)$ 可以表示为

$$H_{0}\left(\:x\:\right)=a\left(\:x-x_{0}\:\right)l_{0}^{2}\left(\:x\:\right)$$

其中$a$ 为待定常数

对$H_0($ $x)$ 求一阶导数得

$$H_{0}^{\prime}\left(x\right)=a\bigl[\begin{matrix}l_{0}^{2}\left(x\right)+2\left(x-x_{0}\right)l_{0}\left(x\right)l_{0}^{\prime}\left(x\right)\end{matrix}\bigr]$$

由$H_0^{\prime}\left(\:x_0\:\right)=1$ 得$a=1.$ 于是得到

$$H_{0}\left(\:x\:\right)=\left(\:x-x_{0}\:\right)l_{0}^{2}\left(\:x\:\right)$$

用同样的方法可以得到

$$H_{i}\left(x\right)=\left(x-x_{i}\right)l_{i}^{2}\left(x\right)\quad\left(i=1,2,\cdots,n\right)$$

因此， $,2n+1$ 次Hermite 插值函数为

$$\begin{aligned}
H(x)& =\:\sum_{i=0}^{n}\:\left[\:y_{i}h_{i}(x)\:+m_{i}H_{i}(\:x)\:\right] \\
&=\:\sum_{i=0}^{n}\:\left\{\:y_{i}\:\right[\:1-2\:(\:x-x_{i}\:)\:\left[\:\sum_{j=1}^{n}\:\frac{1}{x_{i}-x_{j}}\right]\:\left[\:l_{i}^{2}\:(\:x\:)\:+m_{i}\:(\:x-x_{i}\:)\:l_{i}^{2}\:(\:x\:)\:\right]
\end{aligned}$$

类似于定理2.5，可以证明如下定理

定理2.6设给定如表2-18所示的函数表， $.H(x)$ 是$2n+1$ 次Hermite插值函数， $[a,b]$ 是包含$x_0$ $, x_1$ $, \cdots , x_n$ 的任一区间，并设$f($ $x$ $) \in C^{2\pi \:+ \:1}\left [ \:a, b\:\right ] , f^{( \:2n\:+ \:2\:) }\left ( \:x\:\right )$ 在$\left[\begin{smallmatrix}a&0\\0&0\end{smallmatrix}\right]$ $b$ ] 上存在，则对任意给定的$x\in [$ $a$ $, b$ ] ，总存在一点$\xi \in ($ $a$ $, b$ ) ，使得
$$R(x)=f(x)-H(x)=\frac{f^{(2s+2)}(\xi)}{(2n+2)!}\omega^{2}(x)$$

其中$\xi$ 依赖于$x, \omega ( x) = ($ $x- x_{0}$ )( $x- x_{1}$ $) \cdots ($ $x- x_{n}$ )

# 分段三次Hermite插值

在2.3中介绍的分段线性插值函数在节点处的导数是不连续的.如果除了给定被插值函数在节点处的函数值外，还给出被插值函数在节点处的导数值，要想构造一个在节点处的导数也连续的插值函数可以使用分段三次Hermite 插值

分段三次Hermite插值的提法是：

给定函数$y= f($ $x$ ) 的函数表（如表2-12所示），构造函数$q(x)$ 满足条件：

$\textcircled{\mathrm{D}}q(x)$ 在$\left[\begin{array}{c}x_i,x_{i+1}\end{array}\right]$ $\left[\begin{array}{c}x_i,x_{i+1}\end{array}\right]$ $\left [ \:x_{i}\:, x_{i+ 1}\:\right ] ($ $i= 0$ ,1 $, \cdots , n- 1$ ) 上为三次代数多项式：

$\textcircled {2}q( x_i) = y_i($ $i= 0$ ,1 $, \cdots , n)$ ; $\textcircled{3}q(x)\in C^1[a,b]$ ，其中$a=x_0$ α =Xo $a= x_0$ $, b= x_n$ b = x $b=x_n$

其中$q(x)$ 称为分段三次Hermite插值函数

根据分段三次Hermite插值条件和三次Hermite 插值公式（2.30），可以把$q(x)$ 直接构造出来.在区间$\left[\begin{array}{c}x_i,x_{i+1}\end{array}\right]$ ]上有

------------------------------------------------------------------

$$\left.q\left(x\right)=\left[\begin{array}{c}1+2\:\frac{x-x_{i}}{x_{i+1}-x_{i}}\end{array}\right.\right]\left[\begin{array}{c}x-x_{i+1}\\x_{i}-x_{i+1}\end{array}\right]^{2}y_{i}+\left[\begin{array}{c}1+2\:\frac{x-x_{i+1}}{x_{i}-x_{i+1}}\end{array}\right]\left[\begin{array}{c}x-x_{i}\\x_{i+1}-x_{i}\end{array}\right]^{2}y_{i+1}+$$

$$(\:x-x_{i}\:)\Bigg[\:\frac{x-x_{i+1}}{x_{i}-x_{i+1}}\Bigg]^{2}m_{i}\:+(\:x-x_{i+1}\:)\Bigg[\:\frac{x-x_{i}}{x_{i+1}-x_{i}}\Bigg]^{2}m_{i+1}$$

分段三次Hermite插值函数$q(x)$ 也可以由插值基函数组合而成.若在插值区间[ $a$ $, b$ ] 上定义一组分段三次Hermite 插值基函数$h_i(x)$ 和H(x) $H_i($ $x)$ $H_i($ $x)$ ( $i= 0$ ,1 $, \cdots , n$ ) 则由（2.38）式得
$$q(\:x\:)\:=\:\sum_{i=0}^{*}\:[\:y_{i}h_{i}(\:x\:)\:+m_{i}H_{i}(\:x\:)\:]$$

其中$h_i(x)$ 和$H_i(x)$ 分别为：
$$\begin{aligned}
&h_{0}(& x\:)\:=\:\left[\begin{array}{cc}{1\:+2\:\frac{x\:-x_{0}}{x_{1}\:-x_{0}}}\\{0}&{(\:x_{0}\:\leq\:x\:\leq\:x_{1}\:)}\\\end{array}\right]^{2}\quad(\:x_{0}\:\leq\:x\:\leq\:x_{1}\:)  \\
&h_{i}\left(x\right)&& \left.=\left[\begin{array}{c}1+2\:\frac{x-x_{i}}{x_{i-1}-x_{i}}\end{array}\right.\right]\left[\begin{array}{c}x-x_{i-1}\\x_{i}-x_{i-1}\end{array}\right]^{2}\quad\left(\begin{array}{c}x_{i-1}\leq x\leq x_{i}\end{array}\right)\\=\left[\begin{array}{c}1+2\:\frac{x-x_{i}}{x_{i+1}-x_{i}}\end{array}\right]\left[\begin{array}{c}x-x_{i+1}\\x_{i}-x_{i+1}\end{array}\right]^{2}\quad\left(\begin{array}{c}x_{i}<x\leq x_{i+1}\end{array}\right)\\0\left[\begin{array}{c}a,b\end{array}\right]-\left[\begin{array}{c}x_{i-1}\end{array}\right]  \\
&&&(\:i=1,2,\cdots,n-1\:) \\
&h_{s}\left(x\right)&& =\left[\begin{array}{c}{1+2\:\frac{x-x_{n}}{x_{n-1}-x_{n}}}\\{0}\end{array}\right]\left[\begin{array}{c}{x-x_{n-1}}\\{x_{n-1}}\\\end{array}\right]^{2}\quad\left(\begin{array}{c}{x_{n-1}\leq x\leq x_{n}}\\{x_{n-1}}\\\end{array}\right)  \\
&H_{0}\left(\:x\:\right)&& =\left[\begin{array}{cc}{(\:x-x_{0}\:)}&{{\frac{x-x_{1}}{x_{0}-x_{1}}}}\\{0}&{{(\:x_{0}\leq x\leq x_{1}\:)}}\\\end{array}\right.  \\
&&&\left[\begin{array}{c|c}(x-x_i)&\frac{x-x_{i-1}}{x-x}\end{array}\right]^2\quad(x_{i-1}\leqslant x\leqslant x_i)
\end{aligned}$$

$$\begin{aligned}
&(\:i=1,2,\cdots,n-1\:) \\
&h_{x}\left(x\right) =\left[\begin{array}{c}{{1+2\:{\frac{x-x_{n}}{x_{n-1}-x_{n}}}}}\\{0}\end{array}\right]\left[\begin{array}{c}{{\frac{x-x_{n-1}}{x_{n}-x_{n-1}}}}\end{array}\right]^{2}\quad(\begin{array}{c}{{x_{n-1}\leq x\leq x_{n}}}\\{{x_{n-1}\leq x\leq x_{n-1}}}\end{array}  \\
&H_{0}\left(x\right) =\left[\begin{array}{cc}(\:x-x_0\:)\left[\:\frac{x-x_1}{x_0-x_1}\right]^2&(\:x_0\leq x\leq x_1\:)\\\\0&(\:x_1<x\leq x_n\:)\end{array}\right.  \\
&H_{i}(x) \left.=\left[\begin{array}{cc}(\:x-x_{i}\:)\left[\:\frac{x-x_{i-1}}{x_{i}-x_{i-1}}\right]^{2}&(\:x_{i-1}\leq x\leq x_{i}\:)\\\\(\:x-x_{i}\:)\left[\:\frac{x-x_{i+1}}{x_{i}-x_{i+1}}\right]^{2}&(\:x_{i}<x\leq x_{i+1}\:)\\\\0&[\:a,b\:]-[\:x_{i-1}\end{array}\right.\right.  \\
&(\:i=1\:,2\:,\cdots,n-1\:) \\
&H_{n}\left(x\right) =\left[\begin{array}{cc}(\:x-x_{s}\:)&\:\frac{x-x_{s-1}}{x_{n}-x_{n-1}}\end{array}\right]^{2}\quad(\:x_{n-1}\leq x\leq x_{n}\:)\\0\quad(\:x_{0}\leq x<x_{n-1}\:) 
\end{aligned}$$

------------------------------------------------------------------

分段三次Hermite插值算法

①读人插值节点$x_i$ ，函数值$y_{i}$ ，导数值$m_{i}\left(i=0,1,\cdots,n\right)$ 和点$xx$

$\textcircled{2}$ 对$i=0,1,\cdots,n-1$ ，如果$xx<x_{i+1}$ 则

$$\left.yy=\left[\begin{array}{c}{xx-x_{i}}\\{1+2\:\frac{xx-x_{i}}{x_{i+1}-x_{i}}}\\\end{array}\right.\right]\left[\begin{array}{c}{xx-x_{i+1}}\\{x_{i}-x_{i+1}}\\\end{array}\right]^{2}y_{i}+\left[\begin{array}{c}{1+2\:\frac{xx-x_{i+1}}{x_{i}-x_{i+1}}}\\\end{array}\right]\left[\begin{array}{c}{xx-x_{i}}\\{x_{i+1}-x_{i}}\\\end{array}\right]^{2}y_{i+1}+$$

$$(\:xx-x_{i}\:)\Bigg[\:\frac{xx-x_{i+1}}{x_{i}-x_{i+1}}\Bigg]^{2}m_{i}+(\:xx-x_{i+1}\:)\Bigg[\:\frac{xx-x_{i}}{x_{i+1}-x_{i}}\Bigg]^{2}m_{i+1}$$

输出点$xx$ 相应的函数近似值yy.转到$\textcircled{3}$ $\textcircled{3}$ 结束

定理2.7设给定如表2-13所示的函数表，令$a=x_0$ α = Xo $a= x_0$ $, b= x_n$ $, f($ $x$ ) $\in C^3$ $\left[\begin{smallmatrix}a&b\end{smallmatrix}\right],f^{(4)}(x)$ 在$[\begin{smallmatrix}a&b\end{smallmatrix}]$ 上存在， $q(x)$ 是$f(x)$ 的分段三次Hermite插值函数，则有
$$\mid R(x)\mid=\mid f(x)-q(x)\mid\leqslant\frac{h^{4}}{384}M$$

其中$h=\max_{0\in i\in x-1}\mid x_{i+1}-x_{i}\mid,M=\max_{\alpha\in x\in b}\mid f^{(4)}(x)\mid.$

证明由于$q(x)$ 在每个小区间$\begin{bmatrix} x_{i}, x_{i+ 1}\end{bmatrix} ( \begin{array} { c } i= 0\end{array} , 1$ $, \cdots , n- 1$ ) 上都是三次$Her.$ mite插值函数，所以由（2.31)式可知，在$\left [ \:x_{i}\:, x_{i+ 1}\:\right ] ($ $i= 0$ ,1 $, \cdots , n- 1$ ) 上有
$$R(\:x\:)\:=f(\:x\:)\:-q(\:x\:)\:=\frac{f^{(\:4\:)}\left(\:\xi_{i}\:\right)}{4\:!}\left(\:x-x_{i}\:\right)^{2}\left(\:x-x_{i+1}\:\right)^{2}$$

其中$\xi_i$ 依赖于$x$ .且$x_{i}<\xi_{i}<x_{i+1}$

$$\max_{x_i\in x\in x_{i+1}}\mid\left(\:x-x_i\:\right)^2\left(\:x-x_{i+1}\:\right)^2\mid=\frac{\left(\:x_{i+1}-x_i\:\right)^4}{16}$$

因为

$$\max_{x_{i}=x_{i}\in x_{i+1}}\mid R(\:x\:)\mid\leqslant\frac{\left(\:x_{i+1}-x_{i}\:\right)^{4}}{384}\max_{x_{i}\in x\in x_{i+1}}\mid f^{(4)}\left(\:x\:\right)\mid $$

故

若记$h=\max_{0\leq(x_{i}-1}\mid x_{i+1}-x_{i}\mid,M=\max_{s\leq j\leq\delta}\mid f^{(4)}(x)\mid$ ，则在$\left[\begin{smallmatrix}a&b\end{smallmatrix}\right]$ 上有

$$\mid R(\:x\:)\mid=\mid f(\:x\:)-q(\:x\:)\mid\leqslant\frac{h^{4}}{384}M$$

# 2.5三次样条插值

前面已经介绍过怎样根据给定函数表的节点构造插值多项式.当函数表的节点很多时.构造出来的是一个高次插值多项式.而高次插值多项式与被插值函数$f(x)$ 的误差有时比较大.为了减少误差，可以采用分段插值.但分段插值也有缺点， 那就是插值函数在节点处不够光滑，例如，分段线性插值函数只保证在节点处连续，它的导数在节点处就不连续了.又如，分段三次Hermite 插值也只有一阶导数

------------------------------------------------------------------

连续，二阶导数就不连续了，而往往实际问题中有时很难给出导数条件.但在一些实际问题中，不仅要求构造的插值函数在节点处连续，一阶导数在节点处连续，而且还要求插值函数在节点处二阶导数也连续.换句话说，就是要求提高插值函数在节点处的光滑度，同时减少对节点处导数的要求.为了提高插值函数在节点处的光滑度，可以采用样条插值，

样条插值需要用到样条函数.什么叫样条函数？这要从工程中的样条曲线谈起.在工程实践中，比如造船、造飞机等，绘图员为了在钢板或铝板上将一些点连结成一条光滑曲线，往往用细长的木条把这些点连接起来.对这条光滑曲线进行数学模拟就得到一个函数，由于这个函数与木条有联系，而木条又称为样条，所以该函数称为样条函数.

样条函数有一次、二次、三次或更高次的样条函数.三次样条函数是一个分段代数多项式，在每一个分段上它是一个不超过三次的代数多项式，它在节点上连续，其一阶导数和二阶导数在节点上也连续.因而，三次样条函数属于$C^2[$ $a$ $, b$ ] ，这是三次样条函数的一个突出优点.由于有这样的优点，三次样条函数在实际中得到广泛的应用.三次样条函数用在插值中就产生了一种插值方法，这种方法称为三次样条插值

三次样条插值的提法是：

给定$y= f($ $x$ ) 的函数表（如表2-2所示），构造函数$\therefore s(x)$ 满足条件：

$\textcircled{1}$ 在$\left[\begin{smallmatrix}x_i,x_{i+1}\end{smallmatrix}\right]$ $\left[\begin{smallmatrix}x_i,x_{i+1}\end{smallmatrix}\right]$ $\left [ \:x_{i}\:, x_{i+ 1}\:\right ] ($ $i= 0$ ,1 $, \cdots , n- 1$ ) 上为不超过三次的代数多项式；

$\textcircled {2}s( x_i) = y_i($ $i= 0$ ,1 $, \cdots , n$ ) ; ③ $\textcircled{3}$ $\textcircled {3}$ $s($ $x)$ $\in C^2\begin{bmatrix} a\:, b\:\end{bmatrix}$ ，其中$a=x_0$ α =X) $a= x_0$ $, b= x_n$ b=x $b=x_n$

其中$s(x)$ 称为三次样条插值函数

下面讨论如何构造三次样条插值函数$s(x)$ .

设$s($ $x$ ) 在点$x_i($ $i= 0$ , 1 $, \cdots , n$ ) 处的微商为$m_{i}($ $i= 0$ ,1 $, \cdots , n)$ ，则$s(x)$ 在每个小区间$\left[\left.x_i,x_{i+1}\right]\right]$ 上有

$$s(\:x_{i}\:)\:=y_{i}\quad s'(\:x_{i}\:)\:=m_{i}\quad s(\:x_{i+1}\:)\:=y_{i+1}\quad s'(\:x_{i+1}\:)\:=m_{i+1}$$

从而$s(x)$ 在区间$\left[\begin{smallmatrix}x_i&x_{i+1}\end{smallmatrix}\right]$ 上满足三次Hermite 插值的两个条件.按照三次Hermite 插值公式，在区间$\left[\begin{smallmatrix}x_i,x_{i+1}\end{smallmatrix}\right]$ 上有

$$\left.s\left(x\right)=\left[\begin{array}{c}1+2\:\frac{x-x_{i}}{x_{i+1}-x_{i}}\end{array}\right.\right]\left[\begin{array}{c}x-x_{i+1}\\x_{i}-x_{i+1}\end{array}\right]^{2}y_{i}+\left[\begin{array}{c}1+2\:\frac{x-x_{i+1}}{x_{i}-x_{i+1}}\end{array}\right]\left[\begin{array}{c}x-x_{i}\\x_{i+1}-x_{i}\end{array}\right]^{2}y_{i+1}+$$

$$(\:x-x_{i}\:)\Bigg[\:\frac{x-x_{i+1}}{x_{i}-x_{i+1}}\Bigg]^{2}m_{i}\:+\:(\:x-x_{i+1}\:)\Bigg[\:\frac{x-x_{i}}{x_{i+1}-x_{i}}\Bigg]^{2}m_{i+1}$$

在(2.41)式中， $m_{i}$ 是未知的.为了求$m_i$ ，可以利用插值条件$\textcircled{3}$ ，也就是利用$s($ $x$ ) 在$x_{i}($ $i= 0$ ,1 $, \cdots , n$ ) 上具有连续的二阶微商的性质

首先，令$h_i=x_{i+1}-x_i$ ，由(2.41)式得到

------------------------------------------------------------------

$$s\left(\:x\:\right)=\left[\begin{array}{c}1+2\:\frac{x-x_i}{h_i}\end{array}\right]\frac{\left(\:x-x_{i+1}\:\right)^2}{h_i^2}y_i+\left[\begin{array}{c}1-2\:\frac{x-x_{i+1}}{h_i}\end{array}\right]\frac{\left(\:x-x_i\:\right)^2}{h_i^2}y_{i+1}+$$

$$\left(\begin{array}{c}x-x_i\end{array}\right)\frac{\left(\begin{array}{c}x-x_{i+1}\end{array}\right)^2}{h_i^2}m_i+\left(\begin{array}{c}x-x_{i+1}\end{array}\right)\frac{\left(\begin{array}{c}x-x_i\end{array}\right)^2}{h_i^2}m_{i+1}$$

从而在x $x_i$ $\left[\begin{matrix}x_{i},x_{i+1}\end{matrix}\right]$ x+1 $x_{i+1}$ 上有

$$\left.s''(\:x\:)\:=\left[\begin{array}{c}\frac{6}{h_{i}^{2}}-\frac{12}{h_{i}^{3}}(\:x_{i+1}-x\:)\end{array}\right.\right]y_{i}\:+\left[\begin{array}{c}\frac{6}{h_{i}^{2}}-\frac{12}{h_{i}^{3}}(\:x-x_{i}\:)\end{array}\right]y_{i+1}\:+$$

$$\left[\begin{array}{c}\frac{2}{h_i}-\frac{6}{h_i^2}(\:x_{i+1}-x\:)\end{array}\right]m_i-\left[\begin{array}{c}\frac{2}{h_i}-\frac{6}{h_i^2}(\:x-x_i\:)\end{array}\right]m_{i+1}$$

分别把(2.42）式和（2.43）式中的下标$i+1$ 改为$i,i$ 改为i-1,则在区间$\left[\begin{smallmatrix}x_{i-1}&,x_{i}\end{smallmatrix}\right]$ 上有

$$s\left(\:x\:\right)=\left[\begin{array}{c}1+2\:\frac{x-x_{i-1}}{h_{i-1}}\end{array}\right]\frac{\left(\:x-x_{i}\:\right)^{2}}{h_{i-1}^{2}}y_{i-1}+\left[\begin{array}{c}1-2\:\frac{x-x_{i}}{h_{i-1}}\end{array}\right]\frac{\left(\:x-x_{i-1}\:\right)^{2}}{h_{i-1}^{2}}y_{i}+$$

$$\left(\:x-x_{i-1}\:\right)\frac{\left(\:x-x_{i}\:\right)^{2}}{h_{i-1}^{2}}m_{i-1}\:+\:\left(\:x-x_{i}\:\right)\frac{\left(\:x-x_{i-1}\:\right)^{2}}{h_{i-1}^{2}}m_{i}$$

$$s''(\:x\:)=\left[\begin{array}{c}6\\\hline h_{i-1}^2\end{array}-\frac{12}{h_{i-1}^3}(\:x_i-x\:)\:\right]y_{i-1}+\left[\begin{array}{c}6\\\hline h_{i-1}^2\end{array}-\frac{12}{h_{i-1}^3}(\:x-x_{i-1}\:)\:\right]y_i+$$

$$\left.\left[\begin{array}{c}\frac{2}{h_{i-1}}-\frac{6}{h_{i-1}^{2}}(\:x_{i}-x\:)\end{array}\right.\right]m_{i-1}-\left[\begin{array}{c}\frac{2}{h_{i-1}}-\frac{6}{h_{i-1}^{2}}(\:x-x_{i-1}\:)\end{array}\right]m_{i}$$

由(2.43)式和(2.45)式，当$i= 1$ ,2 $, \cdots$ $, n- 1$ 时，有

$$s^{\prime\prime}(\:x_{i}^{+}\:)\:=\:-\frac{6}{h_{i}^{2}}y_{i}+\frac{6}{h_{i}^{2}}y_{i+1}\:-\frac{4}{h_{i}}m_{i}\:-\frac{2}{h_{i}}m_{i+1}$$

$$s^{\prime\prime}(\:x_{i}^{-}\:)\:=\frac{6}{h_{i-1}^{2}}y_{i-1}-\frac{6}{h_{i-1}^{2}}y_{i}\:+\frac{2}{h_{i-1}}m_{i-1}\:+\frac{4}{h_{i-1}}m_{i}$$

因为$s(x)$ 在$x_i$ 上具有连续的二阶微商，所以$s^{\prime \prime }($ $x_i^-$ ) $= s^{\prime \prime }($ $x_i^+$ ) ，即

$$\frac{6}{h_{i-1}^{2}}y_{i-1}-\frac{6}{h_{i-1}^{2}}y_{i}+\frac{2}{h_{i-1}}m_{i-1}+\frac{4}{h_{i-1}}m_{i}=-\frac{6}{h_{i}^{2}}y_{i}+\frac{6}{h_{i}^{2}}y_{i+1}-\frac{4}{h_{i}}m_{i}-\frac{2}{h_{i}}m_{i+1}$$

将上式整理后得

$$\frac{m_{i-1}}{h_{i-1}}+2\:\frac{h_{i-1}+h_{i}}{h_{i-1}h_{i}}m_{i}+\frac{m_{i+1}}{h_{i}}=3\Bigg[\:\frac{y_{i}-y_{i-1}}{h_{i-1}^{2}}+\frac{y_{i+1}-y_{i}}{h_{i}^{2}}\Bigg]$$

上式两边乘$:\frac{h_{i-1}h_i}{h_{i-1}+h_i}$ 得

$$\frac{h_{i}}{h_{i-1}+h_{i}}m_{i-1}\:+2m_{i}\:+\frac{h_{i-1}}{h_{i-1}+h_{i}}m_{i-1}\:=3\bigg[\:\frac{h_{i}}{(\:h_{i-1}\:+h_{i}\:)\:h_{i-1}}(\:y_{i}\:-y_{i-1}\:)\:+\\\frac{h_{i-1}}{(\:h_{i-1}\:+h_{i}\:)\:h_{i}}(\:y_{i+1}\:-y_{i}\:)\:\bigg]$$

------------------------------------------------------------------

令$\alpha_i=\frac{h_{i-1}}{h_{i-1}+h_i}$ 上式变为

$$\left(\begin{array}{c}1-\alpha_i\end{array}\right)m_{i-1}+2m_i+\alpha_im_{i+1}=3\left[\begin{array}{c}1-\alpha_i\\h_{i-1}\end{array}\left(\begin{array}{c}y_i-y_{i-1}\end{array}\right)+\frac{\alpha_i}{h_i}\left(\begin{array}{c}y_{i+1}-y_i\end{array}\right)\right]$$

再令$\beta_{i}=3\left[\:\frac{1-\alpha_{i}}{h_{i-1}}(\:y_{i}-y_{i-1}\:)\:+\frac{\alpha_{i}}{h_{i}}(\:y_{i+1}-y_{i}\:)\right]$ ，由上式得

$$(\begin{array}{c}1-\alpha_i\end{array})m_{i-1}+2m_i+\alpha_im_{i+1}=\beta_i\quad(\begin{array}{c}i=1,2,\cdots,n-1\end{array})$$

分别令$i= 1$ ,2 $, \cdots$ $, n- 1$ ，得到由$n-1$ 个等式组成的方程组：
$$\begin{aligned}&(\:1\:-\:\alpha_{1}\:)\:m_{0}\:+2m_{1}\:+\:\alpha_{1}m_{2}&&=\mathbf{\beta}_{1}\\&(\:1\:-\:\alpha_{2}\:)\:m_{1}\:+2\:m_{2}\:+\:\alpha_{2}\:m_{3}&&=\mathbf{\beta}_{2}\\&&&\vdots\\&(\:1\:-\:\alpha_{n-1}\:)\:m_{n-2}\:+2\:m_{n-1}\:+\:\alpha_{n-1}\:m_{n}&&=\mathbf{\beta}_{n-1}\end{aligned}$$

这是一个含有$n+1$ 个未知数和$n-1$ 个方程的线性方程组，因而方程组有无穷多个解，

为了得到惟一解，需要根据具体情况补充两个附加条件，从而消去两个未知数或补充两个方程，通常选取边界条件作为附加条件.而边界条件一般有如下两种情形：

（1）已知被插值函数$y$ $= f($ $x$ ) 在两个端点$x_0$ 和$x_n$ 处的微商值，即给定$f^{\prime }($ $x_{0}$ ) $= m_{0}$ 和$f^{\prime }($ $x_{n}$ ) $= m_{x}$ ，相应要求$s($ $x_0$ ) $= m_0$ 和$s($ $x_{_{n}}$ ) $= m_{_{n}}$ ，再把$m_0$ 和$m_{n_{x}}$ 代人方程组(2.48)，方程组(2.48)就变成只有$n-1$ 个未知数了，

(2)已知被插值函数$y= f($ $x)$ 在两个端点$x_0$ 和$x_{_{_{k}}}$ 处的二阶微商值为0，即给定$f^{\prime \prime }($ $x_{0}$ ) =0和$f^{\prime \prime }($ $x_{\mathrm{o} }$ ) =0 ，相应要求$s^{\prime \prime }($ $x_0$ ) =0和$s^{\prime \prime }($ $x_{x}$ ) =0

由（2.46）式得

$$s''(\:x_0^+\:)\:=\:-\frac{6}{h_0^2}y_0\:+\frac{6}{h_0^2}y_1\:-\frac{4}{h_0}m_0\:-\frac{2}{h_0}m_1\:=0$$

整理后得

$$2m_0+m_1=\frac{3}{h_0}(\:y_1-y_0\:)$$

由（2.47）式得

$$s^{\prime\prime}(\stackrel{-}{x_{n}})=\frac{6}{h_{n-1}^{2}}y_{n-1}-\frac{6}{h_{n-1}^{2}}y_{n}+\frac{2}{h_{n-1}}m_{n-1}+\frac{4}{h_{n-1}}m_{n}=0$$

整理后得

$$m_{n-1}+2m_{s}=3\:\frac{y_{s}-y_{s-1}}{h_{s-1}}$$

把方程（2.49）、方程（2.50）和方程组（2.48）联立起来，就得到一个有$n+1$ 个

------------------------------------------------------------------

未知数和$n+1$ 个方程的线性代数方程组，

从前面的讨论可知，补充了边界条件之后就可以求线性代数方程组的解$m_0$ $m_1$ m $m_1$ $, \cdots$ $, m_n$ 了.将$m_0, m_1$ $, \cdots , m_n$ 代人$s(x)$ 的各个子区间上的表达式(2.41)就可以得到三次样条插值函数$s(x)$

为了便于在计算机上实现三次样条插值，把由上述两种边界条件推得的方程组写成统一形式：
$$\begin{aligned}2m_{0}&+\alpha_{0}m_{1}&=\beta_{0}\\\left(\begin{array}{cc}1-\alpha_{1}\end{array}\right)m_{0}&+2m_{1}+\alpha_{1}m_{2}&=\beta_{1}\\\left(\begin{array}{cc}1-\alpha_{2}\end{array}\right)m_{1}&+2m_{2}+\alpha_{2}m_{3}&=\beta_{2}\\\left(\begin{array}{cc}1-\alpha_{2}\end{array}\right)m_{1}&+2m_{2}+\alpha_{2}m_{3}&=\beta_{2}\\\left(\begin{array}{cc}1-\alpha_{n-1}\end{array}\right)m_{n-2}+2m_{n-1}+\alpha_{n-1}m_{n}=\beta_{n-1}\end{aligned}$$

其中，对第一种边界条件： $\alpha _{0}$ =0 , $\beta _{0}$ = $2m_{0}$ , $\alpha _{n}$ = 1 , $\beta _{x}$ = 2 $m_{x}$ ；而对第二种边界条件：

$$\alpha_0=1\:,\beta_0=\frac{3}{h_0}(\:y_1\:-y_0\:)\:,\alpha_n=0\:,\beta_n=3\:\frac{y_n\:-y_{n-1}}{h_{n-1}}.$$

可以看到，方程组（2.51）所对应的系数矩阵强对角占优.而强对角占优的矩阵必定非奇异.因此，方程组（2.51)的解存在且惟一.

方程组(2.51)是一个三对角方程组，可以推出求mo $m_{0}$ $m_{1}$ $,m_1,\cdots$ $m_0$ $, m_1$ $, \cdots , m_0$ ... m. $m_\mathrm{u}$ 的计算公式

从方程组（2.51）的第一个方程得

$$m_0\:=\:-\frac{\alpha_0}{2}m_1\:+\frac{\beta_0}{2}$$

令$a_{0}=-\frac{\alpha_{0}}{2},b_{0}=\frac{\beta_{0}}{2}$ 则有

$$m_0=a_0m_1+b_0$$

把$m_{0}$ 代人方程组（2.51）的第二个方程，整理后得

$$m_1\:=\:-\frac{\alpha_1}{2\:+\:(\:1\:-\:\alpha_1\:)\:a_0}m_2\:+\frac{\beta_1\:-\:(\:1\:-\:\alpha_1\:)\:b_0}{2\:+\:(\:1\:-\:\alpha_1\:)\:a_0}$$
令$a_{1}=-\frac{\alpha_{1}}{2+\left(\begin{array}{c}1-\alpha_{1}\end{array}\right)a_{0}},b_{1}=\frac{\beta_{1}-\left(\begin{array}{c}1-\alpha_{1}\end{array}\right)b_{0}}{2+\left(\begin{array}{c}1-\alpha_{1}\end{array}\right)a_{0}}$ ，则有
$$m_1=a_1m_2+b_1$$

把$m_1$ 代人方程组（2.51）的第三个方程，整理后得

$$m_2\:=\:-\frac{\alpha_2}{2\:+\:(\:1\:-\:\alpha_2\:)\:a_1}m_3\:+\frac{\beta_2\:-\:(\:1\:-\:\alpha_2\:)\:b_1}{2\:+\:(\:1\:-\:\alpha_2\:)\:a_1}$$
令$a_{2}=-\frac{\alpha_{2}}{2+(\:1-\alpha_{2}\:)a_{1}},b_{2}=\frac{\beta_{2}-(\:1-\alpha_{2}\:)b_{1}}{2+(\:1-\alpha_{2}\:)a_{1}}$ ，则有
$$m_2=a_2m_3+b_2$$

------------------------------------------------------------------



------------------------------------------------------------------

![](https://storage.simpletex.cn/view/fNuTLQT1i3MamE7cLfQgQG9MRvf6QG6GY)
$\textcircled{6}$ 判别点$xx$ 所在的区间$\left[x_{i},x_{i+1}\right]\left(i=0,1,\cdots,n-1\right)$ ，然后由（2.41）式求出$s(x)$ 的值

并输出

例2-7给定函数表（见表2-20)和边界条件$s^{\prime \prime }($ $x_0$ ) =0 $, s^{\prime \prime }($ $x_n$ ) =0 ，求三次样条插值函数$s(x)$ ，并求$f(3)$ 的近似值

表2-20函数表

| x | 1 | 2 | 4 | 5 |
|---|---|---|---|---|
| y=f(x) | 1 | 3 | 4 | 2 |

解由$h_{i}= x_{i+ 1}- x_{i}($ $i= 0, 1$ ,2) 得$h_0= 1$ $, h_1$ =2 $, h_2$ =1 ;由$\alpha _{i}= \frac {h_{i- 1}}{h_{i- 1}\:+ h_{i}}($ $i= 1$
$$\mid\beta_{i}=3\bigg[\:\frac{1-\alpha_{i}}{h_{i-1}}(\:y_{i}-y_{i-1}\:)\:+\frac{\alpha_{i}}{h_{i}}(\:y_{i+1}-y_{i}\:)\:\bigg]\quad(\:i=1\:,2\:)$$
得$\beta _{1}$ $= \frac 92, \beta _{2}$ = $- \frac 72$

------------------------------------------------------------------

$$\hat{1}\:\alpha_{0}=1\:,\beta_{0}=\frac{3}{h_{0}}(\:y_{1}\:-\:y_{0}\:)\:=6\:,\alpha_{3}\:=0\:,\beta_{3}\:=3\:\frac{y_{3}\:-\:y_{2}}{h_{2}}=\:-6\:,$$
到

$$\begin{aligned}
& 2m_{0}\quad+\alpha_{0}m_{1} && =\beta_{0} \\
&&(\:1-\alpha_{1}\:)\:m_{0}\quad+2m_{1}&& +\alpha_{1}m_{2} & =\beta_{1} \\
&&&&(\:1-\alpha_{2}\:)\:m_{1}\quad+2m_{2}\:+\alpha_{2}m_{3}& =\beta_{2} \\
&&&&(\:1-\alpha_{3}\:)\:m_{2}\:+2m_{3}& =\beta 
\end{aligned}$$

把CXo $\alpha_0$ $\alpha _0$ $, \alpha _1$ $, \alpha _2$ $, \alpha _3$ $, \beta _0$ $, \beta _1$ $, \beta _2$ β $\beta_{2}$ 和$\beta_{3}$ 代人上面的方程组得

![](https://storage.simpletex.cn/view/f8AhfFh5T8agCkwWfYnXrpgsOxCakGHuT)

解这个方程组得ma=17 $m_0=\frac{17}8$ $m_{0}=\frac{17}{8},m_{1}=\frac{7}{4},m_{2}=-\frac{5}{4},m_{3}=-\frac{19}{8}.$

于是，由（2.41）式可以得到三次样条插值函数
$$\begin{aligned}
&&-\:\frac{1}{8}x^{3}\:+\:\frac{3}{8}x^{2}\:+\:\frac{7}{4}x-1\quad(\:1\leqslant x\leqslant2\:) \\
&s\left(\:x\:\right)& -\frac{1}{8}x^{3}+\frac{3}{8}x^{2}+\:\frac{7}{4}x-1\quad(2<x\leq4) \\
&&\frac{3}{8}x^{3}-\frac{45}{8}x^{2}+\frac{103}{4}x-33\quad(4<x\leq5)
\end{aligned}$$

从而得到$f(3)\approx s(3)=4.25$

对三次样条插值来说，被插值函数$f(x)$ 与三次样条插值函数$s($ $x$ ) 的误差估计的讨论是比较复杂的.为方便误差估计的讨论，给出如下定理，证明从略，

定理2.8设给定如表2-2所示的函数表， $s($ $x$ ) 是满足第一种边界条件的三次样条插值函数， $\left[\begin{smallmatrix}a,b\end{smallmatrix}\right]$ 是包含$x_0,x_1,\cdots,x_n$ 的任一区间，并设$f($ $x$ ) $\in$ $C^{4}$ [ $a$ $, b$ ] ，则对任意给定的$x\in [$ $a$ $, b$ ] ，有误差估计式
$$\max_{a\in\{a\in b\}}\left|f^{(a)}\left(x\right)-s^{(a)}\left(x\right)\right|\leqslant c_{k}\max_{a\in\{a\in b\}}\left|f^{(4)}\left(x\right)\right|h^{4-k}\quad(k=0,1,2)$$

其中， C =384 $c_0=\frac5{384}$ $c_0=\frac5{384};c_1=\frac1{24};c_2=\frac18$ c= $c_2=\frac18$ 和$h=\max_{0\leq i\leq k-1}\mid x_{i+1}-x_{i}\mid.$

# 2.6数值微分

在微积分中，函数的导数是由极限来定义的.而且还推导出很多函数求导公

------------------------------------------------------------------

式，若对由表达式表示的函数求导数，使用函数求导公式容易把导数求出来，但若函数用函数表格表示，就不能用函数求导公式求函数导数，这时只能使用近似方法求函数导数

若函数$f(x)$ 用函数表格表示，则使用近似方法求$f($ $x$ ) 的导数称为数值微分. 常用的数值微分方法是使用插值函数，

# 2.7.1使用$n$ 次插值函数求导数

在代数插值理论中，对于给定函数$f(x)$ 如表2-2所示的数据表，可以构造一个$n$ 次插值函数$p_{x}($ $x)$ 来近似代替$f(x)$ ，即有

$$f(\:x\:)=p_{_*}(\:x\:)$$

对上式两边求导得

$$f'(\:x\:)=p'_{*}(\:x\:)$$

由定理2.3可知$, f($ $x$ ) 与$p_n\left(\begin{matrix}x\end{matrix}\right)$ 的误差估计式为
$$R(\:x\:)\:=f(\:x\:)\:-p_{n}(\:x\:)\:=\frac{f^{(\:n\:+\:1)}\:(\:\xi)}{(\:n\:+\:1\:)\:!}\omega(\:x\:)$$

$$,\xi\in\left[\:a\:,b\:\right];\omega(\:x\:)\:=(\:x-x_{0}\:)\:(\:x-x_{1}\:)\cdots(\:x-x_{s}\:)\:.$$

对上式两边求导得$f^{\prime }($ $x$ ) 与$p_{x}^{\prime }($ $x)$ 的误差估计式为

$$R'(x)=f'(x)-p'_{s}(x)=\frac{f^{(n+1)}(\xi)}{(n+1)!}\omega'(x)+\frac{\omega(x)}{(n+1)!}\frac{\mathrm{d}}{\mathrm{d}x}f^{(n+1)}(\xi)$$
(2. 54)

在(2.54)式中，由于$\xi$ 是$x$ 的未知函数，所以无法对（)作进一步的估计.如果只考虑节点$x_k$ 处的导数，并注意到$\omega ($ $x_{\lambda }$ ) =0 ，则

$$R'(\:x_{i}\:)\:=f'(\:x_{i}\:)\:-p'_{n}(\:x_{i}\:)\:=\frac{f^{(n+1)}\:(\:\xi)}{(\:n+1\:)\:!}\omega'(\:x_{i}\:)$$

由于上述原因，下面只讨论节点$x_k$ 处的导数.为了简单起见，假定给出的节点是等距的，并把这个距离记为$h$

2.7.1.1两点公式

根据给定的两点( $x_{0}$ $, y_{0}$ ) ( $x_{0}$ $, y_{0}$ ) ( $x_{0}$ $, y_{0}$ ) ,( $x_{1}$ $, y_{1}$ ) （x,y） ( $x_1$ $, y_1$ ) 可以构造一个线性插值函数

$$p_1\left(x\right)=\frac{x-x_1}{x_0-x_1}y_0\:+\frac{x-x_0}{x_1-x_0}y_1$$

近似代替$f(x)$

对上式两边求导数，并注意到$h=x_{1}-x_{0}$ ，则得

$$p'_1(x)=\frac{1}{h}(y_1-y_0)$$

从而有下面求导公式

------------------------------------------------------------------

$$p_{1}^{\prime}(\:x_{0}\:)\:=\frac{1}{h}(\:y_{1}\:-y_{0}\:)\\p_{1}^{\prime}(\:x_{1}\:)\:=\frac{1}{h}(\:y_{1}\:-y_{0}\:)$$

并有如下误差估计式

$$R'(\:x_0\:)\:=f'(\:x_0\:)\:-p'_1(\:x_0\:)\:=\frac{f''(\:\xi_0\:)}{2\:!}(\:x_0\:-x_1\:)\:=\:-\frac{h}{2}f''(\:\xi_0\:)\:(\:x_0\:<\xi_0\:<x_1\:)$$

$$R'(\:x_1\:)\:=f'(\:x_1\:)\:-p'_1(\:x_1\:)\:=\frac{f''(\:\xi_1\:)}{2\:!}(\:x_1\:-x_0\:)\:=\frac{h}{2}f''(\:\xi_1\:)\:(\:x_0\:<\xi_1\:<x_1\:)$$

2.7.1.2三点公式

对于给定函数$f(x)$ 如表2-5所示的数据表，可以构造一个二次插值函数

$$o_{2}\left(\:x\:\right)\:=\:\frac{\left(\:x-x_{1}\:\right)\left(\:x-x_{2}\:\right)}{\left(\:x_{0}\:-x_{1}\:\right)\left(\:x_{0}\:-x_{2}\:\right)}y_{0}\:+\:\frac{\left(\:x-x_{0}\:\right)\left(\:x-x_{2}\:\right)}{\left(\:x_{1}\:-x_{0}\:\right)\left(\:x_{1}\:-x_{2}\:\right)}y_{1}\:+\:\frac{\left(\:x-x_{0}\:\right)\left(\:x-x_{1}\:\right)}{\left(\:x_{2}\:-x_{0}\:\right)\left(\:x_{2}\:-x_{1}\:\right)}y_{2}$$
近似代替$f(x)$

对上式两边求导得

$$o_{2}^{\prime}\left(x\right)=\frac{2x-x_{1}-x_{2}}{\left(\:x_{0}-x_{1}\:\right)\left(\:x_{0}-x_{2}\:\right)}y_{0}\:+\frac{2x-x_{0}-x_{2}}{\left(\:x_{1}-x_{0}\:\right)\left(\:x_{1}-x_{2}\:\right)}y_{1}\:+\frac{2x-x_{0}-x_{1}}{\left(\:x_{2}-x_{0}\:\right)\left(\:x_{2}-x_{1}\:\right)}y_{2}$$

从而得到下面求导公式

$$\begin{aligned}&p_{2}^{\prime}\left(\:x_{0}\:\right)=\frac{1}{2h}(\:-3y_{0}\:+4y_{1}\:-y_{2}\:)\\&p_{2}^{\prime}\left(\:x_{1}\:\right)=\frac{1}{2h}(\:-y_{0}\:+y_{2}\:)\\&p_{2}^{\prime}\left(\:x_{2}\:\right)=\frac{1}{2h}(\:y_{0}\:-4y_{1}\:+3y_{2}\:)\end{aligned}$$

并有如下误差估计式

$$R'(\:x_0\:)\:=f'(\:x_0\:)\:-p'_2(\:x_0\:)\:=\frac{f''''(\:\xi_0\:)}{3}h^2\quad(\:x_0<\xi_0<x_2\:)$$

$$R'(\:x_1\:)=f'(\:x_1\:)\:-p'_2(\:x_1\:)\:=\:-\frac{f'''(\:\xi_1\:)}{6}h^2\quad(\:x_0<\xi_1<x_2\:)$$

$$R'(\:x_2\:)=f'(\:x_2\:)\:-p'_2(\:x_2\:)\:=\frac{f'''(\:\xi_2\:)}{3}h^2\quad(\:x_0<\xi_2<x_2\:)$$

从上面的数值微分公式及其误差估计式来看，似乎$h$ 越小精度越高，但在实际计算中并不是那么简单.在实际计算中，截断误差只是误差的一部分，还有舍人误差，而数值微分对舍人误差比较敏感，有时候它会随着$h$ 的减小而增大.因此，在使用$n$ 次插值函数求导数时，要注意对误差进行分析

------------------------------------------------------------------

# 2.7.2使用三次样条插值函数求导数

从前面的介绍可以知道，使用$n$ 次插值函数求导不便于计算非节点处的导数值.也不能保证有较小的误差，这时最好使用三次样条插值函数求导数

由三次样条插值知道，可以构造出函数$s(x)$ 来近似代替$f(x)$ ，即有

$$f(x)\approx s(x)$$

而$s($ $x$ ) 在区间$\begin{bmatrix} x_{i}, x_{i+ 1}\end{bmatrix} ( \begin{array} { c } i= 0\end{array} , 1, \cdots , n- 1$ ) 上的表达式为
$$s\left(\:x\:\right)=\left[\begin{array}{c}1+2\:\frac{x-x_i}{h_i}\end{array}\right]\frac{\left(\:x-x_{i+1}\:\right)^2}{h_i^2}y_i+\left[\begin{array}{c}1-2\:\frac{x-x_{i+1}}{h_i}\end{array}\right]\frac{\left(\:x-x_i\:\right)^2}{h_i^2}y_{i+1}\:+$$

$$\left(\begin{array}{c}x-x_i\end{array}\right)\frac{\left(\begin{array}{c}x-x_{i+1}\end{array}\right)^2}{h_i^2}m_i+\left(\begin{array}{c}x-x_{i+1}\end{array}\right)\frac{\left(\begin{array}{c}x-x_i\end{array}\right)^2}{h_i^2}m_{i+1}$$

对$s($ $x$ ) 求导得

$$\begin{aligned}
s^{\prime}\left(x\right)& =\frac{6}{h_{i}^{2}}\bigg[\:\frac{1}{h_{i}}\big(\:x-x_{i+1}\big)^{2}\:+\:\big(\:x-x_{i+1}\big)\:\bigg]\:y_{i}\:+ \\
&\frac{6}{h_{i}^{2}}\bigg[\:(\:x-x_{i}\:)\:-\frac{1}{h_{i}}\big(\:x-x_{i}\:\big)^{2}\bigg]y_{i+1}\:+ \\
&\frac{1}{h_{i}}\bigg[\:\frac{3}{h_{i}}\big(\:x-x_{i+1}\big)^{2}\:+2\big(\:x-x_{i+1}\big)\:\bigg]m_{i}\:- \\
&\frac{1}{h_{i}}\bigg[\:2(\:x-x_{i}\:)\:-\frac{3}{h_{i}}\big(\:x-x_{i}\big)^{2}\bigg]m_{i+1}
\end{aligned}$$

对（2.56）式两边求导就得到近似公式

$$f^{\prime}(x)\approx s^{\prime}(x)$$

若只求函数$f(x)$ 在节点$x_{\mathrm{i} }($ $i= 0$ ,1 $, \cdots , n$ ) 处的导数，则由$f^{\prime}\left(\begin{array}{c}{x_{\mathrm{i}}}\end{array}\right)=m_{\mathrm{i}}$ 可直接得到

如果要求二阶导数$f^{\prime \prime }($ $x$ ) ，则可对(2.57)式两边求导得到
$$\begin{gathered}
s^{\prime\prime}(x) =\frac{6}{h_{i}^{2}}\bigg[\:1+\frac{2}{h_{i}}\big(\:x-x_{i+1}\big)\:\bigg]y_{i}+\frac{6}{h_{i}^{2}}\bigg[\:1-\frac{2}{h_{i}}\big(\:x-x_{i}\big)\:\bigg]y_{i+1}\:+ \\
\frac{1}{h_{i}}\bigg[\:\frac{3}{h_{i}}\big(\:x-x_{i+1}\big)^{2}+1\bigg]m_{i}-\frac{2}{h_{i}}\bigg[\:1-\frac{3}{h_{i}}\big(\:x-x_{i}\big)\:\bigg]m_{i+1} 
\end{gathered}$$

此时，又得到近似公式

$$f^{\prime\prime}(\:x\:)=s^{\prime\prime}(\:x\:)$$

三次样条插值函数$s(x)$ 作为函数$f(x)$ 的近似函数，不仅函数值比较接近，而且导数值也比较接近，当$h=\max_{0\text{ 近}i\text{ 近 }n-1}\mid x_{i+1}-x_{i}\mid\to0$ 时$,s\left(x\right),s^{\prime}\left(x\right),s^{\prime\prime}\left(x\right)$ s"(（x) $s^{\prime \prime }($ $x)$ 分别收敛于$f($ $x$ ) $, f^{\prime }($ $x$ ) $f^{\prime \prime }($ $x$ ) . 但也有缺点，要解方程组，而当$h$ 较小时，解方程组的运算量往往较大

------------------------------------------------------------------

# 练习与思考

1.给定函数$y=\sin x$ 的函数表如表2-21所示，请分别用Lagrange和Newton 插值公式求出$y=\sin x$ 在$x=1.75$ 处的函数近似值，并进行误差估计.

------------------------------------------------------------------

## 表2-21函数表

| x | y = sin(x) |
|-----|-----------|
| 1.74| 0.9857 |
| 1.76| 0.9822 |
| 1.78| 0.9782 |

2.由线性插值的误差估计式(2.3），进一步证明：
$$\mid R(x)\mid\leqslant\frac{\left(\begin{array}{c}x_1-x_0\end{array}\right)^2}{8}\max_{x_0\leq x\leq x_1}\mid f^{\prime\prime}(x)\mid $$

3.给定函数$y= f($ $x)$ 的函数表如表2-22所示，分别用Lagrange插值和Newton 插值构造三次插值多项式，并写出插值余项，

表2-22函数表

| x | 1 | 2 | 4 | 6 |
|---|---|---|---|---|
| y = f(x) | 4 | 1 | 0 | 1 |

4.假设X $x_0$ $x_0$ , $x_1$ , $\cdots$ , $x_u$ x。$x_n$ 是互不相等的插值节点， $l_i\left(\begin{array}{c}x\end{array}\right)$ ( $i$ =0 , 1 , $\cdots$ , $n$ ) 为Lagrange插值基函数，证明：

(1)
$$\begin{aligned}&\sum_{i=0}^{n}\:x_{i}^{k}l_{i}\left(\:x\:\right)\:=x^{k}\quad(\:k=0\:,1\:,\cdots,n\:)\:;\\&\sum_{i=0}^{n}\:\left(\:x_{i}-x\:\right)^{i}l_{i}\left(\:x\:\right)=0\quad\left(\:k=1\:,2\:,\cdots,n\:\right).\end{aligned}$$
(2)

5.证明$n$ 阶差商具有如下性质：

(1)若$F($ $x)$ $= cf($ $x)$ ，则

$$F(\:x_0\:,x_1\:,\cdots,x_n\:)=cf(\:x_0\:,x_1\:,\cdots,x_n\:)\:;$$

(2)若$F($ $x$ ) $= f($ $x$ ) + $g($ $x$ ) ，则

$$F(\:x_0\:,x_1\:,\cdots,x_n\:)=f(\:x_0\:,x_1\:,\cdots,x_n\:)\:+g(\:x_0\:,x_1\:,\cdots,x_n\:)$$

6.给定函数表如表2-23所示，求分段线性插值函数$p($ $x$ ) ，并求$f(2.5)$ 的近似值。

表2-23函数表

| x | 0 | 1 | 3 | 5 |
|---|---|---|---|---|
| y = f(x) | 2 | 3 | 5 | 2 |

7.给定函数$y= f($ $x$ ) 的函数表如表2-24所示，请构造一个三次Hermite 插值函数，并求出f(1.5)的近似值.

------------------------------------------------------------------

表2-24函数表

| x | 1 | 2 |
|---|---|---|
| y = f(x) | 2 | 3 |
| y' = f'(x) | 1 | -1 |

8.求一个次数不高于4次的代数多项式$p($ $x$ ) ，使它满足条件： $p\left(\begin{matrix}{0}\\{0}\\\end{matrix}\right)=p^{\prime}\left(\begin{matrix}{0}\\{0}\\\end{matrix}\right)$ $=0;p(1)=p^{\prime}(1)=1$ 和$p(2)=1$

9.给定函数$y= f($ $x$ ) 的函数表（表2-25）和边界条件$s^{\prime \prime }( 75$ )=0 $, s^{\prime \prime }($ 80 ) =0求三次样条插值函数$s($ $x)$ ，并求f(78.3）的近似值.

表2-25函数表

| x | y = f(x) |
|---|---------|
| 75 | 2.768 |
| 76 | 2.833 |
| 77 | 2.903 |
| 78 | 2.979 |
| 79 | 3.062 |
| 80 | 3.153 |

10.给定函数$y= f($ $x)$ 的函数表如表2-26所示，边界条件$s'(0.25)=1$ $s'(0.53)=0.6868$ ，求三次样条插值函数$s($ $x$ ) ，并求$f(0.35$ 的近似值.

表2-26函数表

| x | y = f(x) |
|------|---------|
| 0.25 | 0.5  |
| 0.3 | 0.5477 |
| 0.39 | 0.6245 |
| 0.45 | 0.6708 |
| 0.53 | 0.728 |

11.已知函数$y=\mathrm{e}^{i}$ 的数据表如表2-27所示，试用两点和三点数值微分公式计算该函数在$x=2.7$ 处的一阶和二阶导数

表2-27函数表

| x | y = e^x |
|---|--------|
| 2.5 | 12.18 |
| 2.6 | 13.46 |
| 2.7 | 14.88 |
| 2.8 | 16.44 |
| 2.9 | 18.17 |

12.已知函数$y= f($ $x)$ 的函数表和边界条件与第10题相同，试使用三次样条插值函数求$y= f($ $x)$ 在$x=0.35$ 处的一阶和二阶导数。