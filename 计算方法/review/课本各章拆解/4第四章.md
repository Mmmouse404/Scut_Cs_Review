# 4数值积分

在微积分中，计算连续函数$f(x)$ 在区间$\left[\begin{smallmatrix}a&b\end{smallmatrix}\right]$ 上的积分通常采用求原函数的方法.也就是说，利用积分的基本公式
$$\int_{a}^{b}f(\:x\:)\:\mathrm{d}x\:=F(\:b\:)\:-F(\:a\:)$$

计算定积分的值.这里的$F($ $x$ ) 为被积函数$f(x)$ 的原函数.但有时$f(x)$ 的原函数无法用初等函数来表示.例如，积分$\int_0^1\frac{\text{sin}x}x$d$x$ 和$\int_0^1\mathrm{e}^{-x^2}$d$x$ 中的被积函数i和$\mathrm{e}^{-x^2}$ 的原函数就不能用初等函数表示出来

在实际中，有些函数是用函数表来表示的，对这种被积函数的积分也不能通过求原函数的方法求得，

另外，计算机只能进行四则运算和逻辑运算，不能进行求原函数的运算，所以在计算机上也无法实现这种方法

这说明用求原函数的方法求定积分的值有很大的局限性，有必要学习求定积分的近似方法.下面介绍一些求定积分的近似方法

# 4.1梯形求积公式、Simpson求积公式和NewtonCotes求积公式

根据代数插值法，对于任一被积函数$f($ $x$ ) ，都可以构造一个插值多项式$p(x)$ 近似代替它，即有

$$f(\:x\:)\approx p(\:x\:)$$

对（4.2）式两边求积分得

$$\int_{a}^{b}f(\:x\:)\:\mathrm{d}x\:=\:\int_{a}^{b}p\:(\:x\:)\:\mathrm{d}x$$

而$p(x)$ 是一个代数多项式，它的定积分容易计算

可以根据这种想法构造出几个近似求积公式

## 4.1.1梯形求积公式

由代数插值法知道，可以以$a$ 和$b$ 作为插值节点构造一个插值多项式

$$p_1(\:x\:)\:=\frac{x-b}{a-b}f(\:a\:)\:+\frac{x-a}{b-a}f(\:b\:)$$

------------------------------------------------------------------

近似代替$f(x)$ ，即有

$$f(\:x\:)=p_{1}\:(\:x\:)$$

对（4.3）式两边求积分得
$$\begin{aligned}
\int_{s}^{s}f(\:x\:)\:\mathrm{d}x& \approx\:\int_{a}^{b}p_{1}\left(x\right)\mathrm{d}x \\
&=\:\int_{a}^{b}\:\left[\:\frac{x-b}{a-b}f(\:a\:)\:+\frac{x-a}{b-a}f(\:b\:)\:\right]\mathrm{d}x \\
&=\frac{b-a}{2}\bigl[f(\:a\:)\:+f(\:b\:)\:\bigr]
\end{aligned}$$

(4.4）式是一个计算定积分的近似公式，又称为梯形求积公式.它的几何意义如图4-1所示.

![](https://storage.simpletex.cn/view/f3DQW8ge5uMXheGShlvMuoanFmBIEA55T)

从图4-1可以看到，梯形求积公式的几何意义是用梯形区域的面积来代替曲边梯形区域的面积.

## 4.1.2Simpson求积公式

图4-1梯形求积公式的几何意义把积分区间$\left[\begin{smallmatrix}a&b\end{smallmatrix}\right]$ 二等分，得到三个分点a $,\frac{a+b}2$ 和6.根据代数插值法，可以以这三个分点作为插值节点，构造一个插值多项式

$$\begin{aligned}
p_{2}\left(x\right)& =\frac{\left\lfloor\begin{array}{c}x-\frac{a+b}{2}\end{array}\right\rfloor\left(\begin{array}{c}x-b\end{array}\right)}{\left\lfloor\begin{array}{c}a-\frac{a+b}{2}\end{array}\right\rfloor\left(\begin{array}{c}a-b\end{array}\right)}f(\begin{array}{c}a\end{array})\:+\frac{\left(\begin{array}{c}x-a\end{array}\right)\left(\begin{array}{c}x-b\end{array}\right)}{\left\lfloor\begin{array}{c}a+b\\2\end{array}\right\rfloor\left\lfloor\begin{array}{c}a+b\\2\end{array}\right\rfloor}f\left[\begin{array}{c}a+b\\2\end{array}\right]\:+  \\
&\frac{(\:x-a\:)\left[\:x-\frac{a+b}{2}\right]}{(\:b-a\:)\left[\:b-\frac{a+b}{2}\right]}f(\:b\:)
\end{aligned}$$

近似代替$f(x)$ ，即有

$$f(\:x\:)=p_{2}\:(\:x\:)$$

对（4.5）式两边求积分得
$$\begin{gathered}
\text{(11-2) avraxnmnnnnnn} \\
\int_{a}^{b}f(\:x\:)\:\mathrm{d}x\:\approx\:\int_{a}^{b}p_{2}(\:x\:)\:\mathrm{d}x \\
=\:\int_{a}^{b}\left[\:\frac{\left\lfloor\:x\:-\:\frac{a\:+\:b}{2}\right\rfloor(\:x\:-\:b\:)}{\left\lfloor\:a\:-\:\frac{a\:+\:b}{2}\right\rfloor(\:a\:-\:b\:)}f(\:a\:)\:+\:\frac{\left(\:x\:-\:a\:\right)(\:x\:-\:b\:)}{\left\lfloor\:\frac{a\:+\:b}{2}\:-\:a\:\right\rfloor\left\lfloor\:\frac{a\:+\:b}{2}\:-\:b\:\right\rfloor}f\left\lfloor\:\frac{a\:+\:b}{2}\right\rfloor\right] 
\end{gathered}$$

------------------------------------------------------------------

$$+\frac{(\:x\:-\:a\:)\left[\:x\:-\:\frac{a\:+\:b}{2}\right]}{(\:b\:-\:a\:)\left[\:b\:-\:\frac{a\:+\:b}{2}\right]}f(\:b\:)\:\mathrm{d}x$$

$$=\frac{b\:-\:a}{6}\Big[\:f(\:a\:)\:+4f\Big[\:\frac{a\:+\:b}{2}\Big]+f(\:b\:)\:\Big]$$

（4.6）式也是一个计算定积分的近似公式，又称为Simpson或抛物线求积公式.它的几何意义如图4-2所示

![](https://storage.simpletex.cn/view/fxAlDdzNlkiyIX1Derv6dkxeYzwgagTQw)

4.1.3Newton-Cotes求积公式

把积分区间$\left[\begin{smallmatrix}a&b\end{smallmatrix}\right]n$ 等分，得到$n+1$ 个分点，其分点记为$x_i= a$ $+ ih\left ( \:i= 0\:, 1\:, \cdots , n\:\right )$

其中$h=\frac{b-a}n$ 由代数插值法知道,可以以这图4-2 Simpson 求积公式的几何意义$n+1$ 个分点作为插值节点，构造一个插值多

项式

$$p_{_n}(\:x\:)\:=\:\sum_{i=0}^{*}\:\frac{\omega(\:x\:)}{(\:x\:-\:x_{i}\:)\:\omega^{\prime}(\:x_{i}\:)}f(\:x_{i}\:)$$

近似代替$f(x)$ ,其中$\omega ( x) = ($ $x- x_{0}$ )( $x- x_{1}$ $) \cdots ($ $x- x_{n}$ ). 即有
$$f(\:x\:)=p_{_*}(\:x\:)$$

对（4.7)式两边求积分得
$$\begin{aligned}
&\text{PVITALLINVINNIN} \\
&\int_{a}^{b}f(\:x\:)\:\mathrm{d}x&& \approx\:\int_{a}^{b}p_{a}\left(\:x\:\right)\mathrm{d}x\:=\:\int_{a}^{b}\frac{\omega(\:x\:)}{\left(\:x-x_{i}\:\right)\omega^{\prime}\left(\:x_{i}\:\right)}f(\:x_{i}\:)\:\mathrm{d}x  \\
&&&=\:\sum_{i=0}^{\infty}\:\left[\:\int_{s}^{s}\frac{\omega(x)}{(\:x-x_{i}\:)\:\omega^{\prime}(\:x_{i}\:)}\mathrm{d}xf(\:x_{i}\:)\:\right] \\
&&& =\:\sum_{i=0}^{*}\:A_{i}f(\:x_{i}\:)  \\
&\text{1}
\end{aligned}$$

其中$A_{i}=\int_{a}^{b}\frac{\mathbf{\omega}(\:x)}{\left(\:x-x_{i}\:\right)\mathbf{\omega}^{\prime}(\:x_{i}\:)}$d$x.$

现在的问题是如何求$A_{i}.$ 为了求$A_i$ 、作变换$x=a+th$ ，从而得
$$\begin{aligned}
&\omega(\:x\:) \\
&&&=h^{n+1}t(\:t-1\:)\cdots(\:t-n\:) \\
&x-x_{i}=a+th-(\:a+ih\:)\:=(\:t-i\:)\:h \\
&&&\left(\:x_{i}\:\right)=\left(\:x_{i}-x_{0}\:\right)\left(\:x_{i}-x_{1}\:\right)\cdots\left(\:x_{i}-x_{i-1}\:\right)\left(\:x_{i}-x_{i+1}\:\right)\cdots\left(\:x_{i}-x_{n}\:\right) \\
&&&=ih\left(\:i-1\:\right)h\cdots h\left(\:-h\:\right)\left(\:-2h\:\right)\cdots\left[\:-\left(\:n-i\right)\:\right]h \\
&&&=\left(\begin{array}{c}{-1}\end{array}\right)^{n-i}h^{n}i!\:\left(\begin{array}{c}{n-i}\end{array}\right)!
\end{aligned}$$

------------------------------------------------------------------

于是

$$\begin{aligned}
&\text{A} {}_{i}\:=\:\int_{a}^{b}{\frac{\omega(\:x\:)}{(\:x\:-\:x_{i}\:)\:\omega^{\prime}(\:x_{i}\:)}}\mathrm{d}x \\
&\frac{x=a+th}{n*\:i!\:(\:n-i)}\int_{0}^{n}\frac{t(\:t\:-\:1\:)\cdots(\:t\:-\:n\:)}{t\:-\:i}\mathrm{d}t \\
&&c_{i}^{(n)}={\frac{\left(\begin{array}{c}{-1}\end{array}\right)^{n-i}}{n*\:i!\:(\begin{array}{c}{n-i}\end{array})}}\int_{0}^{*}{\frac{t\left(\begin{array}{c}{t-1}\end{array}\right)\cdots\left(\begin{array}{c}{t-n}\end{array}\right)}{t-i}}\mathrm{d}t
\end{aligned}$$

若记

则有$A_{i}= ($ $b- a$ $) c_{i}^{( n) }$ ，从而

$$\int_{a}^{b}f(\:x\:)\:\mathrm{d}x\:=\:\int_{a}^{b}p_{*}(\:x\:)\:\mathrm{d}x\:=\:\sum_{i=0}^{n}\:(\:b-a\:)\:c_{i}^{(n)}f(\:x_{i}\:)$$

(4.9)式称为Newton- Cotes( 牛顿-柯特斯)公式， $c_i^{(\text{ a })}$ 称为Newton-Cotes系数.

可以看出， $c_i^{(\:n\:)}$ 仅依赖于$n$ 和$i$ ，也就是说仅依赖于$n$ 和$x_i$ ，而不依赖于被积函数$f(x)$ 和积分区间$\left[\begin{smallmatrix}a,b\end{smallmatrix}\right]$ .而$n$ 和$i$ 都是整数，从而$c_i^{(\mathrm{~a~})}$ 是一个常数，这个常数可以预先计算出来构成Newton－Cotes系数表.在计算时，可以查Newton- Cotes 系数表得到Newton- Cotes 系数$c_i^{(n)}$ ，而不用求积分. $n$ 从1到6取值的Newton- Cotes 系数见表4-1.

表4-1 $n$ 从1到6的Newton-Cotes 系数表

| $n$ | $c_{0}^{(n)}$ | $c_{1}^{(n)}$ | $c_{2}^{(n)}$ | $c_{3}^{(n)}$ | $c_{4}^{(n)}$ | $c_{5}^{(n)}$ | $c_{6}^{(n)}$ |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 1 | $\frac{1}{2}$ | $\frac{1}{2}$ | | | | | |
| 2 | $\frac{1}{6}$ | $\frac{4}{6}$ | $\frac{1}{6}$ | | | | |
| 3 | $\frac{1}{8}$ | $\frac{3}{8}$ | $\frac{3}{8}$ | $\frac{1}{8}$ | | | |
| 4 | 7 | 90 | 16 | 45 | 2 | 45 | 90 |
| 5 | 19 | 288 | 25 | 96 | 25 | 144 | 25 |
| 6 | 41 | 840 | 9 | 35 | 105 | 280 | 35 |

例4-1用梯形求积公式、Simpson求积公式和Newton- Cotes 求积公式（取$n$ =4 )计算定积分[，Edx.

解$\textcircled{1}$ 用梯形求积公式：

$$\int_{0.5}^{1}\sqrt{x}\mathrm{d}x\:\approx\:\frac{0.5}{2}(\:\sqrt{0.5}\:+\:1\:)\:=\:0.426\:8$$

$\textcircled{2}$ 用Simpson求积公式：

------------------------------------------------------------------

$$\int_{0.5}^{1}\sqrt{x}\mathrm{d}x\:\approx\:\frac{0.5}{6}(\quad0.5\:+\:4\quad0.75\:+\:1\:)\:\approx\:0.430\:9$$
$\textcircled{3}$ 用Newton-Cotes求积公式：
$$\begin{aligned}
&\int_{a}^{b}f(\:x\:)\:\mathrm{d}x\:\approx\:(\:b\:-\:a\:)\:\sum_{i=0}^{a}c_{i}^{(n)}f(\:x_{i}\:) \\
&\int_{0.5}^{1}\:\sqrt{x}\mathrm{d}x\:=\:0.5\sum_{i=0}^{4}c_{i}^{(4)}\:\sqrt{x_{i}} \\
&&&=\:0.5\:{\frac{7}{90}}\quad{\overline{0.5}}\:+{\frac{16}{45}}\quad{\overline{0.625}}\:+{\frac{2}{15}}\quad{\overline{0.75}}\:+ \\
&&&\frac{16}{45}\quad0.875\:+\frac{7}{90}\:\sqrt{1}\:\approx0.431\:0
\end{aligned}$$

# 4.2求积公式的代数精确度

定义4.1对一般求积近似公式，如果当$f($ $x$ ) 为任意一个次数不高于$n$ 次的代数多项式时，积分近似公式

$$\int_{a}^{b}f(\:x\:)\:\mathrm{d}x\:\approx\:\sum_{i=0}^{\infty}A_{i}f(\:x_{i}\:)$$

精确成立，而当$f(x)$ 为$n+1$ 次代数多项式时不精确成立，则称该积分近似公式具有$n$ 次代数精确度

从代数精确度的定义可知，求积近似公式的精确度越高，就会有越多的$f(x)$ 使求积近似公式精确成立，

由于任何一个求积近似公式都可以写成（4.10）式的形式，从而可以使用代数精确度的定义来证明求积公式具有多少次代数精确度，

定理4.1梯形求积公式具有一次代数精确度，

证明$\textcircled{1}$ 证明当$f(x)$ 为任意一个不超过一次代数多项式时，梯形求积公式精确成立.

在推导梯形求积公式时，以$a$ 和$b$ 作为插值节点构造出$p_{1}\left(\begin{array}{c}x\end{array}\right)$ ，用$p_{1}\left(\begin{array}{c}x\end{array}\right)$ 近似代替$f(x)$ ，即有

$$f(x)\approx p_{1}(x)$$

根据插值的误差估计式有

$$f(\:x\:)\:-\:p_{1}\:(\:x\:)\:=\frac{f^{\prime\prime}(\:\xi)}{2\:!}(\:x\:-\:a\:)\:(\:x\:-\:b\:)$$

对(4.11)式从$a$ 到$b$ 求积分得

$$\int_{a}^{b}f(\:x\:)\:\mathrm{d}x\:-\:\int_{a}^{b}p_{1}\:(\:x\:)\:\mathrm{d}x\:=\:\int_{a}^{b}\frac{f^{\prime\prime}(\:\xi\:)}{2\:!}(\:x\:-\:a\:)\:(\:x\:-\:b\:)\:\mathrm{d}x$$

------------------------------------------------------------------

即

$$\int_0^bf(\:x\:)\:\mathrm{d}x\:-\:\frac{b\:-\:a}{2}[\:f(\:a\:)\:+f(\:b\:)\:]\:=\:\int_0^b\frac{f^{\prime\prime}(\:\xi)}{2\:!}(\:x\:-\:a\:)\:(\:x\:-\:b\:)\:\mathrm{d}x$$

显然，当$f(x)$ 为不超过一次代数多项式时$,f^{\prime\prime}(\xi)=0$ .所以

$$\int_{x}^{b}f(\:x\:)\:\mathrm{d}x\:=\:\frac{b\:-\:a}{2}[f(\:a\:)\:+f(\:b\:)\:]$$

也就是说，当$f(x)$ 为不超过一次代数多项式时，梯形求积公式精确成立，

$\textcircled{2}$ 证明当$f(x)$ 为二次代数多项式时，梯形求积公式不精确成立，

因为当$f($ $x)$ $= x^{2}$ 时，有

$$\int_a^bf(\:x\:)\:\mathrm{d}x\:=\:\int_a^bx^2\:\mathrm{d}x\:=\:\frac{b^3\:-\:a^3}{3}$$

$$\frac{b-a}{2}[f(\:a\:)\:+f(\:b\:)\:]=\frac{b-a}{2}(\:a^{^2}+b^{^2})$$

所以当$f($ $x$ ) = $x^{2}$ 时，

$$\int_{a}^{b}f(\:x\:)\:\mathrm{d}x\:\neq\:\frac{b\:-\:a}{2}[f(\:a\:)\:+f(\:b\:)\:]$$

由此推出，当$f(x)$ 为二次代数多项式时

$$\int_{x}^{b}f(\:x\:)\:\mathrm{d}x\:\neq\:\frac{b\:-\:a}{2}[f(\:a\:)\:+f(\:b\:)\:]$$

因此，梯形求积公式具有一次代数精确度，

从定理4.1可知，当被积函数为不超过一次代数多项式时，用梯形求积公式求积分是没有误差的，

定理4.2Newton-Cotes求积公式至少具有$n$ 次代数精确度.当$n$ 为偶数时， 代数精确度至少为$n+1$ 次

证明$\textcircled{1}$ 证明Newton- Cotes 求积公式至少具有$n$ 次代数精确度

在推导Newton- Cotes 求积公式时，以$x_0$ $, x_1$ $, \cdots$ $, x_n$ 为插值节点构造插值多项式$p_u\left(\begin{matrix}x\end{matrix}\right)$ ，用$p_x($ $x$ ) 代替$f(x)$ ，即$f($ $x$ $) = = p_{x}\left ( \:x\:\right )$ 、根据插值的误差估计式有

$$f(\:x\:)\:-p_{s}(\:x\:)\:=\frac{f^{(n+1)}\:(\:\xi\:)}{(\:n+1\:)\:!}\omega(\:x\:)$$

其中$\omega ( x) = ($ $x- x_{0}$ )( $x- x_{1}$ $) \cdots ($ $x- x_{x}$ ) .对(4.13)式两边从$a$ 到$b$ 求积分得
$$\int_{a}^{b}f(\:x\:)\:\mathrm{d}x\:-\:\int_{a}^{b}p_{n}(\:x\:)\:\mathrm{d}x\:=\:\int_{a}^{b}\frac{f^{(s+1)}(\:\xi)}{(\:n\:+\:1\:)\:!}\omega(\:x\:)\:\mathrm{d}x$$

由（4.9）式得

$$\int_{a}^{b}f(\:x\:)\:\mathrm{d}x\:-\:\sum_{i=0}^{n}\:(\:b\:-\:a\:)\:c_{i}^{(n)}f(\:x_{i}\:)\:=\:\int_{a}^{b}\frac{f^{(n+1)}\:(\:\xi)}{(\:n\:+\:1\:)\:!}\omega(\:x\:)\:\mathrm{d}x$$

显然，当$f(x)$ 为任意不超过$n$ 次代数多项式时$f^{( \:x+ 1) }($ $\xi ) = 0.$ 所以

------------------------------------------------------------------

$$\int_{a}^{b}f(\:x\:)\:\mathrm{d}x\:=\:\sum_{i=0}^{n}(\:b\:-\:a\:)\:c_{i}^{(n)}f(\:x_{i}\:)$$

这说明， , Newton-Cotes 求积公式至少具有$n$ 次代数精确度，

$\textcircled{2}$ 证明当$n$ 为偶数时， Newton- Cotes 求积公式的代数精确度至少为$n+1$ 次

设$f(x)$ 为$n+1$ 次代数多项式，则可令$f( x)$ = $\sum _{\epsilon = 0}^{\kappa + 1}b_{k}x^{k}$ ,其中$n$ 为偶数，从而有

$$\begin{array}{rcl}f^{(n+1)}(\:x\:)&=&(\:b_{0}\:+\:b_{1}\:x\:+\:\cdots\:+\:b_{n}\:x^{n}\:+\:b_{n+1}\:x^{n+1}\:)^{(\:n+1\:)}&=\:b_{n+1}\:(\:n\:+\:1\:)\:!\\&&f^{(n+1)}(\:\xi)&=\:b_{n+1}\:(\:n\:+\:1\:)\:!\end{array}$$

故

再据（4.14)式有
$$\begin{aligned}
&\int_{x}^{b}f(\:x\:)\:\mathrm{d}x\:-\:\sum_{i=0}^{n}\:(\:b\:-\:a\:)\:c_{i}^{(n)}f(\:x_{i}\:) =\:\int_{s}^{b}\frac{f^{(s+1)}\left(\xi\right)}{\left(\:n\:+\:1\:\right)!}\omega(\:x\:)\:\mathrm{d}x \\
&=\:b_{n+1}\int_{a}^{b}\omega(\:x\:)\:\mathrm{d}x \\
&=\:b_{n+1}\int_{0}^{b}\left(\:x\:-\:x_{0}\:\right)\left(\:x\:-\:x_{1}\:\right)\cdots\left(\:x\:-\:x_{n}\:\right)\mathrm{d}x \\
&\frac{x\:=\:a\:+\:th}{---------------------------------------------------------------------------------------------}
\end{aligned}$$

因为$n$ 为偶数，可令$n= 2k$ $, k= 1$ ,2 $, \cdots .$ 此时，

$$\begin{aligned}
&\int_{0}^{n}t(\:t-1\:)\:(\:t-2\:)\cdots(\:t-n\:)\:\mathrm{d}t \\
&=\int_{0}^{2k}t(\:t\:-\:1\:)\cdots(\:t\:-\:k\:)\left[\:t\:-\:(\:k\:+\:1\:)\:\right]\cdots\left[\:t\:-\:(\:2k\:-\:1\:)\:\right](\:t\:-\:2k\:)\:\mathrm{d}t \\
&\begin{array}{rcl}{u\:=\:t\:-\:k}&{\int_{-k}^{k}(\:u\:+\:k\:)\:(\:u\:+\:k\:-\:1\:)\cdots u(\:u\:-\:1\:)\cdots(\:u\:-\:k\:+\:1\:)\:(\:u\:-\:k\:)\:\mathrm{d}u}\\\end{array}
\end{aligned}$$

令$H(u)=(u+k)(u+k-1)\cdots u(u-1)\cdots(u-k+1)(u-k)$ ，则有$H($ $- u$ ) = $- H$ $(u)$ ，即$H(u)$ 为奇函数.于是

$$\int_0^nt(\:t\:-\:1\:)\:(\:t\:-\:2\:)\cdots(\:t\:-\:n\:)\:\mathrm{d}t\:=\:0$$

所以，当$f(x)$ 为$n+1$ 次代数多项式，且$n$ 为偶数时，有

$$\int_{a}^{b}f(\:x\:)\:\mathrm{d}x\:=\:\sum_{i=0}^{n}\:(\:b\:-\:a\:)\:c_{i}^{(n)}f(\:x_{i}\:)$$

这说明，当$n$ 为偶数时， Newton - Cotes 求积公式的代数精确度至少为$n+1$ 次.

从定理4.2可知，当被积函数为不超过$n$ 次代数多项式时，用Newton-Cotes 求积公式求积分是没有误差的.

定理4.3Simpson求积公式的代数精确度为3

证明由定理4.2知，Simpson求积公式的代数精确度至少为3次

------------------------------------------------------------------

现取$f($ $x$ ) $= x^{4}$ ,则由(4.1)式有

$$\int_{a}^{b}f(\:x\:)\:\mathrm{d}x\:=\:\int_{a}^{b}x^{4}\:\mathrm{d}x\:=\:\frac{b^{5}\:-\:a^{5}}{5}$$

$$\frac{b-a}{6}\Big[\:f(\:a\:)\:+4f\Big[\:\frac{a\:+\:b}{2}\Big]+f(\:b\:)\Big]\:=\:\frac{b\:-\:a}{6}\Big[\:a^4\:+\:4\Big[\:\frac{a\:+\:b}{2}\Big]^4\:+\:b^4\Big]$$

而

从而

$$\int_{a}^{b}f(\:x\:)\:\mathrm{d}x\neq\frac{b\:-\:a}{6}\Big[\:f(\:a\:)\:+\:4f\Big[\:\frac{a\:+\:b}{2}\Big]+f(\:b\:)\:\Big]$$

由此推知，当$f(x)$ 为4次代数多项式时

$$\int_a^bf(\:x\:)\:\mathrm{d}x\neq\frac{b\:-\:a}{6}\Big[\:f(\:a\:)\:+\:4f\Big[\:\frac{a\:+\:b}{2}\Big]+f(\:b\:)\:\Big]$$

这说明，当$f(x)$ 为4次代数多项式时， Simpson 求积公式不能精确成立.因此， Simpson求积公式的代数精确度为3.

从定理4.3可知，当被积函数为不超过3次代数多项式时，用Simpson 求积公式求积分是没有误差的，

## 4.3梯形求积公式和Simpson求积公式的误差估计

定理4.4若$f($ $x$ ) $\in$ $C^{2}$ [ $a$ $, b$ ] ，则梯形求积公式有误差估计

$$\int_{a}^{b}f(\:x\:)\:\mathrm{d}x\:-\frac{b\:-\:a}{2}[\:f(\:a\:)\:+f(\:b\:)\:]\:=-\:\frac{(\:b\:-\:a\:)^{\:3}}{12}f^{\prime\prime}(\:\eta)$$

其中$a\leqslant\eta\leqslant b$

证明据（4.12）式

$$\int_a^bf(\:x\:)\:\mathrm{d}x\:-\:\frac{b\:-\:a}{2}[\:f(\:a\:)\:+f(\:b\:)\:]\:=\:\int_a^b\frac{f^{\prime\prime}(\:\xi\:)}{2}(\:x\:-\:a\:)\:(\:x\:-\:b\:)\:\mathrm{d}x$$

因为$\xi$ 依赖于$x$ ，所以$f^{\prime\prime}(\xi)$ 是$x$ 的函数.根据题意$f^{\prime\prime}(\xi)$ 在$\left[\begin{smallmatrix}a,b\end{smallmatrix}\right]$ 上连续，而$\left(\begin{matrix}x-a\end{matrix}\right)\left(\begin{matrix}x-b\end{matrix}\right)$ 在$\left[\begin{smallmatrix}a,b\end{smallmatrix}\right]$ 上小于0，从而由积分中值定理可知在$\left[\begin{smallmatrix}a,b\end{smallmatrix}\right]$ 上存在一点$\eta$ ，使

$$\begin{aligned}
\int_{a}^{b}{\frac{f^{\prime\prime}(\xi)}{2}}(\:x\:-\:a\:)\:(\:x\:-\:b\:)\:\mathrm{d}x& =f^{\prime\prime}(\:\eta)\int_{0}^{0}(\:x\:-\:a\:)\:(\:x\:-\:b\:)\:\mathrm{d}x  \\
&=-\:\frac{\left(\:b\:-\:a\:\right)^{3}}{12}f^{\prime\prime}(\:\eta)
\end{aligned}$$

于是，得到梯形求积公式的误差估计为

$$\int_{a}^{b}f(\:x\:)\:\mathrm{d}x\:-\:\frac{b\:-\:a}{2}[f(\:a\:)\:+f(\:b\:)\:]\:=-\:\frac{(\:b\:-\:a\:)^{3}}{12}f^{\prime\prime}(\:\eta)$$

其中$a\leqslant\eta\leqslant b$

------------------------------------------------------------------

定理4.5若$f($ $x$ ) $\in$ $C^{4}$ [ $a$ $, b$ ] ，则Simpson求积公式有误差估计

$$\int_{0}^{b}f(\:x\:)\:\mathrm{d}x-\frac{b-a}{6}\Big[\:f(\:a\:)\:+4f\Big[\:\frac{a+b}{2}\Big]\:+f(\:b\:)\Big]\:=\:-\frac{(\:b-a\:)}{2\:880}f^{(\:4\:)}\:(\:\eta\:)$$

其中$a\leqslant\eta\leqslant b$

证明首先考虑构造一个三次插值多项式$p_3\left(\begin{matrix}x\end{matrix}\right)$ 满足条件： $p_{3}( a)$ $= f( \begin{array} { c } a\end{array} )$ 可以证明，满足上
$$p_3\left(\:b\:\right)\:=f(\:b\:)\:,p_3\bigg[\:\frac{a\:+\:b}{2}\bigg]\:=f\bigg[\:\frac{a\:+\:b}{2}\bigg]\:\text{和}\:p'\:,\bigg[\:\frac{a\:+\:b}{2}\bigg]\:=\:f'\bigg[\:\frac{a\:+\:b}{2}\bigg]\:.$$
述条件的$p_3($ $x)$ 与$f(x)$ 的误差为

$$f(\:x\:)\:-\:p_{3}(\:x\:)\:=\frac{f^{(4)}\:(\:\xi)}{4\:!}(\:x\:-\:a\:)\left[\:x\:-\frac{a\:+\:b}{2}\right]^{2}(\:x\:-\:b\:)$$

其中$a\leqslant\xi\leqslant b$

对(4.17)式两边求积分得
$$\int_a^bf(\:x\:)\:\mathrm{d}x\:-\:\int_a^bp_3\:(\:x\:)\:\mathrm{d}x\:=\:\frac{1}{4\:!}\:\int_a^bf^{(\:4\:)}\:(\:\xi\:)\:(\:x\:-\:a\:)\:\left[\:x\:-\:\frac{a\:+\:b}{2}\right]^2\:(\:x\:-\:b\:)\:\mathrm{d}x$$

又因$p_{3}(x)$ 为三次代数多项式，而Simpson 求积公式的代数精确度为3，所以有

$$\begin{aligned}
\int_{0}^{t}p_{3}\left(\:x\:\right)\mathrm{d}x& =\frac{b\:-\:a}{6}\Big[\:p_{3}(\:a\:)\:+\:4p_{3}\Big[\:\frac{a\:+\:b}{2}\Big]+\:p_{3}(\:b\:)\:\Big] \\
&=\:\frac{b\:-\:a}{6}\Big[\:f(\:a\:)\:+\:4f\Big[\:\frac{a\:+\:b}{2}\Big]+f(\:b\:)\:\Big]
\end{aligned}$$

从而有

$$\begin{aligned}\int_{a}^{b}f(\:x\:)\:\mathrm{d}x&-\frac{b-a}{6}\bigg[\:f(\:a\:)\:+4f\bigg[\:\frac{a+b}{2}\bigg]\:+f(\:b\:)\:\bigg]\\&=\frac{1}{4!}\int_{a}^{b}f^{(4)}\left(\:\xi\:\right)\left(\:x-a\:\right)\left[\:x-\frac{a+b}{2}\right]^{2}\left(\:x-b\:\right)\mathrm{d}x\end{aligned}$$

据题设$,f^{(4)}$ （专）在$[\begin{smallmatrix}a&b\end{smallmatrix}]$ 上连续,而( $x- a$ ) $\left [ \:x- \frac {a+ b}2\right ] ^{2}($ $x- b$ $) \leqslant 0$ ，由积分中值定理可知，在$\left[\begin{smallmatrix}a,b\end{smallmatrix}\right]$ 中存在一点η ，使

$$\begin{aligned}
&\text{141111111111} \\
&\int_{a}^{b}f^{(4}&& (\:\xi)\:(\:x-a\:)\:\left[\:x-\frac{a+b}{2}\right]^{2}\:(\:x-b\:)\:\mathrm{d}x  \\
&&&=f^{(\:4\:)}\left(\:\eta\right)\:\int_{0}^{b}\:\left(\:x-a\:\right)\left[\:x-\frac{a+b}{2}\right]^{2}\left(\:x-b\:\right)\mathrm{d}x \\
&&&=\:-\frac{\left(\:b-a\right)^{5}}{120}f^{(4)}\left(\:\eta\right)
\end{aligned}$$

因此

$$\int_{a}^{b}f(\:x\:)\:\mathrm{d}x\:-\frac{b\:-\:a}{6}\Big[\:f(\:a\:)\:+\:4f\Big[\:\frac{a\:+\:b}{2}\Big]+f(\:b\:)\:\Big]$$

------------------------------------------------------------------

$$\begin{aligned}
&=\frac{1}{4\:!}\bigg[\:-\frac{\left(\:b-a\:\right)^{5}}{120}f^{(4)}\left(\:\eta\right)\bigg] \\
&=\:-\frac{\left(\:b-a\:\right)^{5}}{2\:880}f^{(4)}\left(\:\eta\right)
\end{aligned}$$

# 4.4复化求积公式

在4.1节中介绍了梯形求积公式、Simpson求积公式和Newton- Cotes 求积公式.从梯形求积公式和Simpson求积公式的几何意义来看，使用它们求积分会产生较大的误差，而使用Newton- Cotes 公式似乎当$n$ 越大，计算出来的结果与积分准确值的误差就会越小.但事实并非如此，可以证明，当$n\to\infty$ 时，并非对所有的$f(x)$ ，都有

$$\int_a^bf(\:x\:)\:\mathrm{d}x\:-\:\sum_{i=0}^n\:(\:b\:-\:a\:)\:c_i^{(\:*\:)}f(\:x_i\:)\:\to\:0$$

这说明Newton- Cotes 求积公式的收敛性对某些被积函数$f(x)$ 得不到保证.另一方面，还可以证明当$n\geqslant8$ 时， Newton-Cotes 求积公式的稳定性也得不到保证

基于上述两个原因，在实际使用Newton -Cotes 求积公式计算定积分时，不能通过盲目加大$n$ 以达到提高精度的目的.

为了提高积分近似公式的精度，可以使用复化公式.本节介绍两个复化公式： 一个是复化梯形求积公式，另一个是复化Simpson 求积公式.

# 4.4.1复化梯形求积公式及其误差估计

把积分区间[ $a$ $, b$ $] _n$ 等分，得到$n+1$ 个分点X $x_0$ $x_0$ $, x_1$ $, \cdots$ $, x_i$ $, \cdots , x_n$ ,其中$x_{\lambda}=a+$ kh: $; k= 0$ ,1 $, \cdots , n$ $; h= ($ $b- a$ $) / n$ ，使用这些分点把$\left[\begin{smallmatrix}a&b\end{smallmatrix}\right]$ 分为$n$ 个小区间$\left[\begin{smallmatrix}x_0,x_1\end{smallmatrix}\right]$ ， $\left[\begin{matrix}x_1,x_2\end{matrix}\right],\cdots,\left[\begin{matrix}x_{n-1},x_n\end{matrix}\right].$ 据定积分的性质和梯形求积公式(4.4)得

$$\begin{aligned}
\int_{a}^{b}f(\:x\:)\:\mathrm{d}x& =\:\int_{x_{0}}^{x}f(\:x\:)\:\mathrm{d}x\:+\:\int_{x_{1}}^{x}f(\:x\:)\:\mathrm{d}x\:+\:\cdots\:+\:\int_{x_{n-1}}^{x}f(\:x\:)\:\mathrm{d}x  \\
&=\:\sum_{\epsilon=0}^{\kappa-1}\int_{\kappa_{k}}^{\kappa+1}f(\:x\:)\:\mathrm{d}x \\
&\approx\:\sum_{\epsilon=0}^{\kappa-1}\:\frac{x_{k+1}\:-\:x_{k}}{2}[\:f(\:x_{k}\:)\:+f(\:x_{k+1}\:)\:] \\
&=\:\frac{h}{2}\sum_{k=0}^{n-1}\left[\:f(\:x_{k}\:)\:+f(\:x_{k+1}\:)\:\right] \\
&=\:\frac{h}{2}\Big[\:f(\:a\:)\:+f(\:b\:)\:+2\sum_{i=0}^{n-1}f(\:a\:+\:kh\:)\:\Big]
\end{aligned}$$

（4.18）式称为复化梯形求积公式，记为$T_n$ .其中$n$ 表示等分数

------------------------------------------------------------------

使用复化梯形公式求积分算法

![](https://storage.simpletex.cn/view/fMXF2Eu9Gg40ycwlGrHPQMl345rhGxq4o)

定理4.6若$f($ $x$ ) $\in$ $C^{2}$ [ $a$ $, b$ ] ，则对复化梯形求积公式$T_n$ ，有

$$\int_{x}^{b}f(\:x\:)\:\mathrm{d}x\:-\:T_{n}\:=-\:\frac{b\:-\:a}{12}h^{2}f^{\prime\prime}(\:\eta)$$

其中$h=\frac{b-a}n,a\leqslant\eta\leqslant b$

证明把积分区间[ $a, b$ $] _n$ 等分，得到分点X0 $x_0$ $x_0$ $, x_1$ $, \cdots , x_n$ ，使用这些分点把[ $a$ $b$ ] 分为$n$ 个小区间$\left[\begin{smallmatrix}x_0,x_1\end{smallmatrix}\right]$ $\left[\begin{smallmatrix}x_0,x_1\end{smallmatrix}\right]$ [x,x] $\left[\begin{smallmatrix}x_1,x_2\end{smallmatrix}\right]$ $\left[\begin{array}{c}x_0,x_1\end{array}\right],\left[\begin{array}{c}x_1,x_2\end{array}\right],\cdots,\left[\begin{array}{c}x_{n-1},x_n\end{array}\right]$ [x-1x] $\cdots,\left[x_{n-1},x_{n}\right]$ ，在这些小区间上直接使用梯形求积公式的误差估计式（4.15），得

$$\begin{aligned}
\text{QHJ DVAL IFITIFV} \\
\int_{a}^{b}f(\:x\:)\:\mathrm{d}x\:-\:T_{a}& =\:\sum_{k=0}^{n-1}\Big[\:\int_{x_{k}}^{k+1}f(\:x\:)\:\mathrm{d}x\:-\:\frac{h}{2}\Big[\:f(\:x_{k}\:)\:+f(\:x_{k+1}\:)\:\Big]\Big] \\
&=-\:\frac{h^{3}}{12}\sum_{i=0}^{*-1}f^{\prime\prime}(\:\eta_{i}\:)
\end{aligned}$$

其中$x_{\lambda}\leq\eta_{i}\leq x_{\lambda+1}$

由题设可知$f^{\prime \prime }($ $x$ ) 在$\left[\begin{smallmatrix}a&b\end{smallmatrix}\right]$ 上连续，根据连续函数的性质可知，在$\left[\begin{smallmatrix}a,b\end{smallmatrix}\right]$ 中存在一点$\eta$ ，使
$$\frac{1}{n}\sum_{k=0}^{n-1}f^{\prime\prime}(\:\eta_{k}\:)=f^{\prime\prime}(\:\eta)$$

因此.得到复化梯形求积公式的误差估计为
$$\int_{a}^{b}f(\:x\:)\:\mathrm{d}x\:-\:T_{n}\:=-\:\frac{nh^{3}}{12}f^{\prime\prime}(\:\eta)\:=-\:\frac{b\:-\:a}{12}h^{2}f^{\prime\prime}(\:\eta)$$

当使用复化梯形求积公式求积分时，有时可以使用它们的误差估计式判断$n$ 应取多大才能满足给定的精度要求.换句话说，就是要把积分区间$\left[\begin{smallmatrix}a&b\end{smallmatrix}\right]$ 划分多少等分才能满足给定精度要求，

例4-2计算积分$\int_0^1\mathrm{e}^x$d$x$ 的近似值,要求保证有5位有效数字.若用复化样形求积公式计算， $n$ 应取多少？

------------------------------------------------------------------

解据复化梯形求积公式的误差估计式（4.19），有

$$\int_{0}^{1}\mathrm{e}^{x}\mathrm{d}x\:-\:T_{0}\:=-\:\frac{1}{12n^{2}}\mathrm{e}^{n}$$

其中$0\leqslant\eta\leqslant1$ ．对上式两边取绝对值得

$$\left|\int_0^1\mathrm{e}^x\mathrm{d}x\:-\:T_n\:\right|=\frac{1}{12n^2}\mathrm{e}^n\leqslant\frac{1}{12n^2}\mathrm{e}$$

按题目要求，选择$n$ 使得用复化梯形求积公式计算该积分时具有5位有效数字.据题意和有效数字的定义，即须选择$n$ 满足

$$\frac{1}{12n^2}\mathrm{e}\leqslant\frac{1}{2}\times10^{s-3}$$

其中$p$ 由$\int_0^1\mathrm{e}^x$d$x$ 的准确值确定.

显然，

$$\int_{0}^{1}\mathrm{e}^{x}\mathrm{d}x=\mathrm{e}^{1}-\mathrm{e}^{0}=0.\:171\:8\cdots=0.\:171\:8\cdots\times10^{1}$$

从而得$p=1.$ 故须选择$n$ 满足

$$\frac{1}{12n^2}\text{e}\leqslant\frac{1}{2}\times10^{-4}$$

$$n\:\geqslant\quad\frac{\mathrm{e}\:\times\:10^4}{6}\:\approx\:67.\:308\:8$$

因此，只要取$n=68$ 就有$\frac1{12n^2}\mathrm{e}^{\mathrm{~}^{\mathrm{~}}}\leqslant\frac12\times10^{-4}$ ， $T_n$ 就具有5位有效数字

定理4.7积分近似值$T_{x}$ 与$T_{2n}$ 有如下关系：

$$T_{2s}\:=\:\frac{1}{2}\Big[\:T_{s}\:+\:h\:\sum_{k=1}^{n}f\Big[\:a\:+\:(\:2k\:-\:1\:)\:\frac{b\:-\:a}{2n}\Big]\:\Big]$$

其中$h=\frac{b-a}n$

证明把区间$\left[\begin{smallmatrix}a,b\end{smallmatrix}\right]2n$ 等分，实际上是在将区间$\left[\begin{smallmatrix}a&b\end{smallmatrix}\right]n$ 等分的基础上，对每个小区间$\left[\begin{smallmatrix}x_k\end{smallmatrix},x_{k+1}\\[x_k]\right]$ 再平分一次，亦即在每个小区间$\left[\begin{array}{c}x_i\end{array},x_{\lambda+1}\\\left[\begin{array}{c}x_i\end{array},x_{\lambda+1}\right.\right]$ ]上插人一个中点.记这个中点为$x_{k+\frac17}$ ,则x+↓=x+=a+k+h,k=0,1,…,n-1,从而有

$$\begin{aligned}\int_{n}^{k}f(\:x\:)\:\mathrm{d}x&=\:\sum_{k=0}^{n-1}\int_{x_{k}}^{4+1}f(x\:)\:\mathrm{d}x\:=\:\sum_{k=0}^{n-1}\left[\:\int_{x_{k}}^{x_{k}-\frac{1}{2}}f(x\:)\:\mathrm{d}x\:+\:\int_{x_{k+\frac{1}{2}}}^{4+1}f(x\:)\:\mathrm{d}x\:\right]\\&\approx\sum_{k=0}^{n-1}\left\{\:\frac{x_{k+\frac{1}{2}}-x_{k}}{2}\Big[\:f(\:x_{k}\:)\:+f\Big[\:x_{k+\frac{1}{2}}\Big]\:\Big]+\frac{x_{k+1}-x_{k+\frac{1}{2}}}{2}\Big[\:f(\:x_{k+\frac{1}{2}})+f\Big(\:x_{k+1}\Big)\Big]\right\}\end{aligned}$$

------------------------------------------------------------------

$$\begin{aligned}
&=\:\frac{h}{4}\sum_{k=0}^{n-1}\left[\:f(\:x_{k}\:)\:+\:2f(\:x_{k+\frac{1}{2}}\:]+f(\:x_{k+1}\:)\:\right] \\
&=\:\frac{1}{2}\Big[\:T_{n}\:+\:h\sum_{k=0}^{n-1}f\Big(\:x_{k+\frac{1}{2}}\Big)\:\Big] \\
&=\:\frac{1}{2}\bigg[\:T_{n}\:+\:h\sum_{i=1}^{n}f\bigg[\:a\:+\:\bigg[\:k\:-\:1\:+\:\frac{1}{2}\bigg]h\bigg]\bigg] \\
&=\:\frac{1}{2}\Big[\:T_{n}\:+\:h\:\sum_{i=1}^{n}f\Big[\:a\:+\:(\:2k\:-\:1)\:\frac{b\:-\:a}{2n}\Big]\:\Big]
\end{aligned}$$

从而得到

$$T_{2*}\:=\:\frac{1}{2}\Big[\:T_{*}\:+\:h\sum_{k=1}^{n}f\Big[\:a\:+\:(\:2k\:-\:1\:)\:\frac{b\:-\:a}{2n}\Big]\:\Big]$$

# 4.4.2复化Simpson 求积公式及其误差估计

把积分区间$[a,b]n$ 等分， $n$ 为偶数，不妨设$n=2m\left(\:m=1\:,2\:,\cdots\:\right)$ ，则分点为$x_0$ X $x_0$ $, x_1$ $, \cdots$ $, x_{2m}$ . 其中x =a + kh $x_{i}=a+kh$ $x_{i}= a+ kh$ $; k= 0$ ,1 $, \cdots , 2m$ $; h= ($ $b- a$ $) / n.$ 使用这些分点把[ $a$ $b$ ] 分为$m$ 个小区间$\left[\begin{smallmatrix}x_0&,x_2\end{smallmatrix}\right]$ ， $\left[\begin{smallmatrix}x_2&,x_4\end{smallmatrix}\right]$ ， $\cdots , [$ $x_{2( \:n- 1\:) }$ $x_{2n}$ ].在每个小区间[ $x_{2(k-1)}$ 2 $x_{2k}$ $x_{2k}$ ]( $k= 1$ ,2 $, \cdots , m$ ) 上采用Simpson求积公式（4.6）得

$$\begin{aligned}
&\text{|} \\
&\int_{x_{2(\:k-1)}}^{2k}f(\:x\:)\:\mathrm{d}x =\:\int_{x_{2k-2}}^{2k}f(\:x\:)\:\mathrm{d}x \\
&\approx\frac{x_{2k}\:-\:x_{2k-2}}{6}\Big[\:f(\:x_{2k-2}\:)\:+4f(\:_{2k-1}\:)\:+f(\:x_{2k}\:)\:\Big] \\
&=\:\frac{h}{3}[\:f(\:x_{2k-2}\:)\:+\:4f(\:x_{2k-1}\:)\:+f(\:x_{2k}\:)\:]
\end{aligned}$$

从而有
$$\begin{aligned}
\int_{a}^{b}f(\:x\:)\:\mathrm{d}x& =\:\int_{x_{0}}^{2}f(\:x\:)\:\mathrm{d}x\:+\:\int_{x_{2}}^{4}f(\:x\:)\:\mathrm{d}x\:+\:\cdots\:+\:\int_{x_{2(\:n-1)}}^{2n}f(\:x\:)\:\mathrm{d}x \\
&=\:\sum_{k=1}^{n}\int_{x_{2(k-1)}}^{x_{k}}f(\:x\:)\:\mathrm{d}x\:=\:\sum_{k=1}^{n}\:\frac{h}{3}[\:f(\:x_{2k-2}\:)\:+4f(\:x_{2k-1}\:)\:+f(\:x_{2k}\:)\:] \\
&=\frac{h}{3}\Big[\:f(\:x_{0}\:)\:+\:\sum_{k=2}^{n}f(\:x_{2k-2}\:)\:+\:4\:\sum_{k=1}^{n}f(\:x_{2k-1}\:)\:+\:\sum_{k=1}^{n}f(\:x_{2k}\:)\:+\:f(\:x_{2n}\:)\:\Big] \\
&=\:\frac{h}{3}[\:f(\:a\:)\:+f(\:b\:)\:+4\sum_{k=1}^{n}f(\:x_{2k-1}\:)\:+2\sum_{k=1}^{n-1}f(\:x_{2k}\:)\:]\quad(\:4.\:2
\end{aligned}$$

(4.21)式称为复化Simpson 求积公式或复化抛物线求积公式，记为$S_n$ .其中$n$ 为等分数

定理4.8若$f($ $x$ ) $\in$ $C^{4}\left [ \:a\:, b\:\right ]$ ，则对复化Simpson 求积公式$S_n$ 有

------------------------------------------------------------------

$$\int_{a}^{b}f(\:x\:)\:\mathrm{d}x\:-\:S_{s}\:=-\frac{b\:-\:a}{2\:880}(\:2h\:)^{4}f^{(4)}\:(\:\eta)$$

其中$h=\frac{b-a}n;a\leqslant\eta\leqslant b$

证明把积分区间[ $a$ $, b$ ] $n$ 等分，其中$n=2m\left(\:m=1\:,2\:,\cdots\:\right)$ ，则分点为Xo $x_0$ $x_0$ $, x_1$ $\cdots,x_{2n}$ .这些分点把$\left[\begin{smallmatrix}a&b\end{smallmatrix}\right]$ 分为$m$ 个小区间$\left[\begin{smallmatrix}x_0&,x_2\end{smallmatrix}\right]$ ， $\left[\begin{smallmatrix}x_2&,x_4\end{smallmatrix}\right]$ ， $\cdots,\left[\begin{smallmatrix}x_{2(n-1\:)}\end{smallmatrix}\right]$ ， $x_{2w}$ 1在每个小区间[ $x_{2(k-1)}$ $.x_{2k}$ ]( $k= 1$ ,2 $, \cdots , m$ ) 上采用Simpson求积公式的误差估计式（4.16）得
$$\begin{aligned}
&\text{10/1时} \\
&\int_{a}^{b}f(x)\:\mathrm{d}x\:-\:S,&& =\:\sum_{k=1}^{n}\left\{\:\int_{x_{2(k-1)}}^{2k}f(\:x\:)\:\mathrm{d}x-\frac{x_{2k}\:-\:x_{2k-2}}{3}\left[\:f(\:x_{2k-2}\:)\:+4f(\:x_{2k-1}\:)\:+f(\:x_{2k}\:)\:\right]\right] \\
&&&=-\:\frac{\left(2h\right)^{5}}{2\:880}\sum_{k=1}^{n}f^{(4)}\left(\:\eta_{k}\:\right)
\end{aligned}$$

其中$x_{2k-2}\leqslant\eta_{k}\leq x_{2k}$

由题设可知$f^{\prime \prime }($ $x$ ) 在$\left[\begin{smallmatrix}a,b\end{smallmatrix}\right]$ 上连续，根据连续函数的性质，在$\left[\begin{smallmatrix}a&b\end{smallmatrix}\right]$ 中存在一点$\eta$ ，使
$$\frac{1}{m}\sum_{i=1}^{\infty}f^{(4)}\left(\eta_{i}\right)=f^{(4)}\left(\eta\right)$$

因此，得到复化Simpson 求积公式的误差估计式

$$\int_{s}^{b}f(\:x\:)\:\mathrm{d}x\:-\:S_{s}\:=-\:\frac{b\:-\:a}{2\:880}(\:2h\:)^{4}f^{(4)}\:(\:\eta\:)$$

使用复化Simpson公式求积分算法

![](https://storage.simpletex.cn/view/fvyrB1gVGf4YweMzYIcCwvga4G0hVqG9k)

# 4.5自动选取步长梯形法

在4.4节介绍了复化梯形求积公式。使用复化梯形求积公式求积分的近似值

------------------------------------------------------------------

是一种比较有效的方法.但是，在使用复化梯形求积公式求积分之前必须选定$n$

对复化梯形求积公式的误差估计式（4.19）的两边求绝对值得

$$\left|\int_{a}^{b}f(\:x\:)\:\mathrm{d}x\:-\:T_{a}\:\right|\:=\:\frac{b\:-\:a}{12}h^{2}\:|f^{\prime\prime}(\:\eta)\:|\:\leqslant\:\frac{b\:-\:a}{12}h^{2}\:\max_{a\leq x\leq b}|f^{\prime\prime}(\:x\:)\:|$$

从（4.23）式可以看到，如果$n$ 取得太大，虽然能使复化梯形求积公式与积分精确值的误差变得很小，但会导致计算量的增加.如果$n$ 取得太小，复化梯形求积公式与积分精确值的误差就会很大，从而使复化梯形求积公式的精度难以保证.因此， 假如给定一个精度，那如何选择$n$ 使积分近似值满足精度要求？为了避免盲目选取$n$ ，可以使用自动选取步长梯形法，

自动选取步长梯形法需要反复使用公式（4.20）：
$$T_{2s}\:=\:\frac{1}{2}\Big[\:T_{s}\:+\:h\sum_{k=1}^{n}f\Big[\:a\:+\:(2k\:-\:1\:)\:\frac{b\:-\:a}{2n}\Big]\:\Big]$$

根据复化梯形求积公式的误差估计式（4.19）得

$$\int_{a}^{b}f(\:x\:)\:\mathrm{d}x\:-\:T_{a}\:=-\:\frac{b\:-\:a}{12}h^{2}f^{\prime\prime}(\:\eta_{a}\:)\quad(\:a\:\leqslant\:\eta_{a}\:\leqslant\:b\:)$$

和

$$\int_{a}^{b}f(\:x\:)\:\mathrm{d}x\:-\:T_{2a}\:=-\:\frac{b\:-\:a}{12}(\:\frac{h}{2})^{2}f^{\prime\prime}(\:\eta_{2a}\:)\quad(\:a\:\leqslant\:\eta_{2a}\:\leqslant\:b\:)$$

将上两式相减得

$$T_{2n}\:-\:T_{n}\:=\:-\:\frac{b\:-\:a}{12}\Big[\:\frac{h}{2}\Big]^{2}\Big[\:4f^{\prime\prime}(\:\eta_{n}\:)\:-f^{\prime\prime}(\:\eta_{2n}\:)\Big]$$

当$f^{\prime \prime }($ $x$ ) 在$\left[\begin{smallmatrix}a&b\end{smallmatrix}\right]$ 上连续，并假设$n$ 充分大时$f^{\prime \prime }($ $\eta _{x}$ $) = f^{\prime \prime }($ $\eta _{2a}$ ) ，则有

$$\frac{1}{3}(\:T_{2s}\:-\:T_{s}\:)\:\approx\:\int_{a}^{b}f(\:x\:)\:\mathrm{d}x\:-\:T_{2s}$$

因此，假如给定一个精度$\varepsilon$ ,要求f(x)dx-T<8,则可以用$\mid T_{2n}-T_{n}\mid<3\varepsilon$ 近似判断$T_{2\kappa}$ 是否满足精度要求.

自动选取步长梯形法的计算步骤为：

$\textcircled{1}$ 先用梯形求积公式(4.4)计算出积分的第一次近似值

$$T_1\:=\:\frac{b\:-\:a}{2}[f(\:a\:)\:+f(\:b\:)\:]$$

$\textcircled{2}$ 把积分区间[ $a$ $, b$ ]2等分，并用（4.20）式求出积分的第二次近似值
$$T_{2}\:=\frac{1}{2}\Big[\:T_{1}\:+\:(\:b\:-\:a\:)\:\sum_{k=1}^{1}f\Big[\:a\:+\:(\:2k\:-\:1\:)\:\frac{b\:-\:a}{2}\Big]\Big]$$

$$=\:\frac{T_1}{2}\:+\:\frac{b\:-\:a}{2}f\Big[\:a\:+\:\frac{b\:-\:a}{2}\Big]$$

然后判别$\mid T_2-T_1\mid<3\varepsilon$ 是否成立，若成立，则计算停止， $T_2$ 作为积分近似值；否则， 进行下一步.

------------------------------------------------------------------

$\textcircled{3}$ 把积分区间[ $a$ $, b$ ]4等分，并用（4.20）式求出积分的第三次近似值
$$T_{4}\:=\:\frac{1}{2}\Big[\:T_{2}\:+\:\frac{b\:-\:a}{2}\sum_{i=1}^{2}f\Big[\:a\:+\:(\:2k\:-\:1\:)\:\frac{b\:-\:a}{4}\Big]\:\Big]$$

$$=\:\frac{T_{2}}{2}\:+\:\frac{b\:-\:a}{4}\sum_{k=1}^{2}f\Big[\:a\:+\:(\:2k\:-\:1\:)\:\frac{b\:-\:a}{4}\Big]$$

然后判别$\mid T_{4}-T_{2}\mid<3\varepsilon$ 是否成立，若成立，则计算停止， $T_{4}$ 作为积分近似值；否则， 进行下一步.

$\textcircled{4}$ 把积分区间[ $a$ $, b$ ]8等分，并用（4.20)式求出积分的第四次近似值
$$T_{8}\:=\:\frac{1}{2}\Big[\:T_{4}\:+\:\frac{b\:-\:a}{4}\sum_{c=1}^{2}f\Big[\:a\:+\:(\:2k\:-\:1\:)\:\frac{b\:-\:a}{8}\Big]\:\Big]$$

$$=\:\frac{T_{4}}{2}\:+\:\frac{b\:-\:a}{8}\sum_{k=1}^{4}f\Big[\:a\:+\:(\:2k\:-\:1\:)\:\frac{b\:-\:a}{8}\Big]$$

然后判别$\mid T_{8}-T_{4}\mid<3\varepsilon$ 是否成立，若成立，则计算停止， $T_{8}$ 作为积分近似值；否则， 要进行下一步.

按这样一直做下去，直到$\mid T_{2x}-T_{n}\mid<3\varepsilon$ 成立为止. $T_{2n}$ 即为满足精度&的积分近似值.

自动选取步长梯形法算法

$\textcircled{1}$ 输人$a,b$ 和$E$
$$.h=\frac{b-a}{2},T_{1}=(f(\:a)\:+f(\:b\:)\:)\:\times h\:,n=1$$

$\textcircled{3}$ 计算$T_{0}=T_{1}$ $S=0(T_{0}$ To $T_{0}$ 表示前次积分近似值， $T_{1}$ 表示后次积分近似值）

$\textcircled{4}$ 对$k=1,2,\cdots,n$ ，计算
$$S=S+f\Big[\:a+(2k-1)\times\frac{h}{n}\Big]$$

$$5T_{1}=\frac{T_{0}}{2}+S\times\frac{h}{n}$$
$\textcircled{6}$ 若$\mid T_{1}-T_{0}\mid<3\varepsilon$ ，则输出$T_{1}$ 的值，结束计算.否则， $,n=2n$ ，返回$1\textcircled{3}$

# 4.6数值方法中的加速收敛技巧一-Richardson外推算法

Richardson（李查逊）外推算法在数值分析中有很多应用，如用在数值积分上就产生一种新的数值积分方法-Romberg（龙贝格）求积法. Romberg 求积法在下一节介绍，本节介绍Richardson外推算法，

假设有一个量$F^{*}$ ，这个量可以是函数、微分和积分等，现用一个以步长$h$ 为变

------------------------------------------------------------------

量的函数$F_0(h)$ 近似代替它，并设$F^{\prime}$ 与$h$ 无关，且给定$F^{\prime}$ 与$F_0(h)$ 的误差估计为

$$F^{^*}\:-\:F_{0}(\:h\:)\:=\:a_{1}h^{^{p_{1}}}\:+\:a_{2}h^{^{p_{2}}}\:+\:\cdots\:+\:a_{i}h^{^{p_{0}}}\:+\:\cdots $$

其中$0< p_{1}< p_{2}< \cdots < p_{i}< \cdots ; a_{i}\neq 0($ $k= 1$ ,2 $, \cdots )$ 是与$h$ 无关的常数

从误差估计式（4.25）可以看到，当$h$ 适当小时，第一项$a_1h^{r_1}$ 的绝对值远比后面的项的绝对值大.而第一项中的$h^{p1}$ 是最主要的，它对误差的影响最大，通常称为$F^{\prime}$ 与函数$F_0(h)$ 的误差的阶.显然，当$h$ 适当小时，误差的阶$h^{\rho_1}$ 中的幂$p_1$ 越大， $F^{*}$ 与函数$F_0(h)$ 的误差的绝对值就会越小.能否从函数$F_0\left(h\right)$ 出发构造一个新的函数近似代替$F^{\prime}$ ，使$F^{\prime}$ 与这个函数的误差的阶的幂比$F^{\prime}$ 与函数$F_0(h)$ 的误差的阶的幂更高一些？答案是肯定的，

为了构造出一个新函数$F_2(h)$ 近似代替$F^{\prime}$ ，使$F^{\prime}$ 与这个函数的误差的阶的幂比$F^{*}$ 与函数$F_0(h)$ 的误差的阶的幂更高一些，可以采用下面的做法，

首先把（4.25）式中的$h$ 用gh代替，得

$$F^{*}-F_{0}\left(\:qh\:\right)=a_{1}\left(\:qh\:\right)^{p_{1}}+a_{2}\left(\:qh\:\right)^{p_{2}}+\cdots+a_{k}\left(\:qh\:\right)^{p_{k}}+\cdots $$

其中$q$ 为常数，并满足$1-q^{p_{1}}\neq0.$ 再用$q^{r_1}$ 乘（4.25）式两边，得

$$q^{*_{1}}F^{*}-q^{*_{1}}F_{0}\left(\:h\:\right)=a_{1}\left(\:qh\:\right)^{*_{1}}+a_{2}q^{*_{1}}h^{*_{2}}+\cdots+a_{k}q^{*_{1}}h^{*_{k}}+\cdots $$

(4.26）式减（4.27）式并整理后得
$$\begin{aligned}
&\text{1} \\
&(\:1-q^{^{p_{1}}}\:)\:F^{^{*}}\:-[\:F_{0}\:(\:qh\:)\:-q^{^{p_{1}}}F_{0}\:(\:h\:)\:] \\
&=a_{2}\left(\:q^{p_{2}}-q^{p_{1}}\:\right)h^{p_{2}}+a_{3}\left(\:q^{p_{3}}-q^{p_{1}}\:\right)h^{p_{3}}+\cdots+a_{k}\left(\:q^{p_{k}}-q^{p_{1}}\:\right)h^{p_{k}}+\cdots 
\end{aligned}$$

用$1-q^{^{\prime}1}$ 除（4.28)式两边得
$$\begin{aligned}
&\text{1} \\
&F^{^{*}}-\frac{F_{0}\left(\:qh\:\right)-q^{^{*}_{1}}F_{0}\left(\:h\:\right)}{1-q^{^{*}_{1}}} \\
&=\frac{a_{2}\left(q^{p_{2}}-q^{p_{1}}\right)h^{p_{2}}}{1-q^{p_{1}}}+\frac{a_{3}\left(q^{p_{3}}-q^{p_{1}}\right)h^{p_{3}}}{1-q^{p_{1}}}+\cdots+\frac{a_{k}\left(q^{p_{k}}-q^{p_{1}}\right)h^{p_{k}}}{1-q^{p_{1}}}+\cdots 
\end{aligned}$$

$$F_{1}\left(\:h\:\right)=\frac{F_{0}\left(\:qh\:\right)\:-q^{p_{1}}F_{0}\left(\:h\:\right)}{1\:-q^{p_{1}}}\text{和}\:a_{k}^{(1)}\:=\frac{a_{k}\left(\:q^{p_{k}}-q^{p_{1}}\:\right)}{1\:-q^{p_{1}}}\:,k=2\:,3\:,\cdots,$$
有

$$F^{^{*}}-F_{1}(h)\:=\:a_{2}^{(1)}h^{p_{2}}\:+\:a_{3}^{(1)}h^{p_{3}}\:+\:\cdots\:+\:a_{i}^{(1)}h^{p_{k}}\:+\:\cdots $$

其中$a_i^{(1)}$ 是与$h$ 无关的常数

从(4.30)式可以看到，若用函数$F_1(h)$ 近似代替$F^{*}$ ，则$F^{*}$ 与$F_1(h)$ 的误差的阶为$h^{P2}.$ 而$p_2>p_1$ ，因此，只要$h$ 适当小， $F^{*}$ 与$F_1(h)$ 的误差的绝对值比$F^{*}$ 与$F_0$ $(h)$ 的误差的绝对值要小些，

有了$F_1(h)$ 以后，再从这个函数出发，构造出一个新函数$F_2\left(h\right)$ 近似代替$F^{\prime}$ ， 使$F^{\prime}$ 与这个函数的误差的阶的幂比$F^{\prime}$ 与函数$F_1(h)$ 的误差的阶的幂更高一些， 具体做法与前面的做法类似，

------------------------------------------------------------------

$$F^{^*}-F_{2}(h)\:=\:a_{3}^{(2)}h^{p_{3}}\:+\:a_{4}^{(2)}h^{p_{4}}\:+\:\cdots\:+\:a_{4}^{(2)}h^{p_{4}}\:+\:\cdots $$

$$F_{2}\left(\:h\:\right)\:=\frac{F_{1}\left(\:qh\:\right)\:-q^{^{p_{2}}}F_{1}\left(\:h\:\right)}{1\:-q^{^{p_{2}}}},a_{k}^{(2)}\:=\frac{a_{k}^{(1)}\left(\:q^{^{p_{k}}}-q^{^{p_{2}}}\right)}{1\:-q^{^{p_{2}}}}(\:k=3\:,4\:,\cdots)\:,$$
常数

从（4.31)式可以看到，若用函数$F_2(h)$ 近似代替$F^{*}$ ，则$F^{*}$ 与$F_2(h)$ 的误差的阶为$h^{P3}$ ，而$p_3>p_2$ .因此，只要$h$ 适当小， $F^{*}$ 与$F_2(h)$ 的误差的绝对值比$F^{*}$ 与$F_1$ $(h)$ 的误差的绝对值又要小些，

依此类推，就可以构造出一系列的函数$F_{0}\left(h\right),F_{1}\left(h\right),F_{2}\left(h\right),\cdots.$ 当$h$ 适当小时， $F^{*}$ 与这些函数的误差的绝对值一个比一个小.这些函数的一般形式为

$$\begin{array}{rcl}F_n\left(\:h\:\right)&=\:\frac{F_{n-1}\left(\:qh\:\right)\:-\:q^{P_{\infty}}F_{n-1}\left(\:h\:\right)}{1\:-\:q^{P_{\infty}}}\quad(\:m\:=\:1\:,2\:,\cdots)\end{array}$$

其中$q$ 为常数，并满足$1-q^{p_{\alpha}}\neq0$

（4.32）式称为Richardson外推算法.用归纳法可以证明：
$$F^{^{\prime\prime}}-F_{n}\left(h\right)\:=\:a_{n+1}^{(n)}h^{^{\prime\prime}n+1}\:+\:a_{n+2}^{(n)}h^{^{\prime\prime}n+2}\:+\:\cdots $$

其中$, a_{k}^{\langle n\rangle }= \frac {a_{k}^{( n- 1) }\left ( q^{p_{k}}- q^{p_{m}}\right ) }{1- q^{p_{m}}}($ $k= m$ +1 $, m$ +2 $, \cdots )$ ，是与$h$ 无关的常数

# 4.7Romberg求积法

Romberg求积法是应用Richardson外推算法的一个典型例子.在介绍Romberg 求积法的具体计算过程之前，先介绍一下Romberg 求积法的理论基础，推导一个求积分近似值的Romberg 序列

# 4.7.1Romberg序列的推导

4.4节已经证明，（4.19）式是复化梯形求积公式误差估计式的一种形式，

还可以证明复化梯形求积公式的另一个误差估计式

$$\int_{a}^{b}f(\:x\:)\:\mathrm{d}x\:-T_{a}=a_{2}h^{2}+a_{4}h^{4}+a_{6}h^{6}+\cdots $$

其中$h= \frac {b- a}n, a_2$ $, a_4$ $, a_6$ .…都是与步长$h$ 无关的常数

从误差估计(4.33)式和(4.25)式可以看到P=2 $.p_{1}=2$ P= 4 $p_{2}=4$ $, p_{1}= 2$ $, p_{2}= 4$ $, p_{5}= 6$ $, \cdots$ P;=6 $p_{3}=6$ ，复化梯形求积公式与积分准确值的误差的阶为$h^2$

由复化梯形求积公式（4.18）可知
$$T_{*}\:=\:\frac{h}{2}[\:f(\:a\:)\:+f(\:b\:)\:+2\:\sum_{k=1}^{n-1}f(\:a\:+kh\:)\:]\:=\:T_{0}\:(\:h\:)$$

------------------------------------------------------------------

把积分区间$\left[\begin{smallmatrix}a,b\end{smallmatrix}\right]2n$ 等分，并且采用复化梯形公式得

$$T_{2n}\:=\:\frac{h}{2^{2}}\Big[\:f(\:a\:)\:+f(\:b\:)\:+2\:\sum_{k=1}^{2n-1}f\Big[\:a\:+\:k\:\frac{h}{2}\Big]\:\Big]\:=\:T_{0}\Big[\:\frac{h}{2}\Big]$$

(4.34)式实际上就是用$\frac h2$ 替代$T_n$ 中的$h$ 得到的,所以可以记为T

再把积分区间$\left[\begin{smallmatrix}a,b\end{smallmatrix}\right]4n$ 等分，并且采用复化梯形公式得

$$T_{4n}=\frac{h}{2^3}\bigg[\:f(\:a\:)\:+f(\:b\:)\:+2\:\sum_{k=1}^{4n-1}\:f\bigg[\:a\:+k\:\frac{h}{2^2}\bigg]\:\bigg]\:=T_0\bigg[\:\frac{h}{2^2}\bigg]$$

(4.35)式实际上就是用$\frac h{2^2}$ 替代$T_n$ 中的$h$ 得到的，所以可以记为T

按此类推，就能得到一个函数序列

$$T_0\left(\:h\:\right),T_0\left[\:\frac{h}{2}\right],T_0\left[\:\frac{h}{2^2}\right],\cdots $$

可以证明，函数序列（4.36）收敛于积分的准确值，根据误差估计式（4.33）.这个函数序列中的每一个函数与积分准确值的误差的阶为$h^2$

按照Richardson外推算法，可以从这个函数序列出发构造一个新的函数序列， 使新的函数序列收敛于积分准确值的速度比函数序列（4.36）收敛于积分准确值的速度更快些.具体做法为：

取$m=1$ 和q=代人Richardson外推公式（4.32），把$F$ 改为$T$ ,并注意到$p_1$ =2就得到一个新函数

$$T_1\left(h\right)=\frac{T_0\left[\begin{array}{c}h\\2\end{array}\right]-\frac{1}{2^2}T_0\left(\begin{array}{c}h\\\end{array}\right)}{1-\frac{1}{2^2}}$$

对(4.37)式用$\frac h2$ 替代$h$ ，得

$$T_1\left[\begin{array}{c}h\\2\end{array}\right]=\frac{T_0\left[\begin{array}{c}h\\2\end{array}\right]-\frac{1}{2^2}T_0\left[\begin{array}{c}h\\2\end{array}\right]}{1-\frac{1}{2^2}}$$

再用$|\frac h2^2$ 替代$h$ ，得

$$T_1\left[\begin{array}{c}h\\2^2\end{array}\right]=\frac{T_0\left[\begin{array}{c}h\\2^3\end{array}\right]-\frac{1}{2^2}T_0\left[\begin{array}{c}h\\2^2\end{array}\right]}{1-\frac{1}{2^2}}$$

------------------------------------------------------------------

如此类推，就可以得到一个新的函数序列

$$T_1\left(h\right),T_1\left[\begin{array}{c}h\\2\end{array}\right],T_1\left[\begin{array}{c}h\\2\end{array}\right],\cdots $$

可以证明，函数序列（4.38）收敛于积分的准确值.由Richardson外推算法可知，这些函数与积分准确值的误差的阶为$h^4$ .所以，当$h$ 适当小时，该函数序列收敛于积分准确值的速度比函数序列（4.36）收敛于积分准确值的速度要快些，

取$m=2$ 和q=代人Richardson外推公式（4.32），把$F$ 改为$T$ ,并注意到p =4 ，仿照前面的方法，又可以得到一个新的函数序列

$$T_2\left(\:h\:\right),T_2\left[\:\frac{h}{2}\right],T_2\left[\:\frac{h}{2^2}\right],\cdots $$

可以证明，函数序列（4.39）收敛于积分的准确值.由Richardson外推算法可知，这些函数与积分准确值的误差的阶为$h^{6}$ .所以，当$h$ 适当小时，该函数序列收敛于积分准确值的速度比（4.36）和（4.38）两个函数序列收敛于积分准确值的速度要快些

这样，不断地运用Richardson外推算法就得到一系列的函数序列：

$$\begin{aligned}
&T_{0}\left(\:h\:\right),T_{0}\left[\:\frac{h}{2}\right],T_{0}\left[\:\frac{h}{2^{2}}\right],\cdots \\
&T_{1}\left(\:h\:\right),T_{1}\left[\:\frac{h}{2}\right],T_{1}\left[\:\frac{h}{2^{2}}\right],\cdots \\
&T_{2}\left(\:h\:\right),T_{2}\left[\:\frac{h}{2}\right],T_{2}\left[\:\frac{h}{2^{2}}\right],\cdots \\
&T_{n}\left(h\right),T_{n}\left[\:\frac{h}{2}\right],T_{n}\left[\:\frac{h}{2^{2}}\right],\cdots 
\end{aligned}$$

函数序列表（4.40）的函数计算可以归纳为统一公式
$$T_{m}\left[\begin{array}{c}\frac{h}{2^{k}}\end{array}\right]=\frac{T_{m-1}\left[\begin{array}{c}\frac{h}{2^{k+1}}\end{array}\right]-\frac{1}{2^{2m}}T_{m-1}\left[\begin{array}{c}\frac{h}{2^{k}}\end{array}\right]}{1-\frac{1}{2^{2m}}}=\frac{4^{m}T_{m-1}\left[\begin{array}{c}\frac{h}{2^{k+1}}\end{array}\right]-T_{m-1}\left[\begin{array}{c}\frac{h}{2^{k}}\end{array}\right]}{4^{m}-1}$$

$$,T_{0}\left(\:h\:\right)=T_{s}\:,T_{0}\left[\:\frac{h}{2}\:\right]=T_{2s}\:,T_{0}\left[\:\frac{h}{2^{2}}\:\right]=T_{4s}\:,\cdots;m=1\:,2\:,\cdots;k=0\:,1\:,\cdots.$$

可以证明，函数序列表（4.40）中的每一行都收敛于积分的准确值.实际上，还可以证明函数序列

$$T_0\left(h\right),T_1\left(h\right),\cdots,T_n\left(h\right),\cdots $$

也收敛于积分准确值.函数序列（4.42）称为Romberg 序列，使用该函数序列求积

------------------------------------------------------------------

分的方法称为Romberg求积法，

### 4.7.2Romberg求积法的计算过程

Romberg求积法的计算过程如下：

![](https://storage.simpletex.cn/view/fO5Kq1xZTd53wavmaOe3fL4IMslni6YBa)

按这样做下去，直到$\mid T_{n}\left(h\right)-T_{n-1}\left(h\right)\mid<\varepsilon$ 为止

需说明的是，在开始计算时，要先取定$n$ ，通常取$n=1$ .也要先取定8，8取得越小，积分近似值就越接近于积分准确值，

例4-3使用Romberg求积法计算积分$\int_0^1\frac4{1+x^2}$d$x$ 的值(给定$\varepsilon=0.01$ ，且取$n=1$ ).

解$\textcircled{1}T_{1}=T_{0}\left(\begin{array}{c}h\end{array}\right)=\frac{1-0}{2}\times\left(4+2\right)=3$
$$2T_2=T_0\left[\begin{array}{c}h\\2\end{array}\right]=\frac{1}{2}\left[\begin{array}{c}T_1\end{array}+\frac{4}{1+\left[\begin{array}{c}1\\2\end{array}\right]^2}\right]=3.\:1$$

$$3T_1\left(\:h\:\right)=\frac{4\:T_0\left[\begin{array}{c}h\\2\end{array}\right]-T_0\left(\:h\:\right)}{3}\:=3.\:133\:33$$

$$\begin{array}{c|c}|\:T_1(\:h\:)\:-T_0(\:h\:)\:|\:=0.\:133\:333>0.\:01\end{array}$$

进行下一步.

![](https://storage.simpletex.cn/view/fgkZHlgUIU2qlCAM9Wv49wDiYY2uW9XfL)

------------------------------------------------------------------

$$\begin{array}{c|c}|\:T_2(\:h)\:-T_1(\:h)\:|\:=0.\:008\:79\:<0.\:01\end{array}$$

成立，计算停止， $T_1(h)$ 作为满足精度要求的积分近似值

前面介绍的是人工计算过程，那么，如何在计算机上实现Romberg求积法？为了便于介绍在计算机上如何实现 Romberg 求积法,把$T_n\left[\begin{array}{c}h\\2\end{array}\right]$ 记为$T_n^{(\lambda)}$ ,则相应的Romberg求积法的计算过程如下所示： $\textcircled{1}T_0^{\langle\mathrm{~o}\rangle}$

$\textcircled{2}T_0^{\langle1\rangle}$ ③T(" $\textcircled{4}T_0^{\langle2\rangle}$ $\textcircled{5}T_1^{(1)}$ r $\textcircled{7}T_0^{\langle3\rangle}$ $\textcircled{8}T_{1}^{(2)}$ OrOT ：

按这样做下去，直到$\mid T_{n}^{(\:0)}-T_{n-1}^{(\:0)}\mid<\varepsilon$ 成立为止，

由于在编写程序时， $T_n^{(\lambda)}$ 的值要存放起来，所以需使用一个二维数组T，即用数组元素$T($ $m$ $, k$ ) 来存放$T_n^{(k)}$ 的值

Romberg求积法算法

$\textcircled{1}$ 输人$a,b$ 和$E$ $\textcircled{2}$ 计算$T_{0}^{(0)}$
$$T(0,0)=\frac{b-a}{2}[f(a)+f(b)\:]$$

$\textcircled{3}k=1$ （其中$k$ 用来记录把积分区间$[[a,b]2$ 等分的次数）

$\textcircled{4}$ 按复化梯形公式计算$T_0^{(\lambda)}$ ：

$$T(0,k)\:=\:\frac{1}{2}\Big[\:T(0,k-1)\:+\frac{b-a}{2^{k-1}}\:\sum_{i=1}^{2k-1}f(\:a+(\:2i-1\:)\:\times\frac{b-a}{2^{k}})\Big]$$
$\textcircled{5}$ 计算第$k+1$ 行元素$T_{\mathrm{u}}^{(t-n)}$
$$T(m,k-m)=\frac{4^{n}T(m-1,k-m+1)-T(m-1,k-m)}{4^{n}-1}\quad(m=1,2,$$
$\textcircled{6}$ 精度控制

对指定的精度$\varepsilon$ .若$\mid T($ $k$ ,0 ) - $T($ $k$ - 1 ,0 $) \mid < \varepsilon$ ，即$\mid T_{k}^{(0)}-T_{k-1}^{\langle0\rangle}\mid<\varepsilon$ ，则终止计算，并取$T($ $k$ ,0 ) 即$T_k^{(0)}$ 作为满足精度要求的积分近似值；否则， $k=k+1$ ，转回$\textcircled{4}$ 继续计算.

## 4.8Gauss型求积公式

考虑定积分

$$\int_a^b\mathbf{p}(\:x\:)f(\:x\:)\:\mathrm{d}x$$

------------------------------------------------------------------

其中$\mathbf{p}(x)$ 为区间$\left[\begin{smallmatrix}a&b\end{smallmatrix}\right]$ 上的权函数

以$n$ 个不等距的节点$x_1$ $, x_2$ $, \cdots , x_i$ $, \cdots , x_n$ $, x_i\in [ a, b]$ $x_i\in\left[\begin{smallmatrix}a&b\end{smallmatrix}\right]$ x[ab] 作为插值节点，根据代数插值的理论

$$f(\:x\:)\:=\:\sum_{\ell=1}^{n}f(\:x_{k}\:)\:\frac{\omega_{k}(\:x\:)}{(\:x\:-x_{k}\:)\:\omega_{k}^{\prime}(\:x_{k}\:)}+f(\:x\:,x_{1}\:,x_{2}\:,\cdots,x_{n}\:)\:\omega_{k}(\:x\:)$$

其中$\omega_{n}\left(\begin{array}{cc}x\end{array}\right)=\left(\begin{array}{c}x-x_{1}\end{array}\right)\left(\begin{array}{c}x-x_{2}\end{array}\right)\cdots\left(\begin{array}{c}x-x_{n}\end{array}\right).$

将(4.43）式两边乘以权函数$p(x)$ 并积分得
$$\begin{aligned}
&\text{1} \\
&\int_{a}^{b}\:\mathbf{p}(\:x\:)f(\:x\:)\:\mathrm{d}x =\int_{a}^{b}\rho(\:x\:)\:\left[\:\sum_{k=1}^{n}f(\:x_{k}\:)\:\frac{\omega_{n}(\:x\:)}{(\:x-x_{k}\:)\:\omega_{n}^{\prime}(\:x_{k}\:)}\right]\mathrm{d}x\:+ \\
&\int_{a}^{b}\rho(\:x\:)f(\:x\:,x_{1}\:,x_{2}\:,\cdots,x_{s}\:)\:\omega_{s}(\:x\:)\:\mathrm{d}x \\
&=\sum_{k=1}^{n}f(\:x_{k}\:)\:\int_{a}^{b}\frac{\rho(\:x\:)\:\omega_{s}(\:x\:)}{(\:x\:-\:x_{k}\:)\:\omega_{n}^{\prime}(\:x_{k}\:)}\mathrm{d}x\:+ \\
&\int_{a}^{b}\rho(x)f(x,x_{1},x_{2},\cdots,x_{s})\:\omega_{s}(x)\:\mathrm{d}x
\end{aligned}$$

令

$$A_{k}\:=\:\int_{s}^{s}\frac{\rho(\:x\:)\:\omega_{n}(\:x\:)}{(\:x\:-\:x_{k}\:)\:\omega_{n}^{\prime}(\:x_{k}\:)}\mathrm{d}x$$

$$R[f]\:=\:\int_{a}^{b}\rho(\:x\:)f(\:x\:,x_{1}\:,x_{2}\:,\cdots,x_{n}\:)\:\omega_{n}\:(\:x\:)\:\mathrm{d}x$$

$$\int_{a}^{b}\mathbf{p}(\:x\:)f(\:x\:)\:\mathrm{d}x\:=\:\hat{\sum}_{k=1}^{n}A_{k}f(\:x_{k}\:)\:+\:R[f]$$

舍去余项$R[f]$ 就得到积分近似计算公式

$$\int_{a}^{b}\rho(\:x\:)f(\:x\:)\:\mathrm{d}x\:=\:\sum_{i=1}^{b}A_{i}f(\:x_{i}\:)$$

因为当$f(x)$ 为不超过$n-1$ 次代数多项式时$,f(x,x_{1},x_{2},\cdots,x_{n})=0$ ，从而推得

$$R[f]=\int_{a}^{b}\rho(\:x\:)f(\:x\:,x_{1}\:,x_{2}\:,\cdots,x_{a}\:)\:\omega_{a}(\:x\:)\:\mathrm{d}x\:=0$$

因此，公式(4.45)具有$n-1$ 次代数精确度.下面对给定的$f(x)$ ，寻找$x_k$ 和$A_k$ 使得求积公式（4.45）从$n-1$ 次代数精确度提高到$2n-1$ 次

定理4.9若对任何一个不超过$n-1$ 次的代数多项式$q(x)$ ，有

$$\int_{a}^{b}\rho(\:x\:)\:q(\:x\:)\:\omega_{a}(\:x\:)\:\mathrm{d}x\:=0$$

则求积公式（4.45)具有$2n-1$ 次代数精确度，

证明设$f(x)$ 是次数不高于$2n-1$ 次的多项式，用$\omega_x(x)$ 除$f($ $x$ ) ，若记$q(x)$ 为商， $r($ $x$ ) 为余式，则有

$$f(\:x\:)\:=\mathbf{\omega}_{a}(\:x\:)\:q(\:x\:)\:+r(\:x\:)$$

其中$q(x)$ 和$r(x)$ 都是不超过$n-1$ 次的代数多项式.用$p(x)$ 乘（4.47）式两边，并

------------------------------------------------------------------

求积分得

$$\int_{a}^{b}\mathbf{p}(\:x\:)f(\:x\:)\:\mathrm{d}x\:=\:\int_{a}^{b}\mathbf{p}(\:x\:)\:q(\:x\:)\:\mathbf{\omega}_{a}(\:x\:)\:\mathrm{d}x\:+\:\int_{a}^{b}\mathbf{p}(\:x\:)\:r(\:x\:)\:\mathrm{d}x\\\int_{a}^{b}\mathbf{p}(\:x\:)\:q(\:x\:)\:\mathbf{\omega}_{a}(\:x\:)\:\mathrm{d}x\:=0$$

又因为

再根据（4.44)式得

$$\begin{gathered}
\int_{a}^{b}\rho(\:x\:)\:r(\:x\:)\:\mathrm{d}x\:=\:\sum_{k=1}^{n}\:A_{k}r(\:x_{k}\:) \\
\int_{a}^{b}\rho(\:x\:)f(\:x\:)\:\mathrm{d}x\:=\:\sum_{k=1}^{*}A_{k}r(\:x_{k}\:) \\
f(\:x_{k}\:)\:=\omega_{n}(\:x_{k}\:)\:q(\:x_{k}\:)\:+r(\:x_{k}\:)\:=r(\:x_{k}\:) \\
\int_{a}^{b}\rho(\:x\:)f(\:x\:)\:\mathrm{d}x\:=\:\sum_{i=1}^{a}A_{i}f(\:x_{i}\:) \\
\text{1} 
\end{gathered}$$

故

再因为

于是

这说明了当$f(x)$ 为不超过$2n-1$ 次代数多项式时，求积公式（4.45）准确成立

还需证明求积公式（4.45）对$f(x)$ 为$2n$ 次代数多项式时是不准确成立的.为此，令$f($ $x$ ) = $\omega _{n}^{2}$ ( $x$ ) . 显然，它是$2n$ 次多项式，且有

$$\int_{s}^{s}\mathbf{p}(\:x\:)\:\mathbf{\omega}_{s}^{2}(\:x\:)\:\mathrm{d}x\:>0$$

而另一方面，如果求积公式(4.45）对$f($ $x$ $) = \mathbf{\omega } _{n}^{2}($ $x$ ) 准确成立，就有

$$\int_{a}^{b}\rho(\:x\:)\:\omega_{a}^{2}(\:x\:)\:\mathrm{d}x\:=\:\sum_{i=1}^{n}\:A_{i}\:\omega_{n}^{2}(\:x_{i}\:)\:=0$$

这个矛盾说明，当$f(x)$ 为$2n$ 次多项式时，求积公式（4.45）是不准确成立的因此，根据代数精确度的定义，求积公式（4.45）的代数精确度可达到$2n-1$ 次

这个事实说明，只要选取$x_k$ 满足（4.46)并取

$$A_{k}\:=\:\int_{s}^{s}\frac{\mathbf{p}(\:x\:)\:\mathbf{\omega}_{n}(\:x\:)}{(\:x\:-\:x_{k}\:)\:\mathbf{\omega}_{s}^{\prime}(\:x_{k}\:)}\mathrm{d}x$$

则求积公式（4.45）的代数精确度可以从$n-1$ 次提高到$2n-1$ 次

（4.46）式表明， $n$ 次代数多项式$\omega_{x}\left(\begin{matrix}x\end{matrix}\right)$ 和不超过$n-1$ 次代数多项式$q($ $x$ ) 在区间$\left[\begin{smallmatrix}a&b\end{smallmatrix}\right]$ 上对权函数$p(x)$ 正交.根据正交条件可以解出$x_1$ x $x_1$ $, x_2$ $, \cdots , x_n$

下面考虑$n=2$ 和$\mathbf{p} ($ $x$ ) = 1的情形.不失一般性，把积分区间$\left[\begin{smallmatrix}a,b\end{smallmatrix}\right]$ 取成「-1，1.这是因为利用变换

$$x=\frac{a+b}2+\frac{b-a}2t$$

总可以把积分区间$\left[\begin{smallmatrix}a,b\end{smallmatrix}\right]$ 变成[-1,1]，即有

$$\int_{a}^{b}f(\:x\:)\:\mathrm{d}x\:=\frac{b-a}{2}\int_{-1}^{1}g(\:t\:)\:\mathrm{d}t$$

其中$g($ $t$ ) $= f\left [$ $\frac {a+ b}2+ \frac {b- a}2t\right ]$

------------------------------------------------------------------

现在的问题是如何选取$x_1$ 和$x_2$ ，使

$$\int_{-1}^1f(\:x\:)\:\mathrm{d}x\:\approx A_1f(\:x_1\:)\:+A_2f(\:x_2\:)$$

对$f(x)$ 为三次代数多项式时准确成立，

按正交条件有

$$\int_{-1}^{1}\left(\:x\:-\:x_{1}\:\right)\left(\:x\:-\:x_{2}\:\right)\mathrm{d}x\:=\:0\\\int_{-1}^{1}x(\:x\:-\:x_{1}\:)\:(\:x\:-\:x_{2}\:)\:\mathrm{d}x\:=\:0$$

从上面两式得$x_1+x_2=0$ 和$x_1x_2=-\frac13$ ,从而得到$x_2=-x_1=-\frac13.$ 而

$$\begin{aligned}&A_{1}\:=\:\int_{-1}^{1}\:\frac{x\:-\:x_{2}}{x_{1}\:-\:x_{2}}\mathrm{d}x\:=1\\&A_{2}\:=\:\int_{-1}^{1}\:\frac{x\:-\:x_{1}}{x_{2}\:-\:x_{1}}\mathrm{d}x\:=1\\&\int_{-1}^{1}f(\:x\:)\:\mathrm{d}x\:=\:\int_{-1}^{1}\:-\:\frac{1}{3}\:+f\:\left[\:\frac{1}{3}\right]\end{aligned}$$

于是

这个求积公式具有三次代数精确度，称为$n=2$ 时的高斯求积公式

定义4.2一般地，把按正交条件(4.46)求出的节点$x_k$ 和按公式（4.44）计算出的系数$A_i$ 组成的求积公式（4.45）称为Gauss（高斯）型求积公式.而节点$x_{\lambda}$ 称为Gauss点，

Gauss型求积公式的优点是代数精确度高，但节点和系数的计算比较麻烦.而利用区间$\left[\begin{smallmatrix}a,b\end{smallmatrix}\right]$ 上关于非负权函数$p(x)$ 的正交多项式簇的性质可知，正交多项式簇的$n$ 个零点就是Gauss求积公式的$n$ 个节点.为此，前人对某些特定的权函数与正交多项式事先计算出它们对应的Gauss点和系数表，在计算时可以直接查表得到求积公式.下面给出几种常用的Gauss型求积公式，即给出它们的Gauss点和相应的系数.

# 4.8.1Gauss-Legendre（勒让得）求积公式

首先，引人Legendre多项式定义.Legendre多项式为

$$L_{n}\left(x\right)=\frac{1}{2^{^{*}}n!dx^{^{*}}}\left(x^{^{2}}-1\right)^{^{*}}$$

其中$L_0\left(\begin{matrix}x\end{matrix}\right)=1$

容易验证， $,L_n\left(\begin{matrix}x\end{matrix}\right)$ 是在区间$\left[\begin{smallmatrix}a,b\end{smallmatrix}\right]$ 上关于权函数$\mathbf{p} ($ $x$ ) = 1的正交多项式簇.这是因为
$$\int_{-1}^{1}x^{k}\:\frac{d^{n}}{dx^{n}}(\:x^{2}\:-\:1\:)^{n}\:\mathrm{d}x\:=x^{k}\:\frac{d^{n-1}}{dx^{n-1}}(\:x^{2}\:-\:1\:)^{n}\:\Bigg|_{-1}^{1}\:-\:\int_{-1}^{1}kx^{k-1}\:\frac{d^{n-1}}{dx^{n-1}}(\:x^{2}\:-\:1\:)^{n}\:\mathrm{d}x$$

------------------------------------------------------------------

$$\begin{aligned}
&=\:-\:\int_{-1}^{1}kx^{k-1}\:\frac{d^{n-1}}{dx^{n-1}}(\:x^{2}\:-\:1\:)^{n}\mathrm{d}x \\
&=\cdots=\left(\begin{array}{c}{-1}\\\end{array}\right)^{k}k!\int_{-1}^{1}\frac{d^{n-k}}{dx^{n-k}}\left(\begin{array}{c}{x^{2}-1}\\\end{array}\right)^{*}\mathrm{d}x\:=\:0\quad(\begin{array}{c}{k\:=\:0\:,1\:,\cdots,n}\\\end{array})
\end{aligned}$$

因此，根据正交多项式簇的性质， $L_n\left(\begin{array}{c}x\end{array}\right)$ 的$n$ 个零点就是Gauss-Legendre求积公式的$n$ 个节点，

直接按公式(4.44)可以算出$A_k$ ，但这样计算比较复杂.考虑到

$$f(\:x\:)\:=\frac{\boldsymbol{\omega}_{n}\left(\:x\:\right)\boldsymbol{\omega}_{n}^{\prime}\left(\:x\:\right)}{x\:-x_{k}}$$

是$2n-2$ 次的代数多项式，而且

$$f(\:x_{j}\:)\:=\:\left\{\begin{array}{cc}0&(j\neq k)\\[\:\omega_{s}^{\prime}\:(\:x_{j}\:)\:]^{2}&(j=k\:)\end{array}\right.$$

$$\begin{aligned}
\int_{-1}^{1}f(x)\:\mathrm{d}x& =\:\int_{-1}^{1}\:\frac{\mathbf{\omega}_{n}^{\prime}\left(\:x\:\right)\mathbf{\omega}_{s}^{2}\left(\:x\:\right)}{x\:-\:x_{i}}\mathrm{d}x  \\
&=\:\sum_{j=1}^{*}\:A_{j}f(\:x_{j}\:)\:=A_{k}\left[\:\omega_{n}^{\prime}(\:x_{k}\:)\:\right]^{2} \\
\text{CHANAA}
\end{aligned}$$

于是

另一方面，由分部积分法得
$$\begin{aligned}
\int_{-1}^{1}{\frac{\omega_{n}\left(x\right)\omega_{n}^{\prime}\left(x\right)}{x-x_{k}}}\mathrm{d}x& =\:\int_{-1}^{1}\:\frac{\omega_{s}\left(\:x\:\right)}{x\:-\:x_{k}}\mathrm{d}(\:\omega_{n}\left(\:x\:\right)\:)  \\
&=\frac{\mathbf{\omega}_{n}^{2}\left(\:x\:\right)}{x\:-\:x_{k}}\Bigg|_{-1}^{1}\:-\:\int_{-1}^{1}\mathbf{\omega}_{n}\left(\:x\:\right)\Bigg[\:\frac{\mathbf{\omega}_{n}\left(\:x\:\right)}{x\:-\:x_{k}}\Bigg]^{\prime}\mathrm{d}x \\
&=\frac2{1-x_{k}^{2}}
\end{aligned}$$

从而有

$$A_{i}\left[\begin{array}{c}\omega_{i}^{\prime}\left(x_{i}\right)\end{array}\right]^{2}=\frac{2}{1-x_{k}^{2}}$$

解得

$$A_{k}=\frac{2}{\left(\begin{array}{c}1-x_{k}^{2}\\\end{array}\right)\left(\begin{array}{c}\omega_{k}^{\prime}\left(\begin{array}{c}x_{k}\\\end{array}\right)\end{array}\right)^{2}}$$

当$n= 1$ ,2 ,3 ,4 ,5时，Gauss-Legendre求积公式的节点$x_i$ 和系数$A_{\lambda_{i}}$ 见表4-2.

表4-2Gauss-Legendre求积公式节点$x_{k}$ 和系数A
| n   | $x_n$         | $A_n$          |
|-----|---------------|----------------|
| 1   | ±0.577350 3   | 1/2            |
| 2   | ±0.774596 7=0 | 0.555 555 6    |
| 3   | ±0.861136 3   | 0.888 884 8    |
| 4   | ±0.906179 0   | 0.347 945 8 1  |
| 5   | ±0.981 789    | 0.236 926 4    |
|     | ±0.538469 3=0 | 0.478 628 7    |
|     |               | 0.564 889 9    |

------------------------------------------------------------------

例4-4使用两点的 Gauss- Legende 求积公式计算积分$\int_0^{\frac\pi2}$sin$t$d$t$

$$\int_0^{\frac{\pi}{2}}\sin t\mathrm{d}t\xrightarrow{t=\frac{\pi(\:x+1\:)}{4}}\frac{\pi}{4}\int_{-1}^{1}\sin\frac{\pi(\:x+1\:)}{4}\mathrm{d}x$$

解

$${\textrm{寻}}x_{1}=0.577\:350\:3\:,x_{2}=-0.577\:350\:3\:,A_{1}=A_{2}=1\:,$$

$$\sin\frac{\pi(\:x_1\:+1\:)}{4}\approx0.\:325\:89\quad\sin\frac{\pi(\:x_2\:+1\:)}{4}\approx0.\:945\:41$$

$$\begin{aligned}
\int_{0}^{\frac{\pi}{2}}\sin t\:\mathrm{d}t& =\frac{\pi}{4}\int_{-1}^{1}\sin\frac{\pi(\:x\:+\:1\:)}{4}\mathrm{d}x \\
&\approx\frac{\pi}{4}(\:0.\:325\:89\:+0.\:945\:41\:)=0.\:998\:475\:8
\end{aligned}$$

故

4.8.2Gauss-Leguerre（拉盖尔）求积公式

所谓Leguerre多项式为

$$L_{s}\left(\:x\:\right)=\mathrm{e}^{s}\:\frac{d^{s}}{dx^{s}}(\:\mathrm{e}^{-s}x^{s}\:)$$

它是在区间[ $0, \infty$ ) 上关于权函数$\mathbf{p} ( x) = \mathrm{e} ^{- x}$ 的正交多项式簇.而求积公式

$$\int_{0}^{\infty}\mathrm{e}^{-x}f(\:x\:)\:\mathrm{d}x\:\approx\:\sum_{i=1}^{\infty}A_{i}f(\:x_{i}\:)$$

称为Gauss-Leguere求积公式.其中$x_k$ 是Leguerre 多项式的零点；系数$A_k$ 由下式计算：

$$A_{k}=\frac{\left(\:n\:!\:\right)^{2}}{x_{k}\left[\:L_{k}^{\prime}\left(\:x_{k}\:\right)\:\right]^{2}}$$

当$n= 1$ ,2 ,3 ,4 ,5时，Gauss -Leguerre 求积公式的节点$x_k$ 和系数$A_{\lambda}$ 见表4 - 3.

表4-3Gauss-Leguerre求积公式节点$x_k$ 和系数A

$n$ | $x_k$ | $A_k$
---|---|---
1 | 1 | 1
2 | 0.5857864 | 0.8535534
3.4142136 | 0.1464466
3 | 0.4157746 | 0.7110930
2.2942804 | 0.2785177
6.2899451 | 0.0103893

------------------------------------------------------------------

续上表

$n$ & $x_{k}$ & $A_{k}$ \\
4 & 0.3225477 & 0.6031541 \\
& 1.7457611 & 0.3574187 \\
& 4.5366203 & 0.0388879 \\
& 9.3950709 & 0.0005393 \\
5 & 0.2635603 & 0.5217556 \\
& 1.4134031 & 0.3986668 \\
& 3.5964258 & 0.0759424 \\
& 7.0858100 & 0.0036118 \\
& 12.640801 & 0.0000234

例4-5 使用 Gauss-Leguere 积公式计算积分$\int_0^\pi e^{-x}$sin$x$d$x$

解取$n=2$ ，查表得x $_{1}= 0. 585$ 786 4 $, x_{2}= 3. 414$ 213 6 $, A_{1}= 0. 853$ 553 4 $, A_{2}=$ 0.146 446 6.故

$$\begin{aligned}\int_{0}^{\infty}\mathrm{e}^{-x}\mathrm{sin}x\mathrm{d}x&\approx0.853\:553\:4\sin(\:0.\:585\:786\:4\:)\:+0.\:146\:446\:6\sin(\:3.\:414\:213\:6\\&\approx0.\:432\:459\:4\end{aligned}$$

4.8.3Gauss-Hermite求积公式

Hermite多项式为

$$H_*(\:x\:)\:=(\:-1\:)^*\mathrm{e}^{s^2}\frac{d^n}{dx^s}(\:\mathrm{e}^{-s^2})$$

它是在区间$\left(\begin{array}{c}{-\infty}&{,+\infty}\\\end{array}\right)$ 上关于权函数p( $x$ ) $= \mathrm{e} ^- \:x^{2}$ 的正交多项式簇.而求积公式

$$\int_{0}^{\infty}\mathrm{e}^{-x^{2}}f(\:x\:)\:\mathrm{d}x\:\approx\:\sum_{k=1}^{\infty}\:A_{k}f(\:x_{k}\:)$$

称为Gauss-Hermite 求积公式.其中$x_k$ 是Hermite 多项式的零点；系数$A_k$ 由下式计算：

$$A_{k}=\frac{2^{*+1}n!\quad\sqrt{\pi}}{\left[\:H_{*}^{\prime}(\:x_{k}\:)\:\right]^{2}}$$

当$n= 1$ ,2 ,3 ,4 ,5时，Gauss-Hermite求积公式的节点$x_k$ 和系数$A_k$ 见表4-4.

------------------------------------------------------------------

表4-4Gauss-Hermite求积公式节点$x_k$ 和系数$A_k$

| n | $x_1$ | $A_1$ |
|---|---|---|
| 1 | 0 | 1.7724539 |
| 2 | ±0.7071068 | 0.8862269 |
| 3 | ±1.2247449 | 0.2954090 |
|  | 0 | 1.1816359 |
| 4 | ±1.6506801 | 0.0813128 |
|  | ±0.5246476 | 0.8049141 |
| 5 | ±2.0201829 | 0.0199532 |
|  | ±0.9895725 | 0.3936193 |
| 0 | 0 | 0.9453087 |

例4 -6使用 Gaus-Hermite 求积公式计算积分$\int_{-\infty}^{\pi}\mathrm{e}^{-x^2}\sin^2x$d$x$

解取$n=2$ ，查表得$x_{1}=0.7071068,x_{2}=-0.7071068,A_{1}=A_{2}=0.8862269$ 故
$$\int_{-\infty}^{\infty}\mathrm{e}^{-x^{2}}\sin^{2}x\mathrm{d}x\:\approx(\:\sin^{2}(\:0.\:707\:106\:8\:)\:+\sin^{2}(\:-0.\:707\:106\:8\:)\:)$$
=0.748 0254

定理4.10设$f($ $x$ $) \in C^{2n}\left [ \:a\:, b\:\right ]$ ，则Gauss 求积公式的误差估计式为
$$\int_{a}^{b}p(\:x\:)f(\:x\:)\:\mathrm{d}x\:-\:\sum_{k=1}^{a}A_{k}f(\:x_{k}\:)\:=\frac{f^{(2n)}\:(\:\eta\:)}{(\:2n\:)\:!}\int_{a}^{b}p(\:x\:)\:\omega_{n}^{2}(\:x\:)\:\mathrm{d}x$$

其中$a\leqslant\eta\leqslant b$

证明由Hermite插值得知，在节点$x_1$ x $x_1,x_2,\cdots,x_n$ 上$2n-1$ 次Hermite插值多项式$H_{2\kappa-1}(x)$ 与$f(x)$ 误差估计为

$$f(\:x\:)\:-H_{2n\:-1}(\:x\:)\:=\frac{f^{(\:2n\:)}\:(\:\xi\:)}{(\:2n\:)\:!}\omega_{s}^{2}(\:x\:)\:dx$$

其中$a\leqslant\xi\leqslant b.$ 即

$$f(\:x\:)\:=H_{2n\:-1}(\:x\:)\:+\frac{f^{(\:2n\:)}(\:\xi\:)}{(\:2n\:)\:!}\omega_{s}^{2}(\:x\:)\:dx$$

对上式两边乘$\mathbf{p}(x)$ ，并从$a$ 到$b$ 积分得
$$\int_{a}^{b}\rho(\:x\:)f(\:x\:)\:\mathrm{d}x\:=\:\int_{a}^{b}\rho(\:x\:)H_{2a-1}(\:x\:)\:\mathrm{d}x\:+\:\frac{1}{(\:2n\:)\:!}\int_{a}^{b}\rho(\:x\:)f^{(\:2n\:)}\:(\:\xi\:)\:\omega_{n}^{2}(\:x\:)\:\mathrm{d}x$$

因为Gauss 求积公式对$2n-1$ 次多项式精确成立，即有

$$\int_{a}^{b}\mathbf{p}(\:x\:)\:H_{2n-1}(\:x\:)\:\mathrm{d}x\:=\:\sum_{k=1}^{n}\:A_{k}H_{2n-1}(\:x_{k}\:)\:=\:\sum_{k=1}^{n}\:A_{k}f(\:x_{k}\:)$$

------------------------------------------------------------------

从而得到

$$\int_{a}^{b}\mathbf{p}(\:x\:)f(\:x\:)\:\mathrm{d}x\:-\:\sum_{k=1}^{*}\:A_{k}f(\:x_{k}\:)=\frac{1}{(\:2n\:)\:!}\int_{a}^{b}f^{(\:2n\:)}\:(\:\xi\:)\:\mathbf{p}(\:x\:)\:\mathbf{\omega}_{*}^{2}(\:x\:)\:\mathrm{d}x$$

由于$\mathbf{p} ($ $x$ ) $\mathbf{\omega } _{n}^{2}($ $x$ )>0 $, f^{( 2n\:) }$ ( $x$ ) 在$\left[\begin{smallmatrix}a&b\end{smallmatrix}\right]$ 上连续，所以由积分中值定理得
$$\frac{1}{(\:2n\:)\:!}\int_{x}^{b}f^{(\:2n\:)}\left(\:\xi\right)p(\:x\:)\:\omega_{n}^{2}(\:x\:)\:\mathrm{d}x\:=\frac{f^{(\:2n\:)}\left(\:\eta\right)}{(\:2n\:)\:!}\int_{x}^{b}p(\:x\:)\:\omega_{n}^{2}(\:x\:)\:\mathrm{d}x$$

其中$a\leqslant\eta\leqslant b$ 于是
$$\int_{0}^{b}\mathbf{p}(\:x\:)f(\:x\:)\:\mathrm{d}x\:-\:\sum_{k=1}^{n}\:A_{k}f(\:x_{k}\:)\:=\frac{f^{(2n)}\:(\:\mathbf{\eta})}{(\:2n\:)\:!}\int_{0}^{b}\mathbf{p}(\:x\:)\:\mathbf{\omega}_{n}^{2}(\:x\:)\:\mathrm{d}x$$

### 练习与思考

1.分别使用梯形求积公式和Simpson 求积公式计算积分edx的近似值，并进行误差估计.

2.使用Newton-Cotes 求积公式计算积分Edx 的近似值（取$n=4$ )

3.若$f^{\prime \prime }($ $x$ )<0 ,证明使用梯形公式计算积分$\int _{a}f($ $x)$d$x$ 所得到的值比准确值小，并说明其几何意义，

4.证明求积近似公式

$$\int_{-2}^{2}f(\:x\:)\:\mathrm{d}x\:=\frac{1}{3}[\:8f(\:-1\:)\:-4f(\:0\:)\:+8f(\:1\:)\:]$$

具有3次代数精确度，

5.分别使用复化梯形求积公式和复化Simpson 求积公式计算积分$\int_0$sin$x$d$x$ 的近似值，取$n=8$ 、与精确值比较，它们各有多少位有效数字？

6.计算积分「e"dx的近似值，要求保证有5位有效数字.若用复化Simpson 求积公式计算， $n$ 应取多少？

7.使用自动选取步长梯形法计算积分$\int_0^1\frac2{1+t^2}$d$t$ 的近似值.（给定$\varepsilon=0.01$

8.使用Romberg 求积法计算积分』Edx的近似值（给定$\varepsilon=0.01$ ,且取$n=$ 1)

9.试确定$x_1$ $, x_2$ $, A_1$ $, A_2$ ，使求积公式

------------------------------------------------------------------

$$\int_0^1f(\:x\:)\:\mathrm{d}x\:\approx A_1f(\:x_1\:)\:+A_2f(\:x_2\:)$$

成为Gauss求积公式.

10.使用两点的 Gauss-Legendre求积公式计算积分ecosxdx 的近似值